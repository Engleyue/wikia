<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>Comment Editor</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="robots" content="noindex, nofollow" />
	<script src="../../../dialog/common/fck_dialog_common.js" type="text/javascript"></script>
	<script type="text/javascript">
var dialog	= window.parent ;
var oEditor = dialog.InnerDialogLoaded() ;

var FCK			= oEditor.FCK ;
var FCKLang		= oEditor.FCKLang ;
var FCKConfig	= oEditor.FCKConfig ;
var FCKRegexLib	= oEditor.FCKRegexLib ;
var FCKTools	= oEditor.FCKTools ;

dialog.SetOkButton(true);
dialog.SetCancelButton(false);

window.onload = function() {
	// apply i18n
	oEditor.FCKLanguageManager.TranslatePage(document);

	dialog.SetAutoSize(true);

	// add "remove" button
	var popupButtons = dialog.document.getElementById('PopupButtons');
	popupButtons.innerHTML += '<input id="btnRemove" type="button" value="' + FCKLang.CommentRemove + '" ' + 
		'style="left: 12px; position: absolute;" onclick="window.frames[\'frmMain\'].Remove();" />';

	// tracking
	FCK.Track('/commentEditor/open');

	// fill in comment field and focus on it
	var data = FCK.GetMetaData(FCK.EditCommentRefId);
	var comment = data.originalCall;

	// strip <!-- and -->
	comment = comment.replace(/^\s*<!--/, '').replace(/-->\s*$/, '');

	GetE('comment').value = comment;
	GetE('comment').focus();
}

function Ok() {

	oEditor.FCKUndo.SaveUndoStep();

	FCK.Track('/commentEditor/save');

	FCK.EditComment(FCK.EditCommentRefId, GetE('comment').value);

	return true;
}

function Remove() {

	oEditor.FCKUndo.SaveUndoStep();

	FCK.Track('/commentEditor/remove');

	FCK.RemoveComment(FCK.EditCommentRefId);

	dialog.CloseDialog();

	return true;
}
	</script>
	<style type="text/css">
		textarea {
			font-family: monospace;
			font-size: 12px;
			height: 100%;
			width: 100%;
		}
	</style>
</head>
<body scroll="no" style="overflow: hidden">
	<textarea id="comment"></textarea>
</body>
</html>
