/*
Copyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license

DO NOT modify this file by hand! Use minify.sh maintenance script to regenerate this file!
*/
if(!window.CKEDITOR){window.CKEDITOR=(function(){var b={timestamp:"",version:"3.5",revision:"r32629 build 20110126",_:{},status:"unloaded",basePath:(function(){var h=window.CKEDITOR_BASEPATH||"";if(!h){var d=document.getElementsByTagName("script");for(var g=0;g<d.length;g++){var f=d[g].src.match(/(^|.*[\\\/])ckeditor(?:_basic)?(?:_source)?.js(?:\?.*)?$/i);if(f){h=f[1];break}}}if(h.indexOf(":/")==-1){if(h.indexOf("/")===0){h=location.href.match(/^.*?:\/\/[^\/]*/)[0]+h}else{h=location.href.match(/^[^\?]*\/(?:)/)[0]+h}}if(!h){throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.'}return h})(),getUrl:function(d){if(d.indexOf(":/")==-1&&d.indexOf("/")!==0){d=this.basePath+d}if(this.timestamp&&d.charAt(d.length-1)!="/"&&!(/[&?]t=/).test(d)){d+=(d.indexOf("?")>=0?"&":"?")+"t="+this.timestamp}return d}};var a=window.CKEDITOR_GETURL;if(a){var c=b.getUrl;b.getUrl=function(d){return a.call(b,d)||c.call(b,d)}}return b})()}if(!CKEDITOR.event){CKEDITOR.event=function(){};CKEDITOR.event.implementOn=function(a){var b=CKEDITOR.event.prototype;for(var c in b){if(a[c]==undefined){a[c]=b[c]}}};CKEDITOR.event.prototype=(function(){var a=function(d){var c=(d.getPrivate&&d.getPrivate())||d._||(d._={});return c.events||(c.events={})};var b=function(c){this.name=c;this.listeners=[]};b.prototype={getListenerIndex:function(f){for(var c=0,d=this.listeners;c<d.length;c++){if(d[c].fn==f){return c}}return -1}};return{on:function(h,l,g,o,m){var n=a(this),c=n[h]||(n[h]=new b(h));if(c.getListenerIndex(l)<0){var k=c.listeners;if(!g){g=this}if(isNaN(m)){m=10}var j=this;var d=function(q,u,s,p){var r={name:h,sender:this,editor:q,data:u,listenerData:o,stop:s,cancel:p,removeListener:function(){j.removeListener(h,l)}};l.call(g,r);return r.data};d.fn=l;d.priority=m;for(var f=k.length-1;f>=0;f--){if(k[f].priority<=m){k.splice(f+1,0,d);return}}k.unshift(d)}},fire:(function(){var g=false;var f=function(){g=true};var c=false;var d=function(){c=true};return function(n,j,o){var h=a(this)[n];var r=g,l=c;g=c=false;if(h){var q=h.listeners;if(q.length){q=q.slice(0);for(var k=0;k<q.length;k++){var m=q[k].call(this,o,j,f,d);if(typeof m!="undefined"){j=m}if(g||c){break}}}}var p=c||(typeof j=="undefined"?false:j);g=r;c=l;return p}})(),fireOnce:function(c,g,f){var d=this.fire(c,g,f);delete a(this)[c];return d},removeListener:function(c,g){var f=a(this)[c];if(f){var d=f.getListenerIndex(g);if(d>=0){f.listeners.splice(d,1)}}},hasListeners:function(c){var d=a(this)[c];return(d&&d.listeners.length>0)}}})()}if(!CKEDITOR.editor){CKEDITOR.ELEMENT_MODE_NONE=0;CKEDITOR.ELEMENT_MODE_REPLACE=1;CKEDITOR.ELEMENT_MODE_APPENDTO=2;CKEDITOR.editor=function(d,a,c,b){this._={instanceConfig:d,element:a,data:b};this.elementMode=c||CKEDITOR.ELEMENT_MODE_NONE;CKEDITOR.event.call(this);this._init()};CKEDITOR.editor.replace=function(a,b){var f=a;if(typeof f!="object"){f=document.getElementById(a);if(!f){var d=0,c=document.getElementsByName(a);while((f=c[d++])&&f.tagName.toLowerCase()!="textarea"){}}if(!f){throw'[CKEDITOR.editor.replace] The element with id or name "'+a+'" was not found.'}}f.style.visibility="hidden";return new CKEDITOR.editor(b,f,CKEDITOR.ELEMENT_MODE_REPLACE)};CKEDITOR.editor.appendTo=function(a,b,d){var c=a;if(typeof c!="object"){c=document.getElementById(a);if(!c){throw'[CKEDITOR.editor.appendTo] The element with id "'+a+'" was not found.'}}return new CKEDITOR.editor(b,c,CKEDITOR.ELEMENT_MODE_APPENDTO,d)};CKEDITOR.editor.prototype={_init:function(){var a=CKEDITOR.editor._pending||(CKEDITOR.editor._pending=[]);a.push(this)},fire:function(a,b){return CKEDITOR.event.prototype.fire.call(this,a,b,this)},fireOnce:function(a,b){return CKEDITOR.event.prototype.fireOnce.call(this,a,b,this)}};CKEDITOR.event.implementOn(CKEDITOR.editor.prototype,true)}if(!CKEDITOR.env){CKEDITOR.env=(function(){var d=navigator.userAgent.toLowerCase();var b=window.opera;var c={ie:(!+"\v1"),opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),air:(d.indexOf(" adobeair/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat"),mobile:(d.indexOf("mobile")>-1),isCustomDomain:function(){if(!this.ie){return false}var h=document.domain,g=window.location.hostname;return h!=g&&h!=("["+g+"]")}};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera);var a=0;if(c.ie){a=parseFloat(d.match(/msie (\d+)/)[1]);c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=((a==7&&!document.documentMode)||document.documentMode==7);c.ie6Compat=(a<7||c.quirks)}if(c.gecko){var f=d.match(/rv:([\d\.]+)/);if(f){c.geckoRelease=f[1];f=f[1].split(".");a=f[0]*10000+(f[1]||0)*100+(f[2]||0)*1}}if(c.opera){a=parseFloat(b.version())}if(c.air){a=parseFloat(d.match(/ adobeair\/(\d+)/)[1])}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;c.isCompatible=!c.mobile&&((c.ie&&a>=6)||(c.gecko&&a>=10801)||(c.opera&&a>=9.5)||(c.air&&a>=1)||(c.webkit&&a>=522)||false);c.cssClass="cke_browser_"+(c.ie?"ie":c.gecko?"gecko":c.opera?"opera":c.webkit?"webkit":"unknown");if(c.quirks){c.cssClass+=" cke_browser_quirks"}if(c.ie){c.cssClass+=" cke_browser_ie"+(c.version<7?"6":c.version>=8?document.documentMode:"7");if(c.quirks){c.cssClass+=" cke_browser_iequirks"}}if(c.gecko&&a<10900){c.cssClass+=" cke_browser_gecko18"}if(c.air){c.cssClass+=" cke_browser_air"}return c})()}if(CKEDITOR.status=="unloaded"){(function(){CKEDITOR.event.implementOn(CKEDITOR);CKEDITOR.loadFullCore=function(){if(CKEDITOR.status!="basic_ready"){CKEDITOR.loadFullCore._load=1;return}delete CKEDITOR.loadFullCore;var b=document.createElement("script");b.type="text/javascript";b.src=CKEDITOR.basePath+"ckeditor.js";b.src=CKEDITOR.basePath+"ckeditor_source.js";document.getElementsByTagName("head")[0].appendChild(b)};CKEDITOR.loadFullCoreTimeout=0;CKEDITOR.replaceClass="ckeditor";CKEDITOR.replaceByClassEnabled=1;var a=function(b,d,c,g){if(CKEDITOR.env.isCompatible){if(CKEDITOR.loadFullCore){CKEDITOR.loadFullCore()}var f=c(b,d,g);CKEDITOR.add(f);return f}return null};CKEDITOR.replace=function(b,c){return a(b,c,CKEDITOR.editor.replace)};CKEDITOR.appendTo=function(b,c,d){return a(b,c,CKEDITOR.editor.appendTo,d)};CKEDITOR.add=function(b){var c=this._.pending||(this._.pending=[]);c.push(b)};CKEDITOR.replaceAll=function(){var b=document.getElementsByTagName("textarea");for(var g=0;g<b.length;g++){var f=null,c=b[g],d=c.name;if(!c.name&&!c.id){continue}if(typeof arguments[0]=="string"){var h=new RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)");if(!h.test(c.className)){continue}}else{if(typeof arguments[0]=="function"){f={};if(arguments[0](c,f)===false){continue}}}this.replace(c,f)}};(function(){var b=function(){var d=CKEDITOR.loadFullCore,c=CKEDITOR.loadFullCoreTimeout;if(CKEDITOR.replaceByClassEnabled){CKEDITOR.replaceAll(CKEDITOR.replaceClass)}CKEDITOR.status="basic_ready";if(d&&d._load){d()}else{if(c){setTimeout(function(){if(CKEDITOR.loadFullCore){CKEDITOR.loadFullCore()}},c*1000)}}};if(window.addEventListener){window.addEventListener("load",b,false)}else{if(window.attachEvent){window.attachEvent("onload",b)}}})();CKEDITOR.status="basic_loaded"})()}CKEDITOR.dom={};(function(){var a=[];CKEDITOR.on("reset",function(){a=[]});CKEDITOR.tools={arrayCompare:function(c,b){if(!c&&!b){return true}if(!c||!b||c.length!=b.length){return false}for(var d=0;d<c.length;d++){if(c[d]!=b[d]){return false}}return true},clone:function(f){var g;if(f&&(f instanceof Array)){g=[];for(var c=0;c<f.length;c++){g[c]=this.clone(f[c])}return g}if(f===null||(typeof(f)!="object")||(f instanceof String)||(f instanceof Number)||(f instanceof Boolean)||(f instanceof Date)||(f instanceof RegExp)){return f}g=new f.constructor();for(var b in f){var d=f[b];g[b]=this.clone(d)}return g},capitalize:function(b){return b.charAt(0).toUpperCase()+b.substring(1).toLowerCase()},extend:function(h){var f=arguments.length,c,j;if(typeof(c=arguments[f-1])=="boolean"){f--}else{if(typeof(c=arguments[f-2])=="boolean"){j=arguments[f-1];f-=2}}for(var d=1;d<f;d++){var g=arguments[d];for(var b in g){if(c===true||h[b]==undefined){if(!j||(b in j)){h[b]=g[b]}}}}return h},prototypedCopy:function(b){var c=function(){};c.prototype=b;return new c()},isArray:function(b){return(!!b&&b instanceof Array)},isEmpty:function(b){for(var c in b){if(b.hasOwnProperty(c)){return false}}return true},cssStyleToDomStyle:(function(){var c=document.createElement("div").style;var b=(typeof c.cssFloat!="undefined")?"cssFloat":(typeof c.styleFloat!="undefined")?"styleFloat":"float";return function(d){if(d=="float"){return b}else{return d.replace(/-./g,function(f){return f.substr(1).toUpperCase()})}}})(),buildStyleHtml:function(d){d=[].concat(d);var f,b=[];for(var c=0;c<d.length;c++){f=d[c];if(/@import|[{}]/.test(f)){b.push("<style>"+f+"</style>")}else{b.push('<link type="text/css" rel=stylesheet href="'+f+'">')}}return b.join("")},htmlEncode:function(g){var d=function(j){var h=new CKEDITOR.dom.element("span");h.setText(j);return h.getHtml()};var f=(d("\n").toLowerCase()=="<br>")?function(h){return d(h).replace(/<br>/gi,"\n")}:d;var c=(d(">")==">")?function(h){return f(h).replace(/>/g,"&gt;")}:f;var b=(d("  ")=="&nbsp; ")?function(h){return c(h).replace(/&nbsp;/g," ")}:c;this.htmlEncode=b;return this.htmlEncode(g)},htmlEncodeAttr:function(b){return b.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},getNextNumber:(function(){var b=0;return function(){return ++b}})(),getNextId:function(){return"cke_"+this.getNextNumber()},override:function(c,b){return b(c)},setTimeout:function(f,c,d,b,g){if(!g){g=window}if(!d){d=g}return g.setTimeout(function(){if(b){f.apply(d,[].concat(b))}else{f.apply(d)}},c||0)},trim:(function(){var b=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(c){return c.replace(b,"")}})(),ltrim:(function(){var b=/^[ \t\n\r]+/g;return function(c){return c.replace(b,"")}})(),rtrim:(function(){var b=/[ \t\n\r]+$/g;return function(c){return c.replace(b,"")}})(),indexOf:(Array.prototype.indexOf)?function(c,b){return c.indexOf(b)}:function(f,d){for(var c=0,b=f.length;c<b;c++){if(f[c]===d){return c}}return -1},bind:function(b,c){return function(){return b.apply(c,arguments)}},createClass:function(d){var h=d.$,c=d.base,g=d.privates||d._,f=d.proto,j=d.statics;if(g){var b=h;h=function(){var l=this._||(this._={});for(var m in g){var k=g[m];l[m]=(typeof k=="function")?CKEDITOR.tools.bind(k,this):k}b.apply(this,arguments)}}if(c){h.prototype=this.prototypedCopy(c.prototype);h.prototype.constructor=h;h.prototype.base=function(){this.base=c.prototype.base;c.apply(this,arguments);this.base=arguments.callee}}if(f){this.extend(h.prototype,f,true)}if(j){this.extend(h,j,true)}return h},addFunction:function(c,b){return a.push(function(){return c.apply(b||this,arguments)})-1},removeFunction:function(b){a[b]=null},callFunction:function(c){var b=a[c];return b&&b.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:(function(){var b=/^\d+(?:\.\d+)?$/;return function(c){return c+(b.test(c)?"px":"")}})(),repeat:function(c,b){return new Array(b+1).join(c)},tryThese:function(){var d;for(var c=0,f=arguments.length;c<f;c++){var b=arguments[c];try{d=b();break}catch(g){}}return d},genKey:function(){return Array.prototype.slice.call(arguments).join("-")}}})();CKEDITOR.dtd=(function(){var a=CKEDITOR.tools.extend,W={isindex:1,fieldset:1},z={input:1,button:1,select:1,textarea:1,label:1},y=a({a:1},z),x=a({iframe:1},y),w={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},v={ins:1,del:1,script:1,style:1},u=a({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},v),s=a({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},u),r=a({p:1},s),q=a({iframe:1},s,z),p={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1},o=a({a:1},q),m={tr:1},l={"#":1},k=a({param:1},p),j=a({form:1},W,x,w,r),h={li:1},g={style:1,script:1},f={base:1,link:1,meta:1,title:1},d=a(f,g),c={head:1,body:1},b={html:1};var n={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1};return{$nonBodyContent:a(b,c,f),$block:n,$blockLimit:{body:1,div:1,td:1,th:1,caption:1,form:1},$inline:o,$body:a({script:1,style:1},n),$cdata:{script:1,style:1},$empty:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},$listItem:{dd:1,dt:1,li:1},$list:{ul:1,ol:1,dl:1},$nonEditable:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},$removeEmpty:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:c,head:d,style:l,script:l,body:j,base:{},link:{},meta:{},title:l,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:j,td:j,br:{},th:j,center:j,kbd:o,button:a(r,w),basefont:{},h5:o,h4:o,samp:o,h6:o,ol:h,h1:o,h3:o,option:l,h2:o,form:a(W,x,w,r),select:{optgroup:1,option:1},font:o,ins:o,menu:h,abbr:o,label:o,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:o,script:l,tfoot:m,cite:o,li:j,input:{},iframe:j,strong:o,textarea:l,noframes:j,big:o,small:o,span:o,hr:{},dt:o,sub:o,optgroup:{option:1},param:{},bdo:o,"var":o,div:j,object:k,sup:o,dd:j,strike:o,area:{},dir:h,map:a({area:1,form:1,p:1},W,v,w),applet:k,dl:{dt:1,dd:1},del:o,isindex:{},fieldset:a({legend:1},p),thead:m,ul:h,acronym:o,b:o,a:q,blockquote:j,caption:o,i:o,u:o,tbody:m,s:o,address:a(x,r),tt:o,legend:o,q:o,pre:a(u,y),p:o,em:o,dfn:o}})();CKEDITOR.dom.event=function(a){this.$=a};CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var a=this.getKey();if(this.$.ctrlKey||this.$.metaKey){a+=CKEDITOR.CTRL}if(this.$.shiftKey){a+=CKEDITOR.SHIFT}if(this.$.altKey){a+=CKEDITOR.ALT}return a},preventDefault:function(a){var b=this.$;if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}if(a){this.stopPropagation()}},stopPropagation:function(){var a=this.$;if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}},getTarget:function(){var a=this.$.target||this.$.srcElement;return a?new CKEDITOR.dom.node(a):null}};CKEDITOR.CTRL=1000;CKEDITOR.SHIFT=2000;CKEDITOR.ALT=4000;CKEDITOR.dom.domObject=function(a){if(a){this.$=a}};CKEDITOR.dom.domObject.prototype=(function(){var a=function(c,b){return function(d){if(typeof CKEDITOR!="undefined"){c.fire(b,new CKEDITOR.dom.event(d))}}};return{getPrivate:function(){var b;if(!(b=this.getCustomData("_"))){this.setCustomData("_",(b={}))}return b},on:function(b){var d=this.getCustomData("_cke_nativeListeners");if(!d){d={};this.setCustomData("_cke_nativeListeners",d)}if(!d[b]){var c=d[b]=a(this,b);if(this.$.attachEvent){this.$.attachEvent("on"+b,c)}else{if(this.$.addEventListener){this.$.addEventListener(b,c,!!CKEDITOR.event.useCapture)}}}return CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(b){CKEDITOR.event.prototype.removeListener.apply(this,arguments);if(!this.hasListeners(b)){var d=this.getCustomData("_cke_nativeListeners");var c=d&&d[b];if(c){if(this.$.detachEvent){this.$.detachEvent("on"+b,c)}else{if(this.$.removeEventListener){this.$.removeEventListener(b,c,false)}}delete d[b]}}},removeAllListeners:function(){var d=this.getCustomData("_cke_nativeListeners");for(var b in d){var c=d[b];if(this.$.detachEvent){this.$.detachEvent("on"+b,c)}else{if(this.$.removeEventListener){this.$.removeEventListener(b,c,false)}}delete d[b]}}}})();(function(a){var b={};CKEDITOR.on("reset",function(){b={}});a.equals=function(c){return(c&&c.$===this.$)};a.setCustomData=function(c,g){var d=this.getUniqueId(),f=b[d]||(b[d]={});f[c]=g;return this};a.getCustomData=function(c){var d=this.$["data-cke-expando"],f=d&&b[d];return f&&f[c]};a.removeCustomData=function(d){var f=this.$["data-cke-expando"],g=f&&b[f],c=g&&g[d];if(typeof c!="undefined"){delete g[d]}return c||null};a.clearCustomData=function(){this.removeAllListeners();var c=this.$["data-cke-expando"];c&&delete b[c]};a.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())};CKEDITOR.event.implementOn(a)})(CKEDITOR.dom.domObject.prototype);CKEDITOR.dom.window=function(a){CKEDITOR.dom.domObject.call(this,a)};CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject();CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){if(CKEDITOR.env.webkit&&this.$.parent){this.$.parent.focus()}this.$.focus()},getViewPaneSize:function(){var b=this.$.document,a=b.compatMode=="CSS1Compat";return{width:(a?b.documentElement.clientWidth:b.body.clientWidth)||0,height:(a?b.documentElement.clientHeight:b.body.clientHeight)||0}},getScrollPosition:function(){var a=this.$;if("pageXOffset" in a){return{x:a.pageXOffset||0,y:a.pageYOffset||0}}else{var b=a.document;return{x:b.documentElement.scrollLeft||b.body.scrollLeft||0,y:b.documentElement.scrollTop||b.body.scrollTop||0}}}});CKEDITOR.dom.document=function(a){CKEDITOR.dom.domObject.call(this,a)};CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject();CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{appendStyleSheet:function(a){if(this.$.createStyleSheet){this.$.createStyleSheet(a)}else{var b=new CKEDITOR.dom.element("link");b.setAttributes({rel:"stylesheet",type:"text/css",href:a});this.getHead().append(b)}},appendStyleText:function(a){if(this.$.createStyleSheet){var c=this.$.createStyleSheet("");c.cssText=a}else{var b=new CKEDITOR.dom.element("style",this);b.append(new CKEDITOR.dom.text(a,this));this.getHead().append(b)}},createElement:function(a,c){var b=new CKEDITOR.dom.element(a,this);if(c){if(c.attributes){b.setAttributes(c.attributes)}if(c.styles){b.setStyles(c.styles)}}return b},createText:function(a){return new CKEDITOR.dom.text(a,this)},focus:function(){this.getWindow().focus()},getById:function(a){var b=this.$.getElementById(a);return b?new CKEDITOR.dom.element(b):null},getByAddress:function(b,k){var g=this.$.documentElement;for(var d=0;g&&d<b.length;d++){var h=b[d];if(!k){g=g.childNodes[h];continue}var a=-1;for(var c=0;c<g.childNodes.length;c++){var f=g.childNodes[c];if(k===true&&f.nodeType==3&&f.previousSibling&&f.previousSibling.nodeType==3){continue}a++;if(a==h){g=f;break}}}return g?new CKEDITOR.dom.node(g):null},getElementsByTag:function(a,b){if(!(CKEDITOR.env.ie&&!(document.documentMode>8))&&b){a=b+":"+a}return new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(a))},getHead:function(){var a=this.$.getElementsByTagName("head")[0];if(!a){a=this.getDocumentElement().append(new CKEDITOR.dom.element("head"),true)}else{a=new CKEDITOR.dom.element(a)}return(this.getHead=function(){return a})()},getBody:function(){var a=new CKEDITOR.dom.element(this.$.body);return(this.getBody=function(){return a})()},getDocumentElement:function(){var a=new CKEDITOR.dom.element(this.$.documentElement);return(this.getDocumentElement=function(){return a})()},getWindow:function(){var a=new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView);return(this.getWindow=function(){return a})()},write:function(a){this.$.open("text/html","replace");CKEDITOR.env.isCustomDomain()&&(this.$.domain=document.domain);this.$.write(a);this.$.close()}});CKEDITOR.dom.node=function(a){if(a){switch(a.nodeType){case CKEDITOR.NODE_DOCUMENT:return new CKEDITOR.dom.document(a);case CKEDITOR.NODE_ELEMENT:return new CKEDITOR.dom.element(a);case CKEDITOR.NODE_TEXT:return new CKEDITOR.dom.text(a)}CKEDITOR.dom.domObject.call(this,a)}return this};CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject();CKEDITOR.NODE_ELEMENT=1;CKEDITOR.NODE_DOCUMENT=9;CKEDITOR.NODE_TEXT=3;CKEDITOR.NODE_COMMENT=8;CKEDITOR.NODE_DOCUMENT_FRAGMENT=11;CKEDITOR.POSITION_IDENTICAL=0;CKEDITOR.POSITION_DISCONNECTED=1;CKEDITOR.POSITION_FOLLOWING=2;CKEDITOR.POSITION_PRECEDING=4;CKEDITOR.POSITION_IS_CONTAINED=8;CKEDITOR.POSITION_CONTAINS=16;CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(b,a){b.append(this,a);return b},clone:function(a,d){var c=this.$.cloneNode(a);var b=function(g){if(g.nodeType!=CKEDITOR.NODE_ELEMENT){return}if(!d){g.removeAttribute("id",false)}g.removeAttribute("data-cke-expando",false);if(a){var h=g.childNodes;for(var f=0;f<h.length;f++){b(h[f])}}};b(c);return new CKEDITOR.dom.node(c)},hasPrevious:function(){return !!this.$.previousSibling},hasNext:function(){return !!this.$.nextSibling},insertAfter:function(a){a.$.parentNode.insertBefore(this.$,a.$.nextSibling);return a},insertBefore:function(a){a.$.parentNode.insertBefore(this.$,a.$);return a},insertBeforeMe:function(a){this.$.parentNode.insertBefore(a.$,this.$);return a},getAddress:function(h){var c=[];var j=this.getDocument().$.documentElement;var g=this.$;while(g&&g!=j){var a=g.parentNode;var b=-1;if(a){for(var d=0;d<a.childNodes.length;d++){var f=a.childNodes[d];if(h&&f.nodeType==3&&f.previousSibling&&f.previousSibling.nodeType==3){continue}b++;if(f==g){break}}c.unshift(b)}g=a}return c},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(){var c=this.$;var b=c.parentNode&&c.parentNode.firstChild;var a=-1;while(b){a++;if(b==c){return a}b=b.nextSibling}return -1},getNextSourceNode:function(a,c,g){if(g&&!g.call){var b=g;g=function(h){return !h.equals(b)}}var f=(!a&&this.getFirst&&this.getFirst()),d;if(!f){if(this.type==CKEDITOR.NODE_ELEMENT&&g&&g(this,true)===false){return null}f=this.getNext()}while(!f&&(d=(d||this).getParent())){if(g&&g(d,true)===false){return null}f=d.getNext()}if(!f){return null}if(g&&g(f)===false){return null}if(c&&c!=f.type){return f.getNextSourceNode(false,c,g)}return f},getPreviousSourceNode:function(a,c,g){if(g&&!g.call){var b=g;g=function(h){return !h.equals(b)}}var f=(!a&&this.getLast&&this.getLast()),d;if(!f){if(this.type==CKEDITOR.NODE_ELEMENT&&g&&g(this,true)===false){return null}f=this.getPrevious()}while(!f&&(d=(d||this).getParent())){if(g&&g(d,true)===false){return null}f=d.getPrevious()}if(!f){return null}if(g&&g(f)===false){return null}if(c&&f.type!=c){return f.getPreviousSourceNode(false,c,g)}return f},getPrevious:function(c){var b=this.$,a;do{b=b.previousSibling;a=b&&new CKEDITOR.dom.node(b)}while(a&&c&&!c(a));return a},getNext:function(c){var b=this.$,a;do{b=b.nextSibling;a=b&&new CKEDITOR.dom.node(b)}while(a&&c&&!c(a));return a},getParent:function(){var a=this.$.parentNode;return(a&&a.nodeType==1)?new CKEDITOR.dom.node(a):null},getParents:function(b){var c=this;var a=[];do{a[b?"push":"unshift"](c)}while((c=c.getParent()));return a},getCommonAncestor:function(a){if(a.equals(this)){return this}if(a.contains&&a.contains(this)){return a}var b=this.contains?this:this.getParent();do{if(b.contains(a)){return b}}while((b=b.getParent()));return null},getPosition:function(d){var f=this.$;var g=d.$;if(f.compareDocumentPosition){return f.compareDocumentPosition(g)}if(f==g){return CKEDITOR.POSITION_IDENTICAL}if(this.type==CKEDITOR.NODE_ELEMENT&&d.type==CKEDITOR.NODE_ELEMENT){if(f.contains){if(f.contains(g)){return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING}if(g.contains(f)){return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}}if("sourceIndex" in f){return(f.sourceIndex<0||g.sourceIndex<0)?CKEDITOR.POSITION_DISCONNECTED:(f.sourceIndex<g.sourceIndex)?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}}var b=this.getAddress(),a=d.getAddress(),h=Math.min(b.length,a.length);for(var c=0;c<=h-1;c++){if(b[c]!=a[c]){if(c<h){return b[c]<a[c]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}break}}return(b.length<a.length)?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(b,a){var c=this.$;if(!a){c=c.parentNode}while(c){if(c.nodeName&&c.nodeName.toLowerCase()==b){return new CKEDITOR.dom.node(c)}c=c.parentNode}return null},hasAscendant:function(b,a){var c=this.$;if(!a){c=c.parentNode}while(c){if(c.nodeName&&c.nodeName.toLowerCase()==b){return true}c=c.parentNode}return false},move:function(b,a){b.append(this.remove(),a)},remove:function(a){var c=this.$;var b=c.parentNode;if(b){if(a){for(var d;(d=c.firstChild);){b.insertBefore(c.removeChild(d),c)}}b.removeChild(c)}return this},replace:function(a){this.insertBefore(a);a.remove()},trim:function(){this.ltrim();this.rtrim()},ltrim:function(){var c;while(this.getFirst&&(c=this.getFirst())){if(c.type==CKEDITOR.NODE_TEXT){var b=CKEDITOR.tools.ltrim(c.getText()),a=c.getLength();if(!b){c.remove();continue}else{if(b.length<a){c.split(a-b.length);this.$.removeChild(this.$.firstChild)}}}break}},rtrim:function(){var c;while(this.getLast&&(c=this.getLast())){if(c.type==CKEDITOR.NODE_TEXT){var b=CKEDITOR.tools.rtrim(c.getText()),a=c.getLength();if(!b){c.remove();continue}else{if(b.length<a){c.split(b.length);this.$.lastChild.parentNode.removeChild(this.$.lastChild)}}}break}if(!CKEDITOR.env.ie&&!CKEDITOR.env.opera){c=this.$.lastChild;if(c&&c.type==1&&c.nodeName.toLowerCase()=="br"){c.parentNode.removeChild(c)}}},findFormattableAncestor:function(){var a=this;while(a){if(a.type==CKEDITOR.NODE_ELEMENT){if(a.is("body")||a.getCustomData("_cke_notReadOnly")){break}if(a.getAttribute("contentEditable")=="false"){if(a.getAttribute("formatEditable")=="true"){return a}}else{if(a.getAttribute("contentEditable")=="true"){break}}}a=a.getParent()}return false},isReadOnlyNotFormattable:function(){var a=this;while(a){if(a.type==CKEDITOR.NODE_ELEMENT){if(a.is("body")||a.getCustomData("_cke_notReadOnly")){break}if(a.getAttribute("contentEditable")=="false"){if(a.getAttribute("formatEditable")!="true"){return a}}else{if(a.getAttribute("contentEditable")=="true"){break}}}a=a.getParent()}return false},isReadOnly:function(){var a=this;while(a){if(a.type==CKEDITOR.NODE_ELEMENT){if(a.is("body")||a.getCustomData("_cke_notReadOnly")){break}if(a.getAttribute("contentEditable")=="false"){return a}else{if(a.getAttribute("contentEditable")=="true"){break}}}a=a.getParent()}return false}});CKEDITOR.dom.nodeList=function(a){this.$=a};CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(b){var a=this.$[b];return a?new CKEDITOR.dom.node(a):null}};CKEDITOR.dom.element=function(b,a){if(typeof b=="string"){b=(a?a.$:document).createElement(b)}CKEDITOR.dom.domObject.call(this,b)};CKEDITOR.dom.element.get=function(a){return a&&(a.$?a:new CKEDITOR.dom.element(a))};CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node();CKEDITOR.dom.element.createFromHtml=function(c,b){var a=new CKEDITOR.dom.element("div",b);a.setHtml(c);return a.getFirst().remove()};CKEDITOR.dom.element.setMarker=function(f,b,a,d){var g=b.getCustomData("list_marker_id")||(b.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id")),c=b.getCustomData("list_marker_names")||(b.setCustomData("list_marker_names",{}).getCustomData("list_marker_names"));f[g]=b;c[a]=1;return b.setCustomData(a,d)};CKEDITOR.dom.element.clearAllMarkers=function(b){for(var a in b){CKEDITOR.dom.element.clearMarkers(b,b[a],1)}};CKEDITOR.dom.element.clearMarkers=function(c,b,f){var d=b.getCustomData("list_marker_names"),g=b.getCustomData("list_marker_id");for(var a in d){b.removeCustomData(a)}b.removeCustomData("list_marker_names");if(f){b.removeCustomData("list_marker_id");delete c[g]}};CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:function(a){var d=this.$.className;if(d){var b=new RegExp("(?:^|\\s)"+a+"(?:\\s|$)","");if(!b.test(d)){d+=" "+a}}this.$.className=d||a},removeClass:function(a){var d=this.getAttribute("class");if(d){var b=new RegExp("(?:^|\\s+)"+a+"(?=\\s|$)","i");if(b.test(d)){d=d.replace(b,"").replace(/^\s+/,"");if(d){this.setAttribute("class",d)}else{this.removeAttribute("class")}}}},hasClass:function(a){var b=new RegExp("(?:^|\\s+)"+a+"(?=\\s|$)","");return b.test(this.getAttribute("class"))},append:function(b,a){if(typeof b=="string"){b=this.getDocument().createElement(b)}if(a){this.$.insertBefore(b.$,this.$.firstChild)}else{this.$.appendChild(b.$)}return b},appendHtml:function(b){if(!this.$.childNodes.length){this.setHtml(b)}else{var a=new CKEDITOR.dom.element("div",this.getDocument());a.setHtml(b);a.moveChildren(this)}},appendText:function(a){if(this.$.text!=undefined){this.$.text+=a}else{this.append(new CKEDITOR.dom.text(a))}},appendBogus:function(){var b=this.getLast();while(b&&b.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(b.getText())){b=b.getPrevious()}if(!b||!b.is||!b.is("br")){var a=CKEDITOR.env.opera?this.getDocument().createText(""):this.getDocument().createElement("br");CKEDITOR.env.gecko&&a.setAttribute("type","_moz");this.append(a)}},breakParent:function(c){var a=new CKEDITOR.dom.range(this.getDocument());a.setStartAfter(this);a.setEndAfter(c);var b=a.extractContents();a.insertNode(this.remove());b.insertAfterNode(this)},contains:CKEDITOR.env.ie||CKEDITOR.env.webkit?function(a){var b=this.$;return a.type!=CKEDITOR.NODE_ELEMENT?b.contains(a.getParent().$):b!=a.$&&b.contains(a.$)}:function(a){return !!(this.$.compareDocumentPosition(a.$)&16)},focus:(function(){function a(){try{this.$.focus()}catch(b){}}return function(b){if(b){CKEDITOR.tools.setTimeout(a,100,this)}else{a.call(this)}}})(),getHtml:function(){var a=this.$.innerHTML;return CKEDITOR.env.ie?a.replace(/<\?[^>]*>/g,""):a},getOuterHtml:function(){if(this.$.outerHTML){return this.$.outerHTML.replace(/<\?[^>]*>/,"")}var a=this.$.ownerDocument.createElement("div");a.appendChild(this.$.cloneNode(true));return a.innerHTML},setHtml:function(a){return(this.$.innerHTML=a)},setText:function(a){CKEDITOR.dom.element.prototype.setText=(this.$.innerText!=undefined)?function(b){return this.$.innerText=b}:function(b){return this.$.textContent=b};return this.setText(a)},getAttribute:(function(){var a=function(b){return this.$.getAttribute(b,2)};if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)){return function(d){switch(d){case"class":d="className";break;case"tabindex":var c=a.call(this,d);if(c!==0&&this.$.tabIndex===0){c=null}return c;break;case"checked":var b=this.$.attributes.getNamedItem(d),f=b.specified?b.nodeValue:this.$.checked;return f?"checked":null;case"hspace":return this.$.hspace;case"style":return this.$.style.cssText}return a.call(this,d)}}else{return a}})(),getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getComputedStyle:CKEDITOR.env.ie?function(a){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(a)]}:function(a){return this.getWindow().$.getComputedStyle(this.$,"").getPropertyValue(a)},getDtd:function(){var a=CKEDITOR.dtd[this.getName()];this.getDtd=function(){return a};return a},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:CKEDITOR.env.ie?function(){var a=this.$.tabIndex;if(a===0&&!CKEDITOR.dtd.$tabIndex[this.getName()]&&parseInt(this.getAttribute("tabindex"),10)!==0){a=-1}return a}:CKEDITOR.env.webkit?function(){var a=this.$.tabIndex;if(a==undefined){a=parseInt(this.getAttribute("tabindex"),10);if(isNaN(a)){a=-1}}return a}:function(){return this.$.tabIndex},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var b=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&!(document.documentMode>8)){var a=this.$.scopeName;if(typeof a!="undefined"&&a!="HTML"){b=a.toLowerCase()+":"+b}}return(this.getName=function(){return b})()},getValue:function(){return this.$.value},getFirst:function(c){var b=this.$.firstChild,a=b&&new CKEDITOR.dom.node(b);if(a&&c&&!c(a)){a=a.getNext(c)}return a},getLast:function(c){var b=this.$.lastChild,a=b&&new CKEDITOR.dom.node(b);if(a&&c&&!c(a)){a=a.getPrevious(c)}return a},getStyle:function(a){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(a)]},is:function(){var a=this.getName();for(var b=0;b<arguments.length;b++){if(arguments[b]==a){return true}}return false},isEditable:function(){var a=this.getName();var b=!CKEDITOR.dtd.$nonEditable[a]&&(CKEDITOR.dtd[a]||CKEDITOR.dtd.span);return(b&&b["#"])},isIdentical:function(b){if(this.getName()!=b.getName()){return false}var h=this.$.attributes,g=b.$.attributes;var d=h.length,a=g.length;for(var c=0;c<d;c++){var f=h[c];if(f.nodeName=="_moz_dirty"){continue}if((!CKEDITOR.env.ie||(f.specified&&f.nodeName!="data-cke-expando"))&&f.nodeValue!=b.getAttribute(f.nodeName)){return false}}if(CKEDITOR.env.ie){for(c=0;c<a;c++){f=g[c];if(f.specified&&f.nodeName!="data-cke-expando"&&f.nodeValue!=this.getAttribute(f.nodeName)){return false}}}return true},isVisible:function(){var b=!!this.$.offsetHeight&&this.getComputedStyle("visibility")!="hidden",a,c;if(b&&(CKEDITOR.env.webkit||CKEDITOR.env.opera)){a=this.getWindow();if(!a.equals(CKEDITOR.document.getWindow())&&(c=a.$.frameElement)){b=new CKEDITOR.dom.element(c).isVisible()}}return b},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()]){return false}var b=this.getChildren();for(var a=0,c=b.count();a<c;a++){var d=b.getItem(a);if(d.type==CKEDITOR.NODE_ELEMENT&&d.data("cke-bookmark")){continue}if(d.type==CKEDITOR.NODE_ELEMENT&&!d.isEmptyInlineRemoveable()||d.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(d.getText())){return false}}return true},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)?function(){var a=this.$.attributes;for(var b=0;b<a.length;b++){var c=a[b];switch(c.nodeName){case"class":if(this.getAttribute("class")){return true}case"data-cke-expando":continue;default:if(c.specified){return true}}}return false}:function(){var a=this.$.attributes,c=a.length;var b={"data-cke-expando":1,_moz_dirty:1};return c>0&&(c>2||!b[a[0].nodeName]||(c==2&&!b[a[1].nodeName]))},hasAttribute:function(a){var b=this.$.attributes.getNamedItem(a);return !!(b&&b.specified)},hide:function(){this.setStyle("display","none")},moveChildren:function(c,a){var b=this.$;c=c.$;if(b==c){return}var d;if(a){while((d=b.lastChild)){c.insertBefore(b.removeChild(d),c.firstChild)}}else{while((d=b.firstChild)){c.appendChild(b.removeChild(d))}}},mergeSiblings:(function(){function a(b,c,d){if(c&&c.type==CKEDITOR.NODE_ELEMENT){var f=[];while(c.data("cke-bookmark")||c.isEmptyInlineRemoveable()){f.push(c);c=d?c.getNext():c.getPrevious();if(!c||c.type!=CKEDITOR.NODE_ELEMENT){return}}if(b.isIdentical(c)){var g=d?b.getLast():b.getFirst();while(f.length){f.shift().move(b,!d)}c.moveChildren(b,!d);c.remove();if(g&&g.type==CKEDITOR.NODE_ELEMENT){g.mergeSiblings()}}}}return function(){if(!(CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))){return}a(this,this.getNext(),true);a(this,this.getPrevious())}})(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:(function(){var a=function(b,c){this.$.setAttribute(b,c);return this};if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)){return function(b,c){if(b=="class"){this.$.className=c}else{if(b=="style"){this.$.style.cssText=c}else{if(b=="tabindex"){this.$.tabIndex=c}else{if(b=="checked"){this.$.checked=c}else{a.apply(this,arguments)}}}}return this}}else{return a}})(),setAttributes:function(b){for(var a in b){this.setAttribute(a,b[a])}return this},setValue:function(a){this.$.value=a;return this},removeAttribute:(function(){var a=function(b){this.$.removeAttribute(b)};if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)){return function(b){if(b=="class"){b="className"}else{if(b=="tabindex"){b="tabIndex"}}a.call(this,b)}}else{return a}})(),removeAttributes:function(b){if(CKEDITOR.tools.isArray(b)){for(var c=0;c<b.length;c++){this.removeAttribute(b[c])}}else{for(var a in b){b.hasOwnProperty(a)&&this.removeAttribute(a)}}},removeStyle:function(a){this.setStyle(a,"");if(this.$.style.removeAttribute){this.$.style.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(a))}if(!this.$.style.cssText){this.removeAttribute("style")}},setStyle:function(a,b){this.$.style[CKEDITOR.tools.cssStyleToDomStyle(a)]=b;return this},setStyles:function(a){for(var b in a){this.setStyle(b,a[b])}return this},setOpacity:function(a){if(CKEDITOR.env.ie){a=Math.round(a*100);this.setStyle("filter",a>=100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+a+")")}else{this.setStyle("opacity",a)}},unselectable:CKEDITOR.env.gecko?function(){this.$.style.MozUserSelect="none";this.on("dragstart",function(a){a.data.preventDefault()})}:CKEDITOR.env.webkit?function(){this.$.style.KhtmlUserSelect="none";this.on("dragstart",function(a){a.data.preventDefault()})}:function(){if(CKEDITOR.env.ie||CKEDITOR.env.opera){var b=this.$,c,a=0;b.unselectable="on";while((c=b.all[a++])){switch(c.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:c.unselectable="on"}}}},getPositionedAncestor:function(){var a=this;while(a.getName()!="html"){if(a.getComputedStyle("position")!="static"){return a}a=a.getParent()}return null},getDocumentPosition:function(g){var k=0,h=0,m=this.getDocument().getBody(),r=this.getDocument().$.compatMode=="BackCompat";var z=this.getDocument();if(document.documentElement.getBoundingClientRect){var l=this.$.getBoundingClientRect(),d=z.$,u=d.documentElement;var o=u.clientTop||m.$.clientTop||0,w=u.clientLeft||m.$.clientLeft||0,s=true;if(CKEDITOR.env.ie){var v=z.getDocumentElement().contains(this),j=z.getBody().contains(this);s=(r&&j)||(!r&&v)}if(s){k=l.left+(!r&&u.scrollLeft||m.$.scrollLeft);k-=w;h=l.top+(!r&&u.scrollTop||m.$.scrollTop);h-=o}}else{var p=this,b=null,a;while(p&&!(p.getName()=="body"||p.getName()=="html")){k+=p.$.offsetLeft-p.$.scrollLeft;h+=p.$.offsetTop-p.$.scrollTop;if(!p.equals(this)){k+=(p.$.clientLeft||0);h+=(p.$.clientTop||0)}var c=b;while(c&&!c.equals(p)){k-=c.$.scrollLeft;h-=c.$.scrollTop;c=c.getParent()}b=p;p=(a=p.$.offsetParent)?new CKEDITOR.dom.element(a):null}}if(g){var f=this.getWindow(),n=g.getWindow();if(!f.equals(n)&&f.$.frameElement){var q=(new CKEDITOR.dom.element(f.$.frameElement)).getDocumentPosition(g);k+=q.x;h+=q.y}}if(!document.documentElement.getBoundingClientRect){if(CKEDITOR.env.gecko&&!r){k+=this.$.clientLeft?1:0;h+=this.$.clientTop?1:0}}return{x:k,y:h}},scrollIntoView:function(d){var f=this.getWindow(),b=f.getViewPaneSize().height;var g=b*-1;if(d){g+=b}else{g+=this.$.offsetHeight||0;g+=parseInt(this.getComputedStyle("marginBottom")||0,10)||0}var c=this.getDocumentPosition();g+=c.y;g=g<0?0:g;var a=f.getScrollPosition().y;if(g>a||g<a-b){f.$.scrollTo(0,g)}},setState:function(a){switch(a){case CKEDITOR.TRISTATE_ON:this.addClass("cke_on");this.removeClass("cke_off");this.removeClass("cke_disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass("cke_disabled");this.removeClass("cke_off");this.removeClass("cke_on");break;default:this.addClass("cke_off");this.removeClass("cke_on");this.removeClass("cke_disabled");break}},getFrameDocument:function(){var a=this.$;try{a.contentWindow.document}catch(b){a.src=a.src;if(CKEDITOR.env.ie&&CKEDITOR.env.version<7){window.showModalDialog('javascript:document.write("<script>window.setTimeout(function(){window.close();},50);<\/script>")')}}return a&&new CKEDITOR.dom.document(a.contentWindow.document)},copyAttributes:function(b,f){var a=this.$.attributes;f=f||{};for(var h=0;h<a.length;h++){var d=a[h];var c=d.nodeName.toLowerCase(),g;if(c in f){continue}if(c=="checked"&&(g=this.getAttribute(c))){b.setAttribute(c,g)}else{if(d.specified||(CKEDITOR.env.ie&&d.nodeValue&&c=="value")){g=this.getAttribute(c);if(g===null){g=d.nodeValue}b.setAttribute(c,g)}}}if(this.$.style.cssText!==""){b.$.style.cssText=this.$.style.cssText}},renameNode:function(b){if(this.getName()==b){return}var c=this.getDocument();var a=new CKEDITOR.dom.element(b,c);this.copyAttributes(a);this.moveChildren(a);this.getParent()&&this.$.parentNode.replaceChild(a.$,this.$);a.$["data-cke-expando"]=this.$["data-cke-expando"];this.$=a.$},getChild:function(b){var a=this.$;if(!b.slice){a=a.childNodes[b]}else{while(b.length>0&&a){a=a.childNodes[b.shift()]}}return a?new CKEDITOR.dom.node(a):null},getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){this.on("contextmenu",function(a){if(!a.data.getTarget().hasClass("cke_enable_context_menu")){a.data.preventDefault()}})},getDirection:function(a){return a?this.getComputedStyle("direction"):this.getStyle("direction")||this.getAttribute("dir")},data:function(a,b){a="data-"+a;if(b===undefined){return this.getAttribute(a)}else{if(b===false){this.removeAttribute(a)}else{this.setAttribute(a,b)}}}});(function(){var b={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};function a(g){var d=0;for(var f=0,c=b[g].length;f<c;f++){d+=parseInt(this.getComputedStyle(b[g][f])||0,10)||0}return d}CKEDITOR.dom.element.prototype.setSize=function(d,c,f){if(typeof c=="number"){if(f&&!(CKEDITOR.env.ie&&CKEDITOR.env.quirks)){c-=a.call(this,d)}this.setStyle(d,c+"px")}};CKEDITOR.dom.element.prototype.getSize=function(d,f){var c=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(d)],this.$["client"+CKEDITOR.tools.capitalize(d)])||0;if(f){c-=a.call(this,d)}return c}})();CKEDITOR.command=function(a,b){this.uiItems=[];this.exec=function(c){if(this.state==CKEDITOR.TRISTATE_DISABLED){return false}if(!RTE.loaded){return false}if(this.editorFocus){a.focus()}return(b.exec.call(this,a,c)!==false)};CKEDITOR.tools.extend(this,b,{modes:{wysiwyg:1},editorFocus:1,state:CKEDITOR.TRISTATE_OFF});CKEDITOR.event.call(this)};CKEDITOR.command.prototype={enable:function(){if(this.state==CKEDITOR.TRISTATE_DISABLED){this.setState((!this.preserveState||(typeof this.previousState=="undefined"))?CKEDITOR.TRISTATE_OFF:this.previousState)}},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(a){if(this.state==a){return false}this.previousState=this.state;this.state=a;this.fire("state");return true},toggleState:function(){if(this.state==CKEDITOR.TRISTATE_OFF){this.setState(CKEDITOR.TRISTATE_ON)}else{if(this.state==CKEDITOR.TRISTATE_ON){this.setState(CKEDITOR.TRISTATE_OFF)}}}};CKEDITOR.event.implementOn(CKEDITOR.command.prototype,true);CKEDITOR.ENTER_P=1;CKEDITOR.ENTER_BR=2;CKEDITOR.ENTER_DIV=3;CKEDITOR.config={customConfig:"config.js",autoUpdateElement:true,baseHref:"",contentsCss:CKEDITOR.basePath+"contents.css",contentsLangDirection:"ui",contentsLanguage:"",language:"",defaultLanguage:"en",enterMode:CKEDITOR.ENTER_P,forceEnterMode:false,shiftEnterMode:CKEDITOR.ENTER_BR,corePlugins:"",docType:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',bodyId:"",bodyClass:"",fullPage:false,height:200,plugins:"about,a11yhelp,basicstyles,bidi,blockquote,button,clipboard,colorbutton,colordialog,contextmenu,dialogadvtab,div,elementspath,enterkey,entities,filebrowser,find,flash,font,format,forms,horizontalrule,htmldataprocessor,iframe,image,indent,justify,keystrokes,link,list,liststyle,maximize,newpage,pagebreak,pastefromword,pastetext,popup,preview,print,removeformat,resize,save,scayt,smiley,showblocks,showborders,sourcearea,stylescombo,table,tabletools,specialchar,tab,templates,toolbar,undo,wysiwygarea,wsc",extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,theme:"default",skin:"kama",width:"",baseFloatZIndex:10000};CKEDITOR.focusManager=function(a){if(a.focusManager){return a.focusManager}this.hasFocus=false;this._={editor:a};return this};CKEDITOR.focusManager.prototype={focus:function(){if(this._.timer){clearTimeout(this._.timer)}if(!this.hasFocus){if(CKEDITOR.currentInstance){CKEDITOR.currentInstance.focusManager.forceBlur()}var a=this._.editor;var b=a.container.getChild(1);if(b){b.addClass("cke_focus")}this.hasFocus=true;a.fire("focus")}},blur:function(){var a=this;if(a._.timer){clearTimeout(a._.timer)}a._.timer=setTimeout(function(){delete a._.timer;a.forceBlur()},100)},forceBlur:function(){if(this.hasFocus){var a=this._.editor;var b=a.container.getChild(1);if(b){b.removeClass("cke_focus")}this.hasFocus=false;a.fire("blur")}}};(function(){var a={};CKEDITOR.lang={languages:{af:1,ar:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,is:1,it:1,ja:1,km:1,ko:1,lt:1,lv:1,mn:1,ms:1,nb:1,nl:1,no:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,sk:1,sl:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,uk:1,vi:1,"zh-cn":1,zh:1},load:function(b,d,c){if(!b||!CKEDITOR.lang.languages[b]){b=this.detect(d,b)}if(!this[b]){CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+b+".js"),function(){c(b,this[b])},this)}else{c(b,this[b])}},detect:function(h,c){var f=this.languages;c=c||navigator.userLanguage||navigator.language;var d=c.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),g=d[1],b=d[2];if(f[g+"-"+b]){g=g+"-"+b}else{if(!f[g]){g=null}}CKEDITOR.lang.detect=g?function(){return g}:function(j){return j};return g||h}}})();CKEDITOR.scriptLoader=(function(){var a={},b={};return{load:function(f,q,r,m,g){var d=(typeof f=="string");if(d){f=[f]}if(!r){r=CKEDITOR}var n=f.length,k=[],l=[];var p=function(s){if(q){if(d){q.call(r,s)}else{q.call(r,k,l)}}};if(n===0){p(true);return}var j=function(s,u){(u?k:l).push(s);if(--n<=0){g&&CKEDITOR.document.getDocumentElement().removeStyle("cursor");p(u)}};var o=function(s,w){a[s]=1;var v=b[s];delete b[s];for(var u=0;u<v.length;u++){v[u](s,w)}};var c=function(u){if(m!==true&&a[u]){j(u,true);return}var v=b[u]||(b[u]=[]);v.push(j);if(v.length>1){return}var s=new CKEDITOR.dom.element("script");s.setAttributes({type:"text/javascript",src:u});if(q){if(CKEDITOR.env.ie){s.$.onreadystatechange=function(){if(s.$.readyState=="loaded"||s.$.readyState=="complete"){s.$.onreadystatechange=null;o(u,true)}}}else{s.$.onload=function(){setTimeout(function(){o(u,true)},0)};s.$.onerror=function(){o(u,false)}}}s.appendTo(CKEDITOR.document.getHead())};g&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var h=0;h<n;h++){c(f[h])}},loadCode:function(d){var c=new CKEDITOR.dom.element("script");c.setAttribute("type","text/javascript");c.appendText(d);c.appendTo(CKEDITOR.document.getHead())}}})();CKEDITOR.resourceManager=function(b,a){this.basePath=b;this.fileName=a;this.registered={};this.loaded={};this.externals={};this._={waitingList:{}}};CKEDITOR.resourceManager.prototype={add:function(a,b){if(this.registered[a]){throw'[CKEDITOR.resourceManager.add] The resource name "'+a+'" is already registered.'}CKEDITOR.fire(a+CKEDITOR.tools.capitalize(this.fileName)+"Ready",this.registered[a]=b||{})},get:function(a){return this.registered[a]||null},getPath:function(a){var b=this.externals[a];return CKEDITOR.getUrl((b&&b.dir)||this.basePath+a+"/")},getFilePath:function(a){var b=this.externals[a];return CKEDITOR.getUrl(this.getPath(a)+((b&&(typeof b.file=="string"))?b.file:this.fileName+".js"))},addExternal:function(d,c,f){d=d.split(",");for(var b=0;b<d.length;b++){var a=d[b];this.externals[a]={dir:c,file:f}}},load:function(j,l,m){if(!CKEDITOR.tools.isArray(j)){j=j?[j]:[]}var g=this.loaded,d=this.registered,k=[],h={},c={};for(var f=0;f<j.length;f++){var b=j[f];if(!b){continue}if(!g[b]&&!d[b]){var a=this.getFilePath(b);k.push(a);if(!(a in h)){h[a]=[]}h[a].push(b)}else{c[b]=this.get(b)}}CKEDITOR.scriptLoader.load(k,function(r,n){if(n.length){throw'[CKEDITOR.resourceManager.load] Resource name "'+h[n[0]].join(",")+'" was not found at "'+n[0]+'".'}for(var q=0;q<r.length;q++){var s=h[r[q]];for(var p=0;p<s.length;p++){var o=s[p];c[o]=this.get(o);g[o]=1}}l.call(m,c)},this)}};CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin");CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(a){return function(b,g,d){var f={};var c=function(h){a.call(this,h,function(j){CKEDITOR.tools.extend(f,j);var o=[];for(var n in j){var m=j[n],l=m&&m.requires;if(l){for(var k=0;k<l.length;k++){if(!f[l[k]]){o.push(l[k])}}}}if(o.length){c.call(this,o)}else{for(n in f){m=f[n];if(m.onLoad&&!m.onLoad._called){m.onLoad();m.onLoad._called=1}}if(g){g.call(d||window,f)}}},this)};c.call(this,b)}});CKEDITOR.plugins.setLang=function(c,d,f){var b=this.get(c),a=b.lang||(b.lang={});a[d]=f};CKEDITOR.skins=(function(){var a={},c={};var b=function(l,j,g,r){var m=a[j];if(!l.skin){l.skin=m;if(m.init){m.init(l)}}var p=function(u){for(var v=0;v<u.length;v++){u[v]=CKEDITOR.getUrl(c[j]+u[v])}};function s(u,v){return u.replace(/url\s*\(([\s'"]*)(.*?)([\s"']*)\)/g,function(w,x,y,z){if(/^\/|^\w?:/.test(y)){return w}else{return"url("+v+x+y+z+")"}})}g=m[g];var o=!g||!!g._isLoaded;if(o){r&&r()}else{var d=g._pending||(g._pending=[]);d.push(r);if(d.length>1){return}var q=!g.css||!g.css.length,h=!g.js||!g.js.length;var f=function(){if(q&&h){g._isLoaded=1;for(var u=0;u<d.length;u++){if(d[u]){d[u]()}}}};if(!q){var k=g.css;if(CKEDITOR.tools.isArray(k)){p(k);for(var n=0;n<k.length;n++){CKEDITOR.document.appendStyleSheet(k[n])}}else{k=s(k,CKEDITOR.getUrl(c[j]));CKEDITOR.document.appendStyleText(k)}g.css=k;q=1}if(!h){p(g.js);CKEDITOR.scriptLoader.load(g.js,function(){h=1;f()})}f()}};return{add:function(d,f){a[d]=f;f.skinPath=c[d]||(c[d]=CKEDITOR.getUrl("_source/skins/"+d+"/"))},load:function(g,f,j){var d=g.skinName,h=g.skinPath;if(a[d]){b(g,d,f,j)}else{c[d]=h;CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(h+"skin.js"),function(){b(g,d,f,j)})}}}})();CKEDITOR.themes=new CKEDITOR.resourceManager("themes/","theme");CKEDITOR.ui=function(a){if(a.ui){return a.ui}this._={handlers:{},items:{},editor:a};return this};CKEDITOR.ui.prototype={add:function(a,c,b){this._.items[a]={type:c,command:b.command||null,args:Array.prototype.slice.call(arguments,2)}},create:function(b){var d=this._.items[b],c=d&&this._.handlers[d.type],f=d&&d.command&&this._.editor.getCommand(d.command);var a=c&&c.create.apply(this,d.args);if(f){f.uiItems.push(a)}return a},addHandler:function(b,a){this._.handlers[b]=a}};CKEDITOR.event.implementOn(CKEDITOR.ui);(function(){var l=0;var k=function(){var o="editor"+(++l);return(CKEDITOR.instances&&CKEDITOR.instances[o])?k():o};var f={};var j=function(q){var o=q.config.customConfig;if(!o){return false}o=CKEDITOR.getUrl(o);var p=f[o]||(f[o]={});if(p.fn){p.fn.call(q,q.config);if(CKEDITOR.getUrl(q.config.customConfig)==o||!j(q)){q.fireOnce("customConfigLoaded")}}else{CKEDITOR.scriptLoader.load(o,function(){if(CKEDITOR.editorConfig){p.fn=CKEDITOR.editorConfig}else{p.fn=function(){}}j(q)})}return true};var a=function(o,p){o.on("customConfigLoaded",function(){if(p){if(p.on){for(var q in p.on){o.on(q,p.on[q])}}CKEDITOR.tools.extend(o.config,p,true);delete o.config.on}m(o)});if(p&&p.customConfig!=undefined){o.config.customConfig=p.customConfig}if(!j(o)){o.fireOnce("customConfigLoaded")}};var m=function(p){var r=p.config.skin.split(","),o=r[0],q=CKEDITOR.getUrl(r[1]||("skins/"+o+"/"));p.skinName=o;p.skinPath=q;p.skinClass="cke_skin_"+o;p.tabIndex=p.config.tabIndex||p.element.getAttribute("tabindex")||0;p.fireOnce("configLoaded");b(p)};var d=function(o){CKEDITOR.lang.load(o.config.language,o.config.defaultLanguage,function(q,r){o.langCode=q;o.lang=CKEDITOR.tools.prototypedCopy(r);if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900&&o.lang.dir=="rtl"){o.lang.dir="ltr"}var p=o.config;p.contentsLangDirection=="ui"&&(p.contentsLangDirection=o.lang.dir);g(o)})};var g=function(r){var q=r.config,o=q.plugins,p=q.extraPlugins,u=q.removePlugins;if(p){var s=new RegExp("(?:^|,)(?:"+p.replace(/\s*,\s*/g,"|")+")(?=,|$)","g");o=o.replace(s,"");o+=","+p}if(u){s=new RegExp("(?:^|,)(?:"+u.replace(/\s*,\s*/g,"|")+")(?=,|$)","g");o=o.replace(s,"")}CKEDITOR.env.air&&(o+=",adobeair");CKEDITOR.plugins.load(o.split(","),function(z){var w=[];var D=[];var v=[];r.plugins=z;for(var C in z){var A=z[C],x=A.lang,B=CKEDITOR.plugins.getPath(C),y=null;A.path=B;if(x){y=(CKEDITOR.tools.indexOf(x,r.langCode)>=0?r.langCode:x[0]);if(!A.lang[y]){v.push(CKEDITOR.getUrl(B+"lang/"+y+".js"))}else{CKEDITOR.tools.extend(r.lang,A.lang[y]);y=null}}D.push(y);w.push(A)}CKEDITOR.scriptLoader.load(v,function(){var F=["beforeInit","init","afterInit"];for(var E=0;E<F.length;E++){for(var G=0;G<w.length;G++){var H=w[G];if(E===0&&D[G]&&H.lang){CKEDITOR.tools.extend(r.lang,H.lang[D[G]])}if(H[F[E]]){H[F[E]](r)}}}r.fire("pluginsLoaded");c(r)})})};var b=function(o){CKEDITOR.skins.load(o,"editor",function(){d(o)})};var c=function(o){var p=o.config.theme;CKEDITOR.themes.load(p,function(){var q=o.theme=CKEDITOR.themes.get(p);q.path=CKEDITOR.themes.getPath(p);q.build(o);if(o.config.autoUpdateElement){h(o)}})};var h=function(p){var o=p.element;if(p.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&o.is("textarea")){var q=o.$.form&&new CKEDITOR.dom.element(o.$.form);if(q){function r(){p.updateElement()}q.on("submit",r);if(!q.$.submit.nodeName){q.$.submit=CKEDITOR.tools.override(q.$.submit,function(s){return function(){p.updateElement();if(s.apply){s.apply(this,arguments)}else{s()}}})}p.on("destroy",function(){q.removeListener("submit",r)})}}};function n(){var r,o=this._.commands,q=this.mode;for(var p in o){r=o[p];r[r.startDisabled?"disable":r.modes[q]?"enable":"disable"]()}}CKEDITOR.editor.prototype._init=function(){var o=CKEDITOR.dom.element.get(this._.element),p=this._.instanceConfig;delete this._.element;delete this._.instanceConfig;this._.commands={};this._.styles=[];this.element=o;this.name=(o&&(this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE)&&(o.getId()||o.getNameAtt()))||k();if(this.name in CKEDITOR.instances){throw'[CKEDITOR.editor] The instance "'+this.name+'" already exists.'}this.id=CKEDITOR.tools.getNextId();this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config);this.ui=new CKEDITOR.ui(this);this.focusManager=new CKEDITOR.focusManager(this);CKEDITOR.fire("instanceCreated",null,this);this.on("mode",n,null,null,1);a(this,p)}})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{addCommand:function(a,b){return this._.commands[a]=new CKEDITOR.command(this,b)},addCss:function(a){this._.styles.push(a)},destroy:function(f){if(!f){this.updateElement()}if(this.mode){this._.modes[this.mode].unload(this.getThemeSpace("contents"))}this.theme.destroy(this);var g,d=0,c,b,a;if(this.toolbox){g=this.toolbox.toolbars;for(;d<g.length;d++){b=g[d].items;for(c=0;c<b.length;c++){a=b[c];if(a.clickFn){CKEDITOR.tools.removeFunction(a.clickFn)}if(a.keyDownFn){CKEDITOR.tools.removeFunction(a.keyDownFn)}if(a.index){CKEDITOR.ui.button._.instances[a.index]=null}}}}if(this.contextMenu){CKEDITOR.tools.removeFunction(this.contextMenu._.functionId)}if(this._.filebrowserFn){CKEDITOR.tools.removeFunction(this._.filebrowserFn)}this.fire("destroy");CKEDITOR.remove(this);CKEDITOR.fire("instanceDestroyed",null,this)},execCommand:function(a,c){var d=this.getCommand(a);var b={name:a,commandData:c,command:d};if(d&&d.state!=CKEDITOR.TRISTATE_DISABLED){if(this.fire("beforeCommandExec",b)!==true){b.returnValue=d.exec(b.commandData);if(!d.async&&this.fire("afterCommandExec",b)!==true){return b.returnValue}}}return false},getCommand:function(a){return this._.commands[a]},getData:function(){this.fire("beforeGetData");var b=this._.data;if(typeof b!="string"){var a=this.element;if(a&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE){b=a.is("textarea")?a.getValue():a.getHtml()}else{b=""}}b={dataValue:b};this.fire("getData",b);return b.dataValue},getSnapshot:function(){var b=this.fire("getSnapshot");if(typeof b!="string"){var a=this.element;if(a&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE){b=a.is("textarea")?a.getValue():a.getHtml()}}return b},loadSnapshot:function(a){this.fire("loadSnapshot",a)},setData:function(b,c){if(c){this.on("dataReady",function(d){d.removeListener();c.call(d.editor)})}var a={dataValue:b};this.fire("setData",a);this._.data=a.dataValue;this.fire("afterSetData",a)},insertHtml:function(a){this.fire("insertHtml",a)},insertText:function(a){this.fire("insertText",a)},insertElement:function(a){this.fire("insertElement",a)},checkDirty:function(){return(this.mayBeDirty&&this._.previousValue!==this.getSnapshot())},resetDirty:function(){if(this.mayBeDirty){this._.previousValue=this.getSnapshot()}},updateElement:function(){var a=this.element;if(a&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE){var b=this.getData();if(this.config.htmlEncodeOutput){b=CKEDITOR.tools.htmlEncode(b)}if(a.is("textarea")){a.setValue(b)}else{a.setHtml(b)}}}});CKEDITOR.on("loaded",function(){var b=CKEDITOR.editor._pending;if(b){delete CKEDITOR.editor._pending;for(var a=0;a<b.length;a++){b[a]._init()}}});CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:new RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)-->)|(?:([^\\s>]+)\\s*((?:(?:[^\"'>]+)|(?:\"[^\"]*\")|(?:'[^']*'))*)\\/?>))","g")}};(function(){var b=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,a={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(j){var g,f,k=0,p;while((g=this._.htmlPartsRegex.exec(j))){var n=g.index;if(n>k){var q=j.substring(k,n);if(p){p.push(q)}else{this.onText(q)}}k=this._.htmlPartsRegex.lastIndex;if((f=g[1])){f=f.toLowerCase();if(p&&CKEDITOR.dtd.$cdata[f]){this.onCDATA(p.join(""));p=null}if(!p){this.onTagClose(f);continue}}if(p){p.push(g[0]);continue}if((f=g[3])){f=f.toLowerCase();if(/="/.test(f)){continue}var c={},d,h=g[4],m=!!(h&&h.charAt(h.length-1)=="/");if(h){while((d=b.exec(h))){var l=d[1].toLowerCase(),o=d[2]||d[3]||d[4]||"";if(!o&&a[l]){c[l]=l}else{c[l]=o}}}this.onTagOpen(f,c,m);if(!p&&CKEDITOR.dtd.$cdata[f]){p=[]}continue}if((f=g[2])){this.onComment(f)}}if(j.length>k){this.onText(j.substring(k,j.length))}}}})();CKEDITOR.htmlParser.comment=function(a){this.value=a;this._={isBlockLike:false}};CKEDITOR.htmlParser.comment.prototype={type:CKEDITOR.NODE_COMMENT,writeHtml:function(b,a){var c=this.value;if(a){if(!(c=a.onComment(c,this))){return}if(typeof c!="string"){c.parent=this.parent;c.writeHtml(b,a);return}}b.comment(c)}};(function(){var a=/[\t\r\n ]{2,}|[\t\r\n]/g;CKEDITOR.htmlParser.text=function(b){this.value=b;this._={isBlockLike:false}};CKEDITOR.htmlParser.text.prototype={type:CKEDITOR.NODE_TEXT,writeHtml:function(c,b){var d=this.value;if(b&&!(d=b.onText(d,this))){return}c.text(d)}}})();(function(){CKEDITOR.htmlParser.cdata=function(a){this.value=a};CKEDITOR.htmlParser.cdata.prototype={type:CKEDITOR.NODE_TEXT,writeHtml:function(a){a.write(this.value)}}})();CKEDITOR.htmlParser.fragment=function(){this.children=[];this.parent=null;this._={isBlockLike:true,hasInlineStarted:false}};(function(){var c={colgroup:1,dd:1,dt:1,li:1,option:1,p:1,td:1,tfoot:1,th:1,thead:1,tr:1};var a=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),d=CKEDITOR.dtd.$list,b=CKEDITOR.dtd.$listItem;CKEDITOR.htmlParser.fragment.fromHtml=function(o,v){var g=new CKEDITOR.htmlParser(),n=[],q=new CKEDITOR.htmlParser.fragment(),r=[],s=[],h=q,p=false,f;function l(C){var y;if(r.length>0){for(var z=0;z<r.length;z++){var x=r[z],A=x.name,B=CKEDITOR.dtd[A],w=h.name&&CKEDITOR.dtd[h.name];if((!w||w[A])&&(!C||!B||B[C]||!CKEDITOR.dtd[C])){if(!y){m();y=1}x=x.clone();x.parent=h;h=x;r.splice(z,1);z--}}}}function m(w){while(s.length-(w||0)>0){h.add(s.shift())}}function k(z,B,A){B=B||h||q;if(v&&!B.type){var E,y;if(z.attributes&&(y=z.attributes["data-cke-real-element-type"])){E=y}else{E=z.name}if(E&&!(E in CKEDITOR.dtd.$body)&&!(E in CKEDITOR.dtd.$nonBodyContent)){var D=h;h=B;g.onTagOpen(v,{});B=h;if(A){h=D}}}if(z._.isBlockLike&&z.name!="pre"){var x=z.children.length,w=z.children[x-1],C;if(w&&w.type==CKEDITOR.NODE_TEXT){if(!(C=CKEDITOR.tools.rtrim(w.value))){z.children.length=x-1}else{w.value=C}}}B.add(z);if(z.returnPoint){h=z.returnPoint;delete z.returnPoint}}g.onTagOpen=function(z,A,D){var B=new CKEDITOR.htmlParser.element(z,A);if(B.isUnknown&&D){B.isEmpty=true}if(CKEDITOR.dtd.$removeEmpty[z]){r.push(B);return}else{if(z=="pre"){p=true}else{if(z=="br"&&p){h.add(new CKEDITOR.htmlParser.text("\n"));return}}}var F=h.name;var E=F&&(CKEDITOR.dtd[F]||(h._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span));if(E&&!B.isUnknown&&!h.isUnknown&&!E[z]){var C=false,x;if(z in d&&F in d){var y=h.children,w=y[y.length-1];if(!(w&&w.name in b)){k((w=new CKEDITOR.htmlParser.element("li")),h)}f=h,x=w}else{if(z==F){k(h,h.parent)}else{if(z in CKEDITOR.dtd.$listItem){g.onTagOpen("ul",{});x=h;C=true}else{if(a[F]){if(!f){f=h}}else{k(h,h.parent,true);if(!c[F]){r.unshift(h)}}C=true}}}if(x){h=x}else{h=h.returnPoint||h.parent}if(C){g.onTagOpen.apply(this,arguments);return}}l(z);m();B.parent=h;B.returnPoint=f;f=0;if(B.isEmpty){k(B)}else{h=B}};g.onTagClose=function(y){for(var x=r.length-1;x>=0;x--){if(y==r[x].name){r.splice(x,1);return}}var B=[],w=[],z=h;while(z.type&&z.name!=y){if(!z._.isBlockLike){w.unshift(z)}B.push(z);z=z.parent}if(z.type){for(x=0;x<B.length;x++){var A=B[x];k(A,A.parent)}h=z;if(h.name=="pre"){p=false}if(z._.isBlockLike){m()}k(z,z.parent);if(z==h){h=h.parent}r=r.concat(w)}if(y=="body"){v=false}};g.onText=function(w){if(!h._.hasInlineStarted&&!p){w=CKEDITOR.tools.ltrim(w);if(w.length===0){return}}m();l();if(v&&(!h.type||h.name=="body")&&CKEDITOR.tools.trim(w)){this.onTagOpen(v,{})}if(!p){w=w.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")}h.add(new CKEDITOR.htmlParser.text(w))};g.onCDATA=function(w){h.add(new CKEDITOR.htmlParser.cdata(w))};g.onComment=function(w){l();h.add(new CKEDITOR.htmlParser.comment(w))};g.parse(o);m(!CKEDITOR.env.ie&&1);while(h.type){var u=h.parent,j=h;if(v&&(!u.type||u.name=="body")&&!CKEDITOR.dtd.$body[j.name]){h=u;g.onTagOpen(v,{});u=h}u.add(j);h=u}return q};CKEDITOR.htmlParser.fragment.prototype={add:function(h){var f=this.children.length,g=f>0&&this.children[f-1]||null;if(g){if(h._.isBlockLike&&g.type==CKEDITOR.NODE_TEXT){g.value=CKEDITOR.tools.rtrim(g.value);if(g.value.length===0){this.children.pop();this.add(h);return}}g.next=h}h.previous=g;h.parent=this;this.children.push(h);this._.hasInlineStarted=h.type==CKEDITOR.NODE_TEXT||(h.type==CKEDITOR.NODE_ELEMENT&&!h._.isBlockLike)},writeHtml:function(h,f){var g;this.filterChildren=function(){var k=new CKEDITOR.htmlParser.basicWriter();this.writeChildrenHtml.call(this,k,f,true);var j=k.getHtml();this.children=new CKEDITOR.htmlParser.fragment.fromHtml(j).children;g=1};!this.name&&f&&f.onFragment(this);this.writeChildrenHtml(h,g?null:f)},writeChildrenHtml:function(h,g){for(var f=0;f<this.children.length;f++){this.children[f].writeHtml(h,g)}}}})();CKEDITOR.htmlParser.element=function(b,a){this.name=b;this.attributes=a||(a={});this.children=[];var c=a["data-cke-real-element-type"]||b;var d=CKEDITOR.dtd,f=!!(d.$nonBodyContent[c]||d.$block[c]||d.$listItem[c]||d.$tableContent[c]||d.$nonEditable[c]||c=="br"),g=!!d.$empty[b];this.isEmpty=g;this.isUnknown=!d[b];this._={isBlockLike:f,hasInlineStarted:g||!f}};(function(){var a=function(d,c){d=d[0];c=c[0];return d<c?-1:d>c?1:0};CKEDITOR.htmlParser.element.prototype={type:CKEDITOR.NODE_ELEMENT,add:CKEDITOR.htmlParser.fragment.prototype.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},writeHtml:function(d,b){var f=this.attributes;var j=this,c=j.name,n,l,p;var o;j.filterChildren=function(){if(!o){var q=new CKEDITOR.htmlParser.basicWriter();CKEDITOR.htmlParser.fragment.prototype.writeChildrenHtml.call(j,q,b);j.children=new CKEDITOR.htmlParser.fragment.fromHtml(q.getHtml()).children;o=1}};if(b){while(true){if(!(c=b.onElementName(c))){return}j.name=c;if(!(j=b.onElement(j))){return}j.parent=this.parent;if(j.name==c){break}if(j.type!=CKEDITOR.NODE_ELEMENT){j.writeHtml(d,b);return}c=j.name;if(!c){this.writeChildrenHtml.call(j,d,o?null:b);return}}f=j.attributes}d.openTag(c,f);var k=[];for(var h=0;h<2;h++){for(n in f){l=n;p=f[n];if(h==1){k.push([n,p])}else{if(b){while(true){if(!(l=b.onAttributeName(n))){delete f[n];break}else{if(l!=n){delete f[n];n=l;continue}else{break}}}if(l){if((p=b.onAttribute(j,l,p))===false){delete f[l]}else{f[l]=p}}}}}}if(d.sortAttributes){k.sort(a)}var m=k.length;for(h=0;h<m;h++){var g=k[h];d.attribute(g[0],g[1])}d.openTagClose(c,j.isEmpty);if(!j.isEmpty){this.writeChildrenHtml.call(j,d,o?null:b);d.closeTag(c)}},writeChildrenHtml:function(c,b){CKEDITOR.htmlParser.fragment.prototype.writeChildrenHtml.apply(this,arguments)}}})();(function(){CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(g){this._={elementNames:[],attributeNames:[],elements:{$length:0},attributes:{$length:0}};if(g){this.addRules(g,10)}},proto:{addRules:function(h,g){if(typeof g!="number"){g=10}a(this._.elementNames,h.elementNames,g);a(this._.attributeNames,h.attributeNames,g);f(this._.elements,h.elements,g);f(this._.attributes,h.attributes,g);this._.text=d(this._.text,h.text,g)||this._.text;this._.comment=d(this._.comment,h.comment,g)||this._.comment;this._.root=d(this._.root,h.root,g)||this._.root},onElementName:function(g){return c(g,this._.elementNames)},onAttributeName:function(g){return c(g,this._.attributeNames)},onText:function(h){var g=this._.text;return g?g.filter(h):h},onComment:function(h,j){var g=this._.comment;return g?g.filter(h,j):h},onFragment:function(g){var h=this._.root;return h?h.filter(g):g},onElement:function(j){var l=[this._.elements["^"],this._.elements[j.name],this._.elements.$],k,g;for(var h=0;h<3;h++){k=l[h];if(k){g=k.filter(j,this);if(g===false){return null}if(g&&g!=j){return this.onNode(g)}if(j.parent&&!j.name){break}}}return j},onNode:function(h){var g=h.type;return g==CKEDITOR.NODE_ELEMENT?this.onElement(h):g==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(h.value)):g==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(h.value)):null},onAttribute:function(j,h,l){var k=this._.attributes[h];if(k){var g=k.filter(l,j,this);if(g===false){return false}if(typeof g!="undefined"){return g}}return l}}});function c(g,k){for(var h=0;g&&h<k.length;h++){var j=k[h];g=g.replace(j[0],j[1])}return g}function a(o,g,m){if(typeof g=="function"){g=[g]}var l,k,p=o.length,h=g&&g.length;if(h){for(l=0;l<p&&o[l].pri<m;l++){}for(k=h-1;k>=0;k--){var n=g[k];if(n){n.pri=m;o.splice(l,0,n)}}}}function f(k,g,j){if(g){for(var h in g){var l=k[h];k[h]=d(l,g[h],j);if(!l){k.$length++}}}}function d(j,h,g){if(h){h.pri=g;if(j){if(!j.splice){if(j.pri>g){j=[h,j]}else{j=[j,h]}j.filter=b}else{a(j,h,g)}return j}else{h.filter=h;return h}}}function b(j){var m=j.type||j instanceof CKEDITOR.htmlParser.fragment;for(var h=0;h<this.length;h++){if(m){var n=j.type,l=j.name}var k=this[h],g=k.apply(window,arguments);if(g===false){return g}if(m){if(g&&(g.name!=l||g.type!=n)){return g}}else{if(typeof g!="string"){return g}}g!=undefined&&(j=g)}return j}})();CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(b,a){this._.output.push("<",b)},openTagClose:function(a,b){if(b){this._.output.push(" />")}else{this._.output.push(">")}},attribute:function(b,a){if(typeof a=="string"){a=CKEDITOR.tools.htmlEncodeAttr(a)}this._.output.push(" ",b,'="',a,'"')},closeTag:function(a){this._.output.push("</",a,">")},text:function(a){this._.output.push(a)},comment:function(a){this._.output.push("<!--",a,"-->")},write:function(a){this._.output.push(a)},reset:function(){this._.output=[];this._.indent=false},getHtml:function(b){var a=this._.output.join("");if(b){this.reset()}return a}}});delete CKEDITOR.loadFullCore;CKEDITOR.instances={};CKEDITOR.document=new CKEDITOR.dom.document(document);CKEDITOR.add=function(a){CKEDITOR.instances[a.name]=a;a.on("focus",function(){if(CKEDITOR.currentInstance!=a){CKEDITOR.currentInstance=a;CKEDITOR.fire("currentInstance")}});a.on("blur",function(){if(CKEDITOR.currentInstance==a){CKEDITOR.currentInstance=null;CKEDITOR.fire("currentInstance")}})};CKEDITOR.remove=function(a){delete CKEDITOR.instances[a.name]};CKEDITOR.on("instanceDestroyed",function(){if(CKEDITOR.tools.isEmpty(this.instances)){CKEDITOR.fire("reset")}});CKEDITOR.TRISTATE_ON=1;CKEDITOR.TRISTATE_OFF=2;CKEDITOR.TRISTATE_DISABLED=0;CKEDITOR.dom.comment=CKEDITOR.tools.createClass({base:CKEDITOR.dom.node,$:function(b,a){if(typeof b=="string"){b=(a?a.$:document).createComment(b)}this.base(b)},proto:{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"<!--"+this.$.nodeValue+"-->"}}});(function(){var c={address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,dd:1};var b={body:1,div:1,table:1,tbody:1,tr:1,td:1,th:1,caption:1,form:1};var a=function(f){var h=f.getChildren();for(var d=0,g=h.count();d<g;d++){var j=h.getItem(d);if(j.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[j.getName()]){return true}}return false};CKEDITOR.dom.elementPath=function(g){var k=null;var f=null;var h=[];var j=g;while(j){if(j.type==CKEDITOR.NODE_ELEMENT){if(!this.lastElement){this.lastElement=j}var d=j.getName();if(CKEDITOR.env.ie&&j.$.scopeName!="HTML"){d=j.$.scopeName.toLowerCase()+":"+d}if(!f){if(!k&&c[d]){k=j}if(b[d]){if(!k&&d=="div"&&!a(j)){k=j}else{f=j}}}h.push(j);if(d=="body"){break}}j=j.getParent()}this.block=k;this.blockLimit=f;this.elements=h}})();CKEDITOR.dom.elementPath.prototype={compare:function(d){var c=this.elements;var a=d&&d.elements;if(!a||c.length!=a.length){return false}for(var b=0;b<c.length;b++){if(!c[b].equals(a[b])){return false}}return true},contains:function(a){var c=this.elements;for(var b=0;b<c.length;b++){if(c[b].getName() in a){return c[b]}}return null},isContentEditable:function(){var c=this.elements;var b="true";for(var a=c.length-1;a>=0;a--){if(c[a].$.contentEditable!="inherit"){b=c[a].$.contentEditable}}return b=="true"}};CKEDITOR.dom.text=function(b,a){if(typeof b=="string"){b=(a?a.$:document).createTextNode(b)}this.$=b};CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node();CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},split:function(f){if(CKEDITOR.env.ie&&f==this.getLength()){var c=this.getDocument().createText("");c.insertAfter(this);return c}var d=this.getDocument();var b=new CKEDITOR.dom.text(this.$.splitText(f),d);if(CKEDITOR.env.ie8){var a=new CKEDITOR.dom.text("",d);a.insertAfter(b);a.remove()}return b},substring:function(b,a){if(typeof a!="number"){return this.$.nodeValue.substr(b)}else{return this.$.nodeValue.substring(b,a)}}});CKEDITOR.dom.documentFragment=function(a){a=a||CKEDITOR.document;this.$=a.$.createDocumentFragment()};CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(a){a=a.$;a.parentNode.insertBefore(this.$,a.nextSibling)}},true,{append:1,appendBogus:1,getFirst:1,getLast:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1});(function(){function b(r,n){if(this._.end){return null}var k,o=this.range,p,j=this.guard,q=this.type,v=(r?"getPreviousSourceNode":"getNextSourceNode");if(!this._.start){this._.start=1;o.trim();if(o.collapsed){this.end();return null}}if(!r&&!this._.guardLTR){var m=o.endContainer,s=m.getChild(o.endOffset);this._.guardLTR=function(y,x){return((!x||!m.equals(y))&&(!s||!y.equals(s))&&(y.type!=CKEDITOR.NODE_ELEMENT||!x||y.getName()!="body"))}}if(r&&!this._.guardRTL){var w=o.startContainer,l=(o.startOffset>0)&&w.getChild(o.startOffset-1);this._.guardRTL=function(y,x){return((!x||!w.equals(y))&&(!l||!y.equals(l))&&(y.type!=CKEDITOR.NODE_ELEMENT||!x||y.getName()!="body"))}}var u=r?this._.guardRTL:this._.guardLTR;if(j){p=function(y,x){if(u(y,x)===false){return false}return j(y,x)}}else{p=u}if(this.current){k=this.current[v](false,q,p)}else{if(r){k=o.endContainer;if(o.endOffset>0&&k.getChild){k=k.getChild(o.endOffset-1);if(p(k)===false){k=null}}else{k=(p(k,true)===false)?null:k.getPreviousSourceNode(true,q,p)}}else{k=o.startContainer;if(k.getChild){k=k.getChild(o.startOffset)}if(k){if(p(k)===false){k=null}}else{k=(p(o.startContainer,true)===false)?null:o.startContainer.getNextSourceNode(true,q,p)}}}while(k&&!this._.end){this.current=k;if(!this.evaluator||this.evaluator(k)!==false){if(!n){return k}}else{if(n&&this.evaluator){return false}}k=k[v](false,q,p)}this.end();return this.current=null}function a(l){var k,j=null;while((k=b.call(this,l))){j=k}return j}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(j){this.range=j;this._={}},proto:{end:function(){this._.end=1},next:function(){return b.call(this)},previous:function(){return b.call(this,1)},checkForward:function(){return b.call(this,0,1)!==false},checkBackward:function(){return b.call(this,1,1)!==false},lastForward:function(){return a.call(this)},lastBackward:function(){return a.call(this,1)},reset:function(){delete this.current;this._={}}}});var c={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(k){var j=CKEDITOR.tools.extend({},CKEDITOR.dtd.$block,k||{});return this.getComputedStyle("float")=="none"&&c[this.getComputedStyle("display")]||j[this.getName()]};CKEDITOR.dom.walker.blockBoundary=function(j){return function(l,k){return !(l.type==CKEDITOR.NODE_ELEMENT&&l.isBlockBoundary(j))}};CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})};CKEDITOR.dom.walker.bookmark=function(l,k){function j(m){return(m&&m.getName&&m.getName()=="span"&&m.data("cke-bookmark"))}return function(o){var m,n;m=(o&&!o.getName&&(n=o.getParent())&&j(n));m=l?m:m||j(o);return !!(k^m)}};CKEDITOR.dom.walker.whitespaces=function(j){return function(l){var k=l&&(l.type==CKEDITOR.NODE_TEXT)&&!CKEDITOR.tools.trim(l.getText());return !!(j^k)}};CKEDITOR.dom.walker.invisible=function(k){var j=CKEDITOR.dom.walker.whitespaces();return function(l){var m=j(l)||l.is&&!l.$.offsetHeight;return !!(k^m)}};var g=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,h=CKEDITOR.dom.walker.whitespaces(1),f=CKEDITOR.dom.walker.bookmark(0,1),d=function(j){return f(j)&&h(j)};CKEDITOR.dom.element.prototype.getBogus=function(){var j=this.getLast(d);if(j&&(!CKEDITOR.env.ie?j.is&&j.is("br"):j.getText&&g.test(j.getText()))){return j}return false}})();CKEDITOR.dom.range=function(a){this.startContainer=null;this.startOffset=null;this.endContainer=null;this.endOffset=null;this.collapsed=true;this.document=a};(function(){var j=function(k){k.collapsed=(k.startContainer&&k.endContainer&&k.startContainer.equals(k.endContainer)&&k.startOffset==k.endOffset)};var h=function(w,B,l){w.optimizeBookmark();var I=w.startContainer;var y=w.endContainer;var D=w.startOffset;var r=w.endOffset;var A;var s;if(y.type==CKEDITOR.NODE_TEXT){y=y.split(r)}else{if(y.getChildCount()>0){if(r>=y.getChildCount()){y=y.append(w.document.createText(""));s=true}else{y=y.getChild(r)}}}if(I.type==CKEDITOR.NODE_TEXT){I.split(D);if(I.equals(y)){y=I.getNext()}}else{if(!D){I=I.getFirst().insertBeforeMe(w.document.createText(""));A=true}else{if(D>=I.getChildCount()){I=I.append(w.document.createText(""));A=true}else{I=I.getChild(D).getPrevious()}}}var F=I.getParents();var n=y.getParents();var E,J,H;for(E=0;E<F.length;E++){J=F[E];H=n[E];if(!J.equals(H)){break}}var G=l,x,v,p,u;for(var C=E;C<F.length;C++){x=F[C];if(G&&!x.equals(I)){v=G.append(x.clone())}p=x.getNext();while(p){if(p.equals(n[C])||p.equals(y)){break}u=p.getNext();if(B==2){G.append(p.clone(true))}else{p.remove();if(B==1){G.append(p)}}p=u}if(G){G=v}}G=l;for(var z=E;z<n.length;z++){x=n[z];if(B>0&&!x.equals(y)){v=G.append(x.clone())}if(!F[z]||x.$.parentNode!=F[z].$.parentNode){p=x.getPrevious();while(p){if(p.equals(F[z])||p.equals(I)){break}u=p.getPrevious();if(B==2){G.$.insertBefore(p.$.cloneNode(true),G.$.firstChild)}else{p.remove();if(B==1){G.$.insertBefore(p.$,G.$.firstChild)}}p=u}}if(G){G=v}}if(B==2){var m=w.startContainer;if(m.type==CKEDITOR.NODE_TEXT){m.$.data+=m.$.nextSibling.data;m.$.parentNode.removeChild(m.$.nextSibling)}var q=w.endContainer;if(q.type==CKEDITOR.NODE_TEXT&&q.$.nextSibling){q.$.data+=q.$.nextSibling.data;q.$.parentNode.removeChild(q.$.nextSibling)}}else{if(J&&H&&(I.$.parentNode!=J.$.parentNode||y.$.parentNode!=H.$.parentNode)){var o=H.getIndex();if(A&&H.$.parentNode==I.$.parentNode){o--}w.setStart(H.getParent(),o)}w.collapse(true)}if(A){I.remove()}if(s&&y.$.parentNode){y.remove()}};var d={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1};function c(l){var m=false,k=CKEDITOR.dom.walker.bookmark(true);return function(n){if(k(n)){return true}if(n.type==CKEDITOR.NODE_TEXT){if(CKEDITOR.tools.trim(n.getText()).length){return false}}else{if(n.type==CKEDITOR.NODE_ELEMENT){if(n.$.nodeType==CKEDITOR.NODE_COMMENT){return false}if(!d[n.getName()]){if(!l&&!CKEDITOR.env.ie&&n.getName()=="br"&&!m){m=true}else{return false}}}}return true}}function f(k){return k.type!=CKEDITOR.NODE_TEXT&&k.getName() in CKEDITOR.dtd.$removeEmpty||!CKEDITOR.tools.trim(k.getText())||!!k.getParent().data("cke-bookmark")}var g=new CKEDITOR.dom.walker.whitespaces(),a=new CKEDITOR.dom.walker.bookmark();function b(k){return !g(k)&&!a(k)}CKEDITOR.dom.range.prototype={clone:function(){var k=new CKEDITOR.dom.range(this.document);k.startContainer=this.startContainer;k.startOffset=this.startOffset;k.endContainer=this.endContainer;k.endOffset=this.endOffset;k.collapsed=this.collapsed;return k},collapse:function(k){if(k){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this.collapsed=true},cloneContents:function(){var k=new CKEDITOR.dom.documentFragment(this.document);if(!this.collapsed){h(this,2,k)}return k},deleteContents:function(){if(this.collapsed){return}h(this,0)},extractContents:function(){var k=new CKEDITOR.dom.documentFragment(this.document);if(!this.collapsed){h(this,1,k)}return k},createBookmark:function(n){var m,k;var l;var p;var o=this.collapsed;m=this.document.createElement("span");m.data("cke-bookmark",1);m.setStyle("display","none");m.setHtml("&nbsp;");if(n){l="cke_bm_"+CKEDITOR.tools.getNextNumber();m.setAttribute("id",l+"S")}if(!o){k=m.clone();k.setHtml("&nbsp;");if(n){k.setAttribute("id",l+"E")}p=this.clone();p.collapse();p.insertNode(k)}p=this.clone();p.collapse(true);p.insertNode(m);if(k){this.setStartAfter(m);this.setEndBefore(k)}else{this.moveToPosition(m,CKEDITOR.POSITION_AFTER_END)}return{startNode:n?l+"S":m,endNode:n?l+"E":k,serializable:n,collapsed:o}},createBookmark2:function(q){var n=this.startContainer,o=this.endContainer;var k=this.startOffset,l=this.endOffset;var p=this.collapsed;var r,m;if(!n||!o){return{start:0,end:0}}if(q){if(n.type==CKEDITOR.NODE_ELEMENT){r=n.getChild(k);if(r&&r.type==CKEDITOR.NODE_TEXT&&k>0&&r.getPrevious().type==CKEDITOR.NODE_TEXT){n=r;k=0}}while(n.type==CKEDITOR.NODE_TEXT&&(m=n.getPrevious())&&m.type==CKEDITOR.NODE_TEXT){n=m;k+=m.getLength()}if(!p){if(o.type==CKEDITOR.NODE_ELEMENT){r=o.getChild(l);if(r&&r.type==CKEDITOR.NODE_TEXT&&l>0&&r.getPrevious().type==CKEDITOR.NODE_TEXT){o=r;l=0}}while(o.type==CKEDITOR.NODE_TEXT&&(m=o.getPrevious())&&m.type==CKEDITOR.NODE_TEXT){o=m;l+=m.getLength()}}}return{start:n.getAddress(q),end:p?null:o.getAddress(q),startOffset:k,endOffset:l,normalized:q,collapsed:p,is2:true}},moveToBookmark:function(p){if(p.is2){var q=this.document.getByAddress(p.start,p.normalized),l=p.startOffset;var r=p.end&&this.document.getByAddress(p.end,p.normalized),n=p.endOffset;this.setStart(q,l);if(r){this.setEnd(r,n)}else{this.collapse(true)}}else{var o=p.serializable,m=o?this.document.getById(p.startNode):p.startNode,k=o?this.document.getById(p.endNode):p.endNode;this.setStartBefore(m);m.remove();if(k){this.setEndBefore(k);k.remove()}else{this.collapse(true)}}},getBoundaryNodes:function(){var o=this.startContainer,l=this.endContainer,k=this.startOffset,n=this.endOffset,m;if(o.type==CKEDITOR.NODE_ELEMENT){m=o.getChildCount();if(m>k){o=o.getChild(k)}else{if(m<1){o=o.getPreviousSourceNode()}else{o=o.$;while(o.lastChild){o=o.lastChild}o=new CKEDITOR.dom.node(o);o=o.getNextSourceNode()||o}}}if(l.type==CKEDITOR.NODE_ELEMENT){m=l.getChildCount();if(m>n){l=l.getChild(n).getPreviousSourceNode(true)}else{if(m<1){l=l.getPreviousSourceNode()}else{l=l.$;while(l.lastChild){l=l.lastChild}l=new CKEDITOR.dom.node(l)}}}if(o.getPosition(l)&CKEDITOR.POSITION_FOLLOWING){o=l}return{startNode:o,endNode:l}},getCommonAncestor:function(l,n){var o=this.startContainer,k=this.endContainer,m;if(o.equals(k)){if(l&&o.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1){m=o.getChild(this.startOffset)}else{m=o}}else{m=o.getCommonAncestor(k)}return n&&!m.is?m.getParent():m},optimize:function(){var k=this.startContainer;var l=this.startOffset;if(k.type!=CKEDITOR.NODE_ELEMENT&&k.type!=CKEDITOR.NODE_COMMENT){if(!l){this.setStartBefore(k)}else{if(l>=k.getLength()){this.setStartAfter(k)}}}k=this.endContainer;l=this.endOffset;if(k.type!=CKEDITOR.NODE_ELEMENT&&k.type!=CKEDITOR.NODE_COMMENT){if(!l){this.setEndBefore(k)}else{if(l>=k.getLength()){this.setEndAfter(k)}}}},optimizeBookmark:function(){var l=this.startContainer,k=this.endContainer;if(l.is&&l.is("span")&&l.data("cke-bookmark")){this.setStartAt(l,CKEDITOR.POSITION_BEFORE_START)}if(k&&k.is&&k.is("span")&&k.data("cke-bookmark")){this.setEndAt(k,CKEDITOR.POSITION_AFTER_END)}},trim:function(n,q){var o=this.startContainer,k=this.startOffset,r=this.collapsed;if((!n||r)&&o&&o.type==CKEDITOR.NODE_TEXT){if(!k){k=o.getIndex();o=o.getParent()}else{if(k>=o.getLength()){k=o.getIndex()+1;o=o.getParent()}else{var m=o.split(k);k=o.getIndex()+1;o=o.getParent();if(this.startContainer.equals(this.endContainer)){this.setEnd(m,this.endOffset-this.startOffset)}else{if(o.equals(this.endContainer)){this.endOffset+=1}}}}this.setStart(o,k);if(r){this.collapse(true);return}}var p=this.endContainer;var l=this.endOffset;if(!(q||r)&&p&&p.type==CKEDITOR.NODE_TEXT){if(!l){l=p.getIndex();p=p.getParent()}else{if(l>=p.getLength()){l=p.getIndex()+1;p=p.getParent()}else{p.split(l);l=p.getIndex()+1;p=p.getParent()}}this.setEnd(p,l)}},enlarge:function(w){switch(w){case CKEDITOR.ENLARGE_ELEMENT:if(this.collapsed){return}var l=this.getCommonAncestor();var s=this.document.getBody();var n,H;var C,G,q;var m=false;var x;var k;var u=this.startContainer;var o=this.startOffset;if(u.type==CKEDITOR.NODE_TEXT){if(o){u=!CKEDITOR.tools.trim(u.substring(0,o)).length&&u;m=!!u}if(u){if(!(G=u.getPrevious())){C=u.getParent()}}}else{if(o){G=u.getChild(o-1)||u.getLast()}if(!G){C=u}}while(C||G){if(C&&!G){if(!q&&C.equals(l)){q=true}if(!s.contains(C)){break}if(!m||C.getComputedStyle("display")!="inline"){m=false;if(q){n=C}else{this.setStartBefore(C)}}G=C.getPrevious()}while(G){x=false;if(G.type==CKEDITOR.NODE_TEXT){k=G.getText();if(/[^\s\ufeff]/.test(k)){G=null}x=/[\s\ufeff]$/.test(k)}else{if(G.$.offsetWidth>0&&G.$.nodeType==CKEDITOR.NODE_ELEMENT&&!G.data("cke_bookmark")){if(m&&CKEDITOR.dtd.$removeEmpty[G.getName()]){k=G.getText();if((/[^\s\ufeff]/).test(k)){G=null}else{var A=G.$.all||G.$.getElementsByTagName("*");for(var F=0,p;p=A[F++];){if(!CKEDITOR.dtd.$removeEmpty[p.nodeName.toLowerCase()]){G=null;break}}}if(G){x=!!k.length}}else{G=null}}}if(x){if(m){if(q){n=C}else{if(C){this.setStartBefore(C)}}}else{m=true}}if(G){var B=G.getPrevious();if(!C&&!B){C=G;G=null;break}G=B}else{C=null}}if(C){C=C.getParent()}}u=this.endContainer;o=this.endOffset;C=G=null;q=m=false;if(u.type==CKEDITOR.NODE_TEXT){u=!CKEDITOR.tools.trim(u.substring(o)).length&&u;m=!(u&&u.getLength());if(u){if(!(G=u.getNext())){C=u.getParent()}}}else{G=u.getChild(o);if(!G){C=u}}while(C||G){if(C&&!G){if(!q&&C.equals(l)){q=true}if(!s.contains(C)){break}if(!m||C.getComputedStyle("display")!="inline"){m=false;if(q){H=C}else{if(C){this.setEndAfter(C)}}}G=C.getNext()}while(G){x=false;if(G.type==CKEDITOR.NODE_TEXT){k=G.getText();if(/[^\s\ufeff]/.test(k)){G=null}x=/^[\s\ufeff]/.test(k)}else{if(G.$.offsetWidth>0&&G.$.nodeType==CKEDITOR.NODE_ELEMENT&&!G.data("cke_bookmark")){if(m&&CKEDITOR.dtd.$removeEmpty[G.getName()]){k=G.getText();if((/[^\s\ufeff]/).test(k)){G=null}else{A=G.$.all||G.$.getElementsByTagName("*");for(F=0;p=A[F++];){if(!CKEDITOR.dtd.$removeEmpty[p.nodeName.toLowerCase()]){G=null;break}}}if(G){x=!!k.length}}else{G=null}}}if(x){if(m){if(q){H=C}else{this.setEndAfter(C)}}}if(G){B=G.getNext();if(!C&&!B){C=G;G=null;break}G=B}else{C=null}}if(C){C=C.getParent()}}if(n&&H){l=n.contains(H)?H:n;this.setStartBefore(l);this.setEndAfter(l)}break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:var z=new CKEDITOR.dom.range(this.document);s=this.document.getBody();z.setStartAt(s,CKEDITOR.POSITION_AFTER_START);z.setEnd(this.startContainer,this.startOffset);var E=new CKEDITOR.dom.walker(z),I,v,D=CKEDITOR.dom.walker.blockBoundary((w==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS)?{br:1}:null),r=function(K){var J=D(K);if(!J){I=K}return J},y=function(K){var J=r(K);if(!J&&K.is&&K.is("br")){v=K}return J};E.guard=r;C=E.lastBackward();I=I||s;this.setStartAt(I,!I.is("br")&&(!C&&this.checkStartOfBlock()||C&&I.contains(C))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END);z=this.clone();z.collapse();z.setEndAt(s,CKEDITOR.POSITION_BEFORE_END);E=new CKEDITOR.dom.walker(z);E.guard=(w==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS)?y:r;I=null;C=E.lastForward();I=I||s;this.setEndAt(I,(!C&&this.checkEndOfBlock()||C&&I.contains(C))?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START);if(v){this.setEndAfter(v)}}},shrink:function(r,x){if(!this.collapsed){r=r||CKEDITOR.SHRINK_TEXT;var m=this.clone();var n=this.startContainer,z=this.endContainer,v=this.startOffset,w=this.endOffset,p=this.collapsed;var l=1,y=1;if(n&&n.type==CKEDITOR.NODE_TEXT){if(!v){m.setStartBefore(n)}else{if(v>=n.getLength()){m.setStartAfter(n)}else{m.setStartBefore(n);l=0}}}if(z&&z.type==CKEDITOR.NODE_TEXT){if(!w){m.setEndBefore(z)}else{if(w>=z.getLength()){m.setEndAfter(z)}else{m.setEndAfter(z);y=0}}}var k=new CKEDITOR.dom.walker(m),o=CKEDITOR.dom.walker.bookmark();k.evaluator=function(A){return A.type==(r==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)};var q;k.guard=function(B,A){if(o(B)){return true}if(r==CKEDITOR.SHRINK_ELEMENT&&B.type==CKEDITOR.NODE_TEXT){return false}if(A&&B.equals(q)){return false}if(!A&&B.type==CKEDITOR.NODE_ELEMENT){q=B}return true};if(l){var u=k[r==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]();u&&this.setStartAt(u,x?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START)}if(y){k.reset();var s=k[r==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]();s&&this.setEndAt(s,x?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)}return !!(l||y)}},enlargeFormattables:function(){var k;if(this.startContainer.isReadOnly()){if(k=this.startContainer.findFormattableAncestor()){this.setStartBefore(k)}}if(this.endContainer.isReadOnly()){if(k=this.endContainer.findFormattableAncestor()){this.setEndAfter(k)}}return this},insertNode:function(n){this.optimizeBookmark();this.trim(false,true);var m=this.startContainer;var l=this.startOffset;if(typeof m.getChild!="function"){var k=new CKEDITOR.dom.element(m.$.previousSibling)}else{var k=m.getChild(l)}if(k){n.insertBefore(k)}else{m.append(n)}if(n.getParent().equals(this.endContainer)){this.endOffset++}this.setStartBefore(n)},moveToPosition:function(l,k){this.setStartAt(l,k);this.collapse(true)},selectNodeContents:function(k){this.setStart(k,0);this.setEnd(k,k.type==CKEDITOR.NODE_TEXT?k.getLength():k.getChildCount())},setStart:function(l,k){if(l.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[l.getName()]){k=l.getIndex(),l=l.getParent()}this.startContainer=l;this.startOffset=k;if(!this.endContainer){this.endContainer=l;this.endOffset=k}j(this)},setEnd:function(k,l){if(k.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[k.getName()]){l=k.getIndex()+1,k=k.getParent()}this.endContainer=k;this.endOffset=l;if(!this.startContainer){this.startContainer=k;this.startOffset=l}j(this)},setStartAfter:function(k){this.setStart(k.getParent(),k.getIndex()+1)},setStartBefore:function(k){this.setStart(k.getParent(),k.getIndex())},setEndAfter:function(k){this.setEnd(k.getParent(),k.getIndex()+1)},setEndBefore:function(k){this.setEnd(k.getParent(),k.getIndex())},setStartAt:function(l,k){switch(k){case CKEDITOR.POSITION_AFTER_START:this.setStart(l,0);break;case CKEDITOR.POSITION_BEFORE_END:if(l.type==CKEDITOR.NODE_TEXT){this.setStart(l,l.getLength())}else{this.setStart(l,l.getChildCount())}break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(l);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(l)}j(this)},setEndAt:function(l,k){switch(k){case CKEDITOR.POSITION_AFTER_START:this.setEnd(l,0);break;case CKEDITOR.POSITION_BEFORE_END:if(l.type==CKEDITOR.NODE_TEXT){this.setEnd(l,l.getLength())}else{this.setEnd(l,l.getChildCount())}break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(l);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(l)}j(this)},fixBlock:function(k,n){var m=this.createBookmark(),l=this.document.createElement(n);this.collapse(k);this.enlargeFormattables();this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS);this.extractContents().appendTo(l);l.trim();if(!CKEDITOR.env.ie){l.appendBogus()}this.insertNode(l);this.moveToBookmark(m);return l},splitBlock:function(p){var s=new CKEDITOR.dom.elementPath(this.startContainer),m=new CKEDITOR.dom.elementPath(this.endContainer);var r=s.blockLimit,o=m.blockLimit;var q=s.block,n=m.block;var u=null;if(!r.equals(o)){return null}if(p!="br"){if(!q){q=this.fixBlock(true,p);n=new CKEDITOR.dom.elementPath(this.endContainer).block}if(!n){n=this.fixBlock(false,p)}}var l=q&&this.checkStartOfBlock(),k=n&&this.checkEndOfBlock();this.deleteContents();if(q&&q.equals(n)){if(k){u=new CKEDITOR.dom.elementPath(this.startContainer);this.moveToPosition(n,CKEDITOR.POSITION_AFTER_END);n=null}else{if(l){u=new CKEDITOR.dom.elementPath(this.startContainer);this.moveToPosition(q,CKEDITOR.POSITION_BEFORE_START);q=null}else{n=this.splitElement(q);if(!CKEDITOR.env.ie&&!q.is("ul","ol")){q.appendBogus()}}}}return{previousBlock:q,nextBlock:n,wasStartOfBlock:l,wasEndOfBlock:k,elementPath:u}},splitElement:function(l){if(!this.collapsed){return null}this.setEndAt(l,CKEDITOR.POSITION_BEFORE_END);var k=this.extractContents();var m=l.clone(false);k.appendTo(m);m.insertAfter(l);this.moveToPosition(l,CKEDITOR.POSITION_AFTER_END);return m},checkBoundaryOfElement:function(m,k){var n=(k==CKEDITOR.START);var l=this.clone();l.collapse(n);l[n?"setStartAt":"setEndAt"](m,n?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END);var o=new CKEDITOR.dom.walker(l);o.evaluator=f;return o[n?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var n=this.startContainer,k=this.startOffset;if(k&&n.type==CKEDITOR.NODE_TEXT){var m=CKEDITOR.tools.ltrim(n.substring(0,k));if(m.length){return false}}this.trim();var o=new CKEDITOR.dom.elementPath(this.startContainer);var l=this.clone();l.collapse(true);l.setStartAt(o.block||o.blockLimit,CKEDITOR.POSITION_AFTER_START);var p=new CKEDITOR.dom.walker(l);p.evaluator=c(true);return p.checkBackward()},checkEndOfBlock:function(){var n=this.endContainer,m=this.endOffset;if(n.type==CKEDITOR.NODE_TEXT){var k=CKEDITOR.tools.rtrim(n.substring(m));if(k.length){return false}}this.trim();var o=new CKEDITOR.dom.elementPath(this.endContainer);var l=this.clone();l.collapse(false);l.setEndAt(o.block||o.blockLimit,CKEDITOR.POSITION_BEFORE_END);var p=new CKEDITOR.dom.walker(l);p.evaluator=c(false);return p.checkForward()},moveToElementEditablePosition:function(m,l){var k;if(CKEDITOR.dtd.$empty[m.getName()]){return false}while(m&&m.type==CKEDITOR.NODE_ELEMENT){k=m.isEditable();if(k){this.moveToPosition(m,l?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START)}else{if(CKEDITOR.dtd.$inline[m.getName()]){this.moveToPosition(m,l?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START);return true}}if(CKEDITOR.dtd.$empty[m.getName()]){m=m[l?"getPrevious":"getNext"](b)}else{m=m[l?"getLast":"getFirst"](b)}if(m&&m.type==CKEDITOR.NODE_TEXT){this.moveToPosition(m,l?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START);return true}}return k},moveToElementEditStart:function(k){return this.moveToElementEditablePosition(k)},moveToElementEditEnd:function(k){return this.moveToElementEditablePosition(k,true)},getEnclosedNode:function(){var k=this.clone();k.optimize();if(k.startContainer.type!=CKEDITOR.NODE_ELEMENT||k.endContainer.type!=CKEDITOR.NODE_ELEMENT){return null}var n=new CKEDITOR.dom.walker(k),m=CKEDITOR.dom.walker.bookmark(true),p=CKEDITOR.dom.walker.whitespaces(true),o=function(q){return p(q)&&m(q)};k.evaluator=o;var l=n.next();n.reset();return l&&l.equals(n.previous())?l:null},getTouchedStartNode:function(){var k=this.startContainer;if(this.collapsed||k.type!=CKEDITOR.NODE_ELEMENT){return k}return k.getChild(this.startOffset)||k},getTouchedEndNode:function(){var k=this.endContainer;if(this.collapsed||k.type!=CKEDITOR.NODE_ELEMENT){return k}return k.getChild(this.endOffset-1)||k}}})();CKEDITOR.POSITION_AFTER_START=1;CKEDITOR.POSITION_BEFORE_END=2;CKEDITOR.POSITION_BEFORE_START=3;CKEDITOR.POSITION_AFTER_END=4;CKEDITOR.ENLARGE_ELEMENT=1;CKEDITOR.ENLARGE_BLOCK_CONTENTS=2;CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3;CKEDITOR.START=1;CKEDITOR.END=2;CKEDITOR.STARTEND=3;CKEDITOR.SHRINK_ELEMENT=1;CKEDITOR.SHRINK_TEXT=2;(function(){CKEDITOR.dom.rangeList=function(c){if(c instanceof CKEDITOR.dom.rangeList){return c}if(!c){c=[]}else{if(c instanceof CKEDITOR.dom.range){c=[c]}}return CKEDITOR.tools.extend(c,b)};var b={createIterator:function(){var c=this,f=CKEDITOR.dom.walker.bookmark(),g=function(j){return !(j.is&&j.is("tr"))},d=[],h;return{getNextRange:function(m){h=h==undefined?0:h+1;var o=c[h];if(o&&c.length>1){if(!h){for(var l=c.length-1;l>=0;l--){d.unshift(c[l].createBookmark(true))}}if(m){var j=0;while(c[h+j+1]){var p=o.document,r=0,k=p.getById(d[j].endNode),q=p.getById(d[j+1].startNode),n;while(1){n=k.getNextSourceNode(false);if(!q.equals(n)){if(f(n)||(n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())){k=n;continue}}else{r=1}break}if(!r){break}j++}}o.moveToBookmark(d.shift());while(j--){n=c[++h];n.moveToBookmark(d.shift());o.setEnd(n.endContainer,n.endOffset)}}return o}}},createBookmarks:function(h){var c=[],g;for(var f=0;f<this.length;f++){c.push(g=this[f].createBookmark(h,true));for(var d=f+1;d<this.length;d++){this[d]=a(g,this[d]);this[d]=a(g,this[d],true)}}return c},createBookmarks2:function(f){var d=[];for(var c=0;c<this.length;c++){d.push(this[c].createBookmark2(f))}return d},moveToBookmarks:function(d){for(var c=0;c<this.length;c++){this[c].moveToBookmark(d[c])}}};function a(h,j,l){var g=h.serializable,c=j[l?"endContainer":"startContainer"],k=l?"endOffset":"startOffset";var d=g?j.document.getById(h.startNode):h.startNode;var f=g?j.document.getById(h.endNode):h.endNode;if(c.equals(d.getPrevious())){j.startOffset=j.startOffset-c.getLength()-f.getPrevious().getLength();c=f.getNext()}else{if(c.equals(f.getPrevious())){j.startOffset=j.startOffset-c.getLength();c=f.getNext()}}c.equals(d.getParent())&&j[k]++;c.equals(f.getParent())&&j[k]++;j[l?"endContainer":"startContainer"]=c;return j}})();(function(){if(CKEDITOR.env.webkit){CKEDITOR.env.hc=false;return}var c=CKEDITOR.env.ie&&CKEDITOR.env.version<7,f=CKEDITOR.env.ie&&CKEDITOR.env.version==7;var a=c?(CKEDITOR.basePath+"images/spacer.gif"):f?"about:blank":"data:image/png;base64,";var d=CKEDITOR.dom.element.createFromHtml('<div style="width:0px;height:0px;position:absolute;left:-10000px;background-image:url('+a+')"></div>',CKEDITOR.document);d.appendTo(CKEDITOR.document.getHead());try{CKEDITOR.env.hc=(d.getComputedStyle("background-image")=="none")}catch(b){CKEDITOR.env.hc=false}if(CKEDITOR.env.hc){CKEDITOR.env.cssClass+=" cke_hc"}d.remove()})();CKEDITOR.plugins.load(CKEDITOR.config.corePlugins.split(","),function(){CKEDITOR.status="loaded";CKEDITOR.fire("loaded");var b=CKEDITOR._.pending;if(b){delete CKEDITOR._.pending;for(var a=0;a<b.length;a++){CKEDITOR.add(b[a])}}});if(CKEDITOR.env.ie){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}CKEDITOR.skins.add("kama",(function(){var a="cke_ui_color";return{editor:{css:["editor.css"]},dialog:{css:["dialog.css"]},templates:{css:["templates.css"]},margins:[0,0,0,0],init:function(f){if(f.config.width&&!isNaN(f.config.width)){f.config.width-=12}var d=[];var c=/\$color/g;var k="/* UI Color Support */.cke_skin_kama .cke_menuitem .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_kama .cke_menuitem a:hover .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a:focus .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a:active .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_kama .cke_menuitem a:hover .cke_label,.cke_skin_kama .cke_menuitem a:focus .cke_label,.cke_skin_kama .cke_menuitem a:active .cke_label{	background-color: $color !important;}.cke_skin_kama .cke_menuitem a.cke_disabled:hover .cke_label,.cke_skin_kama .cke_menuitem a.cke_disabled:focus .cke_label,.cke_skin_kama .cke_menuitem a.cke_disabled:active .cke_label{	background-color: transparent !important;}.cke_skin_kama .cke_menuitem a.cke_disabled:hover .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a.cke_disabled:focus .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a.cke_disabled:active .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_kama .cke_menuitem a.cke_disabled .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_kama .cke_menuseparator{	background-color: $color !important;}.cke_skin_kama .cke_menuitem a:hover,.cke_skin_kama .cke_menuitem a:focus,.cke_skin_kama .cke_menuitem a:active{	background-color: $color !important;}";if(CKEDITOR.env.webkit){k=k.split("}").slice(0,-1);for(var b=0;b<k.length;b++){k[b]=k[b].split("{")}}function j(l){var m=l.getById(a);if(!m){m=l.getHead().append("style");m.setAttribute("id",a);m.setAttribute("type","text/css")}return m}function g(q,n,m){var p,l,o;for(var s=0;s<q.length;s++){if(CKEDITOR.env.webkit){for(l=0;l<n.length;l++){o=n[l][1];for(p=0;p<m.length;p++){o=o.replace(m[p][0],m[p][1])}q[s].$.sheet.addRule(n[l][0],o)}}else{o=n;for(p=0;p<m.length;p++){o=o.replace(m[p][0],m[p][1])}if(CKEDITOR.env.ie){q[s].$.styleSheet.cssText+=o}else{q[s].$.innerHTML+=o}}}}var h=/\$color/g;CKEDITOR.tools.extend(f,{uiColor:null,getUiColor:function(){return this.uiColor},setUiColor:function(l){var n,o=j(CKEDITOR.document),q="."+f.id;var p=[q+" .cke_wrapper",q+"_dialog .cke_dialog_contents",q+"_dialog a.cke_dialog_tab",q+"_dialog .cke_dialog_footer"].join(",");var m="background-color: $color !important;";if(CKEDITOR.env.webkit){n=[[p,m]]}else{n=p+"{"+m+"}"}return(this.setUiColor=function(r){var s=[[h,r]];f.uiColor=r;g([o],n,s);g(d,k,s)})(l)}});f.on("menuShow",function(p){var l=p.data[0];var n=l.element.getElementsByTag("iframe").getItem(0).getFrameDocument();if(!n.getById("cke_ui_color")){var o=j(n);d.push(o);var m=f.getUiColor();if(m){g([o],k,[[h,m]])}}});if(f.config.uiColor){f.setUiColor(f.config.uiColor)}}}})());(function(){CKEDITOR.dialog?a():CKEDITOR.on("dialogPluginReady",a);function a(){CKEDITOR.dialog.on("resize",function(c){var h=c.data,f=h.width,b=h.height,d=h.dialog,g=d.parts.contents;if(h.skin!="kama"){return}g.setStyles({width:f+"px",height:b+"px"});setTimeout(function(){var k=d.parts.dialog.getChild([0,0,0]),j=k.getChild(0);var l=k.getChild(2);l.setStyle("width",(j.$.offsetWidth)+"px");l=k.getChild(7);l.setStyle("width",(j.$.offsetWidth-28)+"px");l=k.getChild(4);l.setStyle("height",(b+j.getChild(0).$.offsetHeight)+"px");l=k.getChild(5);l.setStyle("height",(b+j.getChild(0).$.offsetHeight)+"px")},100)})}})();(function(){var b="a11yhelp",a="a11yHelp";CKEDITOR.plugins.add(b,{availableLangs:{en:1,he:1},init:function(c){var d=this;c.addCommand(a,{exec:function(){var f=c.langCode;f=d.availableLangs[f]?f:"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(d.path+"lang/"+f+".js"),function(){CKEDITOR.tools.extend(c.lang,d.lang[f]);c.openDialog(a)})},modes:{wysiwyg:1,source:1},canUndo:false});CKEDITOR.dialog.add(a,this.path+"dialogs/a11yhelp.js")}})})();CKEDITOR.plugins.add("basicstyles",{requires:["styles","button"],init:function(b){var c=function(g,k,h,f){var j=new CKEDITOR.style(f);b.attachStyleStateChange(j,function(l){b.getCommand(h).setState(l)});b.addCommand(h,new CKEDITOR.styleCommand(j));b.ui.addButton(g,{label:k,command:h})};var a=b.config,d=b.lang;c("Bold",d.bold,"bold",a.coreStyles_bold);c("Italic",d.italic,"italic",a.coreStyles_italic);c("Underline",d.underline,"underline",a.coreStyles_underline);c("Strike",d.strike,"strike",a.coreStyles_strike);c("Subscript",d.subscript,"subscript",a.coreStyles_subscript);c("Superscript",d.superscript,"superscript",a.coreStyles_superscript)}});CKEDITOR.config.coreStyles_bold={element:"strong",overrides:"b"};CKEDITOR.config.coreStyles_italic={element:"em",overrides:"i"};CKEDITOR.config.coreStyles_underline={element:"u"};CKEDITOR.config.coreStyles_strike={element:"strike"};CKEDITOR.config.coreStyles_subscript={element:"sub"};CKEDITOR.config.coreStyles_superscript={element:"sup"};(function(){var l={table:1,tbody:1,ul:1,ol:1,blockquote:1,div:1,tr:1},b={},j={};CKEDITOR.tools.extend(b,l,{tr:1,p:1,div:1,li:1});CKEDITOR.tools.extend(j,b,{td:1});function g(m){c(m);h(m)}function c(n){var o=n.editor,p=n.data.path;var m=o.config.useComputedState,q;m=m===undefined||m;if(!m){q=f(p.lastElement)}q=q||p.block||p.blockLimit;if(!q||q.getName()=="body"){return}var r=m?q.getComputedStyle("direction"):q.getStyle("direction")||q.getAttribute("dir");o.getCommand("bidirtl").setState(r=="rtl"?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF);o.getCommand("bidiltr").setState(r=="ltr"?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function h(m){var n=m.editor,p=n.container.getChild(1),o=m.data.path.block||m.data.path.blockLimit;if(p){if(o&&n.lang.dir!=o.getComputedStyle("direction")){p.addClass("cke_mixed_dir_content")}else{p.removeClass("cke_mixed_dir_content")}}}function f(n){while(n&&!(n.getName() in j||n.is("body"))){var m=n.getParent();if(!m){break}n=m}return n}function d(p,o,r,u){CKEDITOR.dom.element.setMarker(u,p,"bidi_processed",1);var q=p;while((q=q.getParent())&&!q.is("body")){if(q.getCustomData("bidi_processed")){p.removeStyle("direction");p.removeAttribute("dir");return null}}var n=("useComputedState" in r.config)?r.config.useComputedState:1;var s=n?p.getComputedStyle("direction"):p.getStyle("direction")||p.hasAttribute("dir");if(s==o){return null}var m=n?s:p.getComputedStyle("direction");p.removeStyle("direction");if(n){p.removeAttribute("dir");if(o!=p.getComputedStyle("direction")){p.setAttribute("dir",o)}}else{p.setAttribute("dir",o)}if(o!=m){r.fire("dirChanged",{node:p,dir:o})}r.forceNextSelectionCheck();return null}function a(m,p){var n=m.getCommonAncestor(false,true);m.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS);if(m.checkBoundaryOfElement(n,CKEDITOR.START)&&m.checkBoundaryOfElement(n,CKEDITOR.END)){var o;while(n&&n.type==CKEDITOR.NODE_ELEMENT&&(o=n.getParent())&&o.getChildCount()==1&&(!(n.getName() in p)||(o.getName() in p))){n=o}return n.type==CKEDITOR.NODE_ELEMENT&&(n.getName() in p)&&n}}function k(m){return function(y){var A=y.getSelection(),z=y.config.enterMode,o=A.getRanges();if(o&&o.length){var C={};var q=A.createBookmarks();var B=o.createIterator(),x,u=0;while((x=B.getNextRange(1))){var w=x.getEnclosedNode();if(!w||w&&!(w.type==CKEDITOR.NODE_ELEMENT&&w.getName() in b)){w=a(x,l)}if(w&&!w.isReadOnly()){d(w,m,y,C)}var v,s;var n=new CKEDITOR.dom.walker(x);var p=q[u].startNode,r=q[u++].endNode;n.evaluator=function(D){return !!(D.type==CKEDITOR.NODE_ELEMENT&&D.getName() in l&&!(D.getName()==(z==CKEDITOR.ENTER_P)?"p":"div"&&D.getParent().type==CKEDITOR.NODE_ELEMENT&&D.getParent().getName()=="blockquote")&&D.getPosition(p)&CKEDITOR.POSITION_FOLLOWING&&((D.getPosition(r)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_CONTAINS)==CKEDITOR.POSITION_PRECEDING))};while((s=n.next())){d(s,m,y,C)}v=x.createIterator();v.enlargeBr=z!=CKEDITOR.ENTER_BR;while((s=v.getNextParagraph(z==CKEDITOR.ENTER_P?"p":"div"))){!s.isReadOnly()&&d(s,m,y,C)}}CKEDITOR.dom.element.clearAllMarkers(C);y.forceNextSelectionCheck();A.selectBookmarks(q);y.focus()}}}CKEDITOR.plugins.add("bidi",{requires:["styles","button"],init:function(m){var n=function(p,s,r,q){m.addCommand(r,new CKEDITOR.command(m,{exec:q}));m.ui.addButton(p,{label:s,command:r})};var o=m.lang.bidi;n("BidiLtr",o.ltr,"bidiltr",k("ltr"));n("BidiRtl",o.rtl,"bidirtl",k("rtl"));m.on("selectionChange",g)}})})();(function(){function a(f,h){var g=h.block||h.blockLimit;if(!g||g.getName()=="body"){return CKEDITOR.TRISTATE_OFF}if(g.getAscendant("blockquote",true)){return CKEDITOR.TRISTATE_ON}return CKEDITOR.TRISTATE_OFF}function d(f){var g=f.editor,h=g.getCommand("blockquote");h.state=a(g,f.data.path);h.fire("state")}function c(h){for(var f=0,g=h.getChildCount(),j;f<g&&(j=h.getChild(f));f++){if(j.type==CKEDITOR.NODE_ELEMENT&&j.isBlockBoundary()){return false}}return true}var b={exec:function(l){var n=l.getCommand("blockquote").state,K=l.getSelection(),x=K&&K.getRanges(true)[0];if(!x){return}var o=K.createBookmarks();if(CKEDITOR.env.ie){var j=o[0].startNode,D=o[0].endNode,m;if(j&&j.getParent().getName()=="blockquote"){m=j;while((m=m.getNext())){if(m.type==CKEDITOR.NODE_ELEMENT&&m.isBlockBoundary()){j.move(m,true);break}}}if(D&&D.getParent().getName()=="blockquote"){m=D;while((m=m.getPrevious())){if(m.type==CKEDITOR.NODE_ELEMENT&&m.isBlockBoundary()){D.move(m);break}}}}var A=x.createIterator(),s;if(n==CKEDITOR.TRISTATE_OFF){var u=[];while((s=A.getNextParagraph())){u.push(s)}if(u.length<1){var h=l.document.createElement(l.config.enterMode==CKEDITOR.ENTER_P?"p":"div"),k=o.shift();x.insertNode(h);h.append(new CKEDITOR.dom.text("\ufeff",l.document));x.moveToBookmark(k);x.selectNodeContents(h);x.collapse(true);k=x.createBookmark();u.push(h);o.unshift(k)}var v=u[0].getParent(),H=[];for(var E=0;E<u.length;E++){s=u[E];v=v.getCommonAncestor(s.getParent())}var F={table:1,tbody:1,tr:1,ol:1,ul:1};while(F[v.getName()]){v=v.getParent()}var G=null;while(u.length>0){s=u.shift();while(!s.getParent().equals(v)){s=s.getParent()}if(!s.equals(G)){H.push(s)}G=s}while(H.length>0){s=H.shift();if(s.getName()=="blockquote"){var g=new CKEDITOR.dom.documentFragment(l.document);while(s.getFirst()){g.append(s.getFirst().remove());u.push(g.getLast())}g.replace(s)}else{u.push(s)}}var B=l.document.createElement("blockquote");B.insertBefore(u[0]);while(u.length>0){s=u.shift();B.append(s)}}else{if(n==CKEDITOR.TRISTATE_ON){var I=[],w={};while((s=A.getNextParagraph())){var J=null,y=null;while(s.getParent()){if(s.getParent().getName()=="blockquote"){J=s.getParent();y=s;break}s=s.getParent()}if(J&&y&&!y.getCustomData("blockquote_moveout")){I.push(y);CKEDITOR.dom.element.setMarker(w,y,"blockquote_moveout",true)}}CKEDITOR.dom.element.clearAllMarkers(w);var f=[],r=[];w={};while(I.length>0){var C=I.shift();B=C.getParent();if(!C.getPrevious()){C.remove().insertBefore(B)}else{if(!C.getNext()){C.remove().insertAfter(B)}else{C.breakParent(C.getParent());r.push(C.getNext())}}if(!B.getCustomData("blockquote_processed")){r.push(B);CKEDITOR.dom.element.setMarker(w,B,"blockquote_processed",true)}f.push(C)}CKEDITOR.dom.element.clearAllMarkers(w);for(E=r.length-1;E>=0;E--){B=r[E];if(c(B)){B.remove()}}if(l.config.enterMode==CKEDITOR.ENTER_BR){var q=true;while(f.length){C=f.shift();if(C.getName()=="div"){g=new CKEDITOR.dom.documentFragment(l.document);var z=q&&C.getPrevious()&&!(C.getPrevious().type==CKEDITOR.NODE_ELEMENT&&C.getPrevious().isBlockBoundary());if(z){g.append(l.document.createElement("br"))}var p=C.getNext()&&!(C.getNext().type==CKEDITOR.NODE_ELEMENT&&C.getNext().isBlockBoundary());while(C.getFirst()){C.getFirst().remove().appendTo(g)}if(p){g.append(l.document.createElement("br"))}g.replace(C);q=false}}}}}K.selectBookmarks(o);l.focus()}};CKEDITOR.plugins.add("blockquote",{init:function(f){f.addCommand("blockquote",b);f.ui.addButton("Blockquote",{label:f.lang.blockquote,command:"blockquote"});f.on("selectionChange",d)},requires:["domiterator"]})})();CKEDITOR.plugins.add("button",{beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}});CKEDITOR.UI_BUTTON=1;CKEDITOR.ui.button=function(a){CKEDITOR.tools.extend(this,a,{title:a.label,className:a.className||(a.command&&"cke_button_"+a.command)||"",click:a.click||function(b){b.execCommand(a.command)}});this._={}};CKEDITOR.ui.button.handler={create:function(a){return new CKEDITOR.ui.button(a)}};CKEDITOR.ui.button._={instances:[],keydown:function(b,c){var a=CKEDITOR.ui.button._.instances[b];if(a.onkey){c=new CKEDITOR.dom.event(c);return(a.onkey(a,c.getKeystroke())!==false)}},focus:function(b,c){var a=CKEDITOR.ui.button._.instances[b],d;if(a.onfocus){d=(a.onfocus(a,new CKEDITOR.dom.event(c))!==false)}if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){c.preventBubble()}return d}};(function(){var b=CKEDITOR.tools.addFunction(CKEDITOR.ui.button._.keydown,CKEDITOR.ui.button._),a=CKEDITOR.tools.addFunction(CKEDITOR.ui.button._.focus,CKEDITOR.ui.button._);CKEDITOR.ui.button.prototype={canGroup:true,render:function(k,f){var l=CKEDITOR.env,d=this._.id=CKEDITOR.tools.getNextId(),g="",h=this.command,c,m;this._.editor=k;var o={id:d,button:this,editor:k,focus:function(){var p=CKEDITOR.document.getById(d);p.focus()},execute:function(){this.editor.fire("buttonClick",{button:this.button});this.button.click(k)}};o.clickFn=c=CKEDITOR.tools.addFunction(o.execute,o);o.index=m=CKEDITOR.ui.button._.instances.push(o)-1;if(this.modes){var n={};k.on("beforeModeUnload",function(){n[k.mode]=this._.state},this);k.on("mode",function(){var p=k.mode;this.setState(this.modes[p]?n[p]!=undefined?n[p]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)},this)}else{if(h){h=k.getCommand(h);if(h){h.on("state",function(){if(!RTE.loaded){this.setState(CKEDITOR.TRISTATE_DISABLED);return}this.setState(h.state)},this);g+="cke_"+(h.state==CKEDITOR.TRISTATE_ON?"on":h.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off")}}}if(!h){g+="cke_off"}if(this.className){g+=" "+this.className}f.push('<span class="cke_button '+g+(this.wrapperClassName?(" "+this.wrapperClassName):"")+'">','<a id="',d,'" class="',g,'"',l.gecko&&l.version>=10900&&!l.hc?"":'" href="javascript:void(\''+(this.title||"").replace("'","")+"')\"",' title="',this.title,'" tabindex="-1" hidefocus="true" role="button" aria-labelledby="'+d+'_label"'+(this.hasArrow?' aria-haspopup="true"':""));if(l.opera||(l.gecko&&l.mac)){f.push(' onkeypress="return false;"')}if(l.gecko){f.push(' onblur="this.style.cssText = this.style.cssText;"')}f.push(' onkeydown="return CKEDITOR.tools.callFunction(',b,", ",m,', event);" onfocus="return CKEDITOR.tools.callFunction(',a,", ",m,', event);" onclick="CKEDITOR.tools.callFunction(',c,', this); return false;"><span class="cke_icon"');if(this.icon){var j=(this.iconOffset||0)*-16;f.push(' style="background-image:url(',CKEDITOR.getUrl(this.icon),");background-position:0 "+j+'px;"')}f.push('>&nbsp;</span><span id="',d,'_label" class="cke_label">',this.label,"</span>");if(this.hasArrow){f.push('<span class="cke_buttonarrow">'+(CKEDITOR.env.hc?"&#9660;":"&nbsp;")+"</span>")}f.push("</a>","</span>");if(this.onRender){this.onRender()}return o},setState:function(d){if(this._.state==d){return false}this._.state=d;var c=CKEDITOR.document.getById(this._.id);if(c){c.setState(d);d==CKEDITOR.TRISTATE_DISABLED?c.setAttribute("aria-disabled",true):c.removeAttribute("aria-disabled");d==CKEDITOR.TRISTATE_ON?c.setAttribute("aria-pressed",true):c.removeAttribute("aria-pressed");return true}else{return false}}}})();CKEDITOR.ui.prototype.addButton=function(a,b){this.add(a,CKEDITOR.UI_BUTTON,b)};CKEDITOR.on("reset",function(){CKEDITOR.ui.button._.instances=[]});(function(){var a=function(l,n){var m=l.document,j=m.getBody();var k=0;var o=function(){k=1};j.on(n,o);(CKEDITOR.env.version>7?m.$:m.$.selection.createRange())["execCommand"](n);j.removeListener(n,o);return k};var d=CKEDITOR.env.ie?function(k,j){return a(k,j)}:function(k,j){try{return k.document.$.execCommand(j,false,null)}catch(l){return false}};var g=function(j){this.type=j;this.canUndo=(this.type=="cut")};g.prototype={exec:function(j,k){this.type=="cut"&&f(j);var l=d(j,this.type);if(!l){alert(j.lang.clipboard[this.type+"Error"])}return l}};var h={canUndo:false,exec:CKEDITOR.env.ie?function(j){j.focus();if(!j.document.getBody().fire("beforepaste")&&!a(j,"paste")){j.fire("pasteDialog");return false}}:function(j){try{if(!j.document.getBody().fire("beforepaste")&&!j.document.$.execCommand("Paste",false,null)){throw 0}}catch(k){setTimeout(function(){j.fire("pasteDialog")},0);return false}}};var c=function(l){if(this.mode!="wysiwyg"){return}switch(l.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:var j=this.document.getBody();if(!CKEDITOR.env.ie&&j.fire("beforepaste")){l.cancel()}else{if(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){j.fire("paste")}}return;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:var k=this;this.fire("saveSnapshot");setTimeout(function(){k.fire("saveSnapshot")},0)}};function b(r,o,s){var p=this.document;if(p.getById("cke_pastebin")){return}if(o=="text"&&r.data&&r.data.$.clipboardData){var q=r.data.$.clipboardData.getData("text/plain");if(q){r.data.preventDefault();s(q);return}}var k=this.getSelection(),n=new CKEDITOR.dom.range(p);var l=new CKEDITOR.dom.element(o=="text"?"textarea":CKEDITOR.env.webkit?"body":"div",p);l.setAttribute("id","cke_pastebin");CKEDITOR.env.webkit&&l.append(p.createText("\xa0"));p.getBody().append(l);l.setStyles({position:"absolute",top:k.getStartElement().getDocumentPosition().y+"px",width:"1px",height:"1px",overflow:"hidden"});l.setStyle(this.config.contentsLangDirection=="ltr"?"left":"right","-1000px");var m=k.createBookmarks();if(o=="text"){if(CKEDITOR.env.ie){var j=p.getBody().$.createTextRange();j.moveToElementText(l.$);j.execCommand("Paste");r.data.preventDefault()}else{p.$.designMode="off";l.$.focus()}}else{n.setStartAt(l,CKEDITOR.POSITION_AFTER_START);n.setEndAt(l,CKEDITOR.POSITION_BEFORE_END);n.select(true)}window.setTimeout(function(){o=="text"&&!CKEDITOR.env.ie&&(p.$.designMode="on");l.remove();var u;l=(CKEDITOR.env.webkit&&(u=l.getFirst())&&(u.is&&u.hasClass("Apple-style-span"))?u:l);k.selectBookmarks(m);s(l["get"+(o=="text"?"Value":"Html")]())},0)}function f(k){if(!CKEDITOR.env.ie||CKEDITOR.env.quirks){return}var l=k.getSelection();var n;if((l.getType()==CKEDITOR.SELECTION_ELEMENT)&&(n=l.getSelectedElement())){var j=l.getRanges()[0];var m=k.document.createText("");m.insertBefore(n);j.setStartBefore(m);j.setEndAfter(n);l.selectRanges([j]);setTimeout(function(){if(n.getParent()){m.remove();l.selectElement(n)}},0)}}CKEDITOR.plugins.add("clipboard",{requires:["dialog","htmldataprocessor"],init:function(l){l.on("paste",function(o){var p=o.data;if(p.html){l.insertHtml(p.html)}else{if(p.text){l.insertText(p.text)}}},null,null,1000);l.on("pasteDialog",function(o){setTimeout(function(){l.openDialog("paste")},0)});function m(o,q,s,p){var r=l.lang[q];l.addCommand(q,s);l.ui.addButton(o,{label:r,command:q});if(l.addMenuItems){l.addMenuItem(q,{label:r,command:q,group:"clipboard",order:p})}}m("Cut","cut",new g("cut"),1);m("Copy","copy",new g("copy"),4);m("Paste","paste",h,8);CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js"));l.on("key",c,l);var n=l.config.forcePasteAsPlainText?"text":"html";if(l.contextMenu){var k;function j(p){CKEDITOR.env.ie&&(k=1);var o=l.document.$.queryCommandEnabled(p)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;k=0;return o}l.contextMenu.addListener(function(o,p){var q=p.getCommonAncestor().isReadOnly();return{cut:!q&&j("Cut"),copy:j("Copy"),paste:!q&&(CKEDITOR.env.webkit?CKEDITOR.TRISTATE_OFF:j("Paste"))}})}}})})();CKEDITOR.plugins.add("colorbutton",{requires:["panelbutton","floatpanel","styles"],init:function(d){var b=d.config,h=d.lang.colorButton;var g;if(!CKEDITOR.env.hc){c("TextColor","fore",h.textColorTitle);c("BGColor","back",h.bgColorTitle)}function c(k,l,m){var j=CKEDITOR.tools.getNextId()+"_colorBox";d.ui.add(k,CKEDITOR.UI_PANELBUTTON,{label:m,title:m,className:"cke_button_"+k.toLowerCase(),modes:{wysiwyg:1},panel:{css:d.skin.editor.css,attributes:{role:"listbox","aria-label":h.panelTitle}},onBlock:function(n,q){q.autoSize=true;q.element.addClass("cke_colorblock");q.element.setHtml(a(n,l,j));q.element.getDocument().getBody().setStyle("overflow","hidden");CKEDITOR.ui.fire("ready",this);var o=q.keys;var p=d.lang.dir=="rtl";o[p?37:39]="next";o[40]="next";o[9]="next";o[p?39:37]="prev";o[38]="prev";o[CKEDITOR.SHIFT+9]="prev";o[32]="click"},onOpen:function(){var o=d.getSelection(),q=o&&o.getStartElement(),p=new CKEDITOR.dom.elementPath(q),n;q=p.block||p.blockLimit;do{n=q&&q.getComputedStyle(l=="back"?"background-color":"color")||"transparent"}while(l=="back"&&n=="transparent"&&(q=q.getParent()));if(!n||n=="transparent"){n="#ffffff"}this._.panel._.iframe.getFrameDocument().getById(j).setStyle("background-color",n)}})}function a(l,r,n){var o=[],m=b.colorButton_colors.split(","),s=m.length+(b.colorButton_enableMore?2:1);var k=CKEDITOR.tools.addFunction(function(x,z){if(x=="?"){var A=arguments.callee;function y(B){this.removeListener("ok",y);this.removeListener("cancel",y);B.name=="ok"&&A(this.getContentElement("picker","selectedColor").getValue(),z)}d.openDialog("colordialog",function(){this.on("ok",y);this.on("cancel",y)});return}d.focus();l.hide();d.fire("saveSnapshot");new CKEDITOR.style(b["colorButton_"+z+"Style"],{color:"inherit"}).remove(d.document);if(x){var w=b["colorButton_"+z+"Style"];w.childRule=z=="back"?function(B){return f(B)}:function(B){return B.getName()!="a"||f(B)};new CKEDITOR.style(w,{color:x}).apply(d.document)}d.fire("saveSnapshot")});o.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',h.auto,'" onclick="CKEDITOR.tools.callFunction(',k,",null,'",r,"');return false;\" href=\"javascript:void('",h.auto,'\')" role="option" aria-posinset="1" aria-setsize="',s,'"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td><span class="cke_colorbox" id="',n,'"></span></td><td colspan=7 align=center>',h.auto,'</td></tr></table></a><table role="presentation" cellspacing=0 cellpadding=0 width="100%">');for(var q=0;q<m.length;q++){if((q%8)===0){o.push("</tr><tr>")}var p=m[q].split("/"),u=p[0],v=p[1]||u;if(!p[1]){u="#"+u.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3")}var j=d.lang.colors[v]||v;o.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',j,'" onclick="CKEDITOR.tools.callFunction(',k,",'",u,"','",r,"'); return false;\" href=\"javascript:void('",j,'\')" role="option" aria-posinset="',(q+2),'" aria-setsize="',s,'"><span class="cke_colorbox" style="background-color:#',v,'"></span></a></td>')}if(b.colorButton_enableMore===undefined||b.colorButton_enableMore){o.push('</tr><tr><td colspan=8 align=center><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',h.more,'" onclick="CKEDITOR.tools.callFunction(',k,",'?','",r,"');return false;\" href=\"javascript:void('",h.more,"')\"",' role="option" aria-posinset="',s,'" aria-setsize="',s,'">',h.more,"</a></td>")}o.push("</tr></table>");return o.join("")}function f(j){return(j.getAttribute("contentEditable")=="false")||j.getAttribute("data-cke-nostyle")}}});CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF";CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]};CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};(function(){CKEDITOR.plugins.colordialog={init:function(a){a.addCommand("colordialog",new CKEDITOR.dialogCommand("colordialog"));CKEDITOR.dialog.add("colordialog",this.path+"dialogs/colordialog.js")}};CKEDITOR.plugins.add("colordialog",CKEDITOR.plugins.colordialog)})();CKEDITOR.plugins.add("contextmenu",{requires:["menu"],onLoad:function(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(a){this.base.call(this,a,{panel:{className:a.skinClass+" cke_contextmenu",attributes:{"aria-label":a.lang.contextmenu.options}}})},proto:{addTarget:function(d,f){if(CKEDITOR.env.opera&&!("oncontextmenu" in document.body)){var a;d.on("mousedown",function(h){h=h.data;if(h.$.button!=2){if(h.getKeystroke()==CKEDITOR.CTRL+1){d.fire("contextmenu",h)}return}if(f&&(CKEDITOR.env.mac?h.$.metaKey:h.$.ctrlKey)){return}var k=h.getTarget();if(!a){var j=k.getDocument();a=j.createElement("input");a.$.type="button";j.getBody().append(a)}a.setAttribute("style","position:absolute;top:"+(h.$.clientY-2)+"px;left:"+(h.$.clientX-2)+"px;width:5px;height:5px;opacity:0.01")});d.on("mouseup",function(h){if(a){a.remove();a=undefined;d.fire("contextmenu",h.data)}})}d.on("contextmenu",function(l){var j=l.data;if(f&&(CKEDITOR.env.webkit?b:(CKEDITOR.env.mac?j.$.metaKey:j.$.ctrlKey))){return}j.preventDefault();var k=j.getTarget().getDocument().getDocumentElement(),h=j.$.clientX,m=j.$.clientY;CKEDITOR.tools.setTimeout(function(){this.open(k,null,h,m)},0,this)},this);if(CKEDITOR.env.opera){d.on("keypress",function(h){var j=h.data;if(j.$.keyCode===0){j.preventDefault()}})}if(CKEDITOR.env.webkit){var b,c=function(h){b=CKEDITOR.env.mac?h.data.$.metaKey:h.data.$.ctrlKey},g=function(){b=0};d.on("keydown",c);d.on("keyup",g);d.on("contextmenu",g)}},open:function(c,b,a,d){this.editor.fire("contextMenuOnOpen",{menu:this});this.editor.focus();c=c||CKEDITOR.document.getDocumentElement();this.show(c,b,a,d)}}})},beforeInit:function(a){a.contextMenu=new CKEDITOR.plugins.contextMenu(a);a.addCommand("contextMenu",{exec:function(){a.contextMenu.open(a.document.getBody())}});var b=a.contextMenu._;b.onClickOriginal=b.onClick;b.onClick=function(c){a.fire("contextMenuOnClick",{menu:a.contextMenu,item:c});b.onClickOriginal(c)}}});(function(){function b(d){var c=this.att;var f=d&&d.hasAttribute(c)&&d.getAttribute(c)||"";if(f!==undefined){this.setValue(f)}}function a(){var g;for(var f=0;f<arguments.length;f++){if(arguments[f] instanceof CKEDITOR.dom.element){g=arguments[f];break}}if(g){var d=this.att,h=this.getValue();if(d=="dir"){var c=g.getAttribute(d);if(c!=h&&g.getParent()){this._.dialog._.editor.fire("dirChanged",{node:g,dir:h||g.getDirection(1)})}}if(h){g.setAttribute(d,h)}else{g.removeAttribute(d,h)}}}CKEDITOR.plugins.add("dialogadvtab",{createAdvancedTab:function(d,g){if(!g){g={id:1,dir:1,classes:1,styles:1}}var h=d.lang.common;var c={id:"advanced",label:h.advancedTab,title:h.advancedTab,elements:[{type:"vbox",padding:1,children:[]}]};var f=[];if(g.id||g.dir){if(g.id){f.push({id:"advId",att:"id",type:"text",label:h.id,setup:b,commit:a})}if(g.dir){f.push({id:"advLangDir",att:"dir",type:"select",label:h.langDir,"default":"",style:"width:100%",items:[[h.notSet,""],[h.langDirLTR,"ltr"],[h.langDirRTL,"rtl"]],setup:b,commit:a})}c.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(f)})}if(g.styles||g.classes){f=[];if(g.styles){f.push({id:"advStyles",att:"style",type:"text",label:h.styles,"default":"",getStyle:function(l,j){var k=this.getValue().match(new RegExp(l+"\\s*:s*([^;]*)","i"));return k?k[1]:j},updateStyle:function(j,l){var k=this.getValue();if(k){k=k.replace(new RegExp("\\s*"+j+"s*:[^;]*(?:$|;s*)","i"),"").replace(/^[;\s]+/,"").replace(/\s+$/,"")}if(l){k&&!(/;\s*$/).test(k)&&(k+="; ");k+=j+": "+l}this.setValue(k,1)},setup:b,commit:a})}if(g.classes){f.push({type:"hbox",widths:["45%","55%"],children:[{id:"advCSSClasses",att:"class",type:"text",label:h.cssClasses,"default":"",setup:b,commit:a}]})}c.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(f)})}return c}})})();(function(){CKEDITOR.plugins.add("div",{requires:["editingblock","domiterator","styles"],init:function(a){var b=a.lang.div;a.addCommand("creatediv",new CKEDITOR.dialogCommand("creatediv"));a.addCommand("editdiv",new CKEDITOR.dialogCommand("editdiv"));a.addCommand("removediv",{exec:function(k){var l=k.getSelection(),f=l&&l.getRanges(),j,g=l.createBookmarks(),c,d=[];function m(o){var p=new CKEDITOR.dom.elementPath(o),n=p.blockLimit,q=n.is("div")&&n;if(q&&!q.data("cke-div-added")){d.push(q);q.data("cke-div-added")}}for(var h=0;h<f.length;h++){j=f[h];if(j.collapsed){m(l.getStartElement())}else{c=new CKEDITOR.dom.walker(j);c.evaluator=m;c.lastForward()}}for(h=0;h<d.length;h++){d[h].remove(true)}l.selectBookmarks(g)}});a.ui.addButton("CreateDiv",{label:b.toolbar,command:"creatediv"});if(a.addMenuItems){a.addMenuItems({editdiv:{label:b.edit,command:"editdiv",group:"div",order:1},removediv:{label:b.remove,command:"removediv",group:"div",order:5}});if(a.contextMenu){a.contextMenu.addListener(function(d,g){if(!d||d.isReadOnly()){return null}var f=new CKEDITOR.dom.elementPath(d),c=f.blockLimit;if(c&&c.getAscendant("div",true)){return{editdiv:CKEDITOR.TRISTATE_OFF,removediv:CKEDITOR.TRISTATE_OFF}}return null})}}CKEDITOR.dialog.add("creatediv",this.path+"dialogs/div.js");CKEDITOR.dialog.add("editdiv",this.path+"dialogs/div.js")}})})();(function(){CKEDITOR.plugins.add("enterkey",{requires:["keystrokes","indent"],init:function(j){var k=j.specialKeys;k[13]=g;k[CKEDITOR.SHIFT+13]=d}});CKEDITOR.plugins.enterkey={enterBlock:function(p,v,w,r){w=w||f(p);var G=w.document;if(w.checkStartOfBlock()&&w.checkEndOfBlock()){var x=new CKEDITOR.dom.elementPath(w.startContainer),s=x.block;if(s&&(s.is("li")||s.getParent().is("li"))){p.execCommand("outdent");return}}var E=(v==CKEDITOR.ENTER_DIV?"div":"p");var B=w.splitBlock(E);if(!B){return}var q=B.previousBlock,u=B.nextBlock;var m=B.wasStartOfBlock,y=B.wasEndOfBlock;var z;if(u){z=u.getParent();if(z.is("li")){u.breakParent(z);u.move(u.getNext(),1)}}else{if(q&&(z=q.getParent())&&z.is("li")){q.breakParent(z);w.moveToElementEditStart(q.getNext());q.move(q.getPrevious())}}if(!m&&!y){if(u.is("li")&&(z=u.getFirst(CKEDITOR.dom.walker.invisible(true)))&&z.is&&z.is("ul","ol")){(CKEDITOR.env.ie?G.createText("\xa0"):G.createElement("br")).insertBefore(z)}if(u){if(u.is("p")){var k=u.getFirst();if(k.$.nodeType!=CKEDITOR.NODE_COMMENT){u.setAttribute("data-rte-empty-lines-before",1)}u.setAttribute("data-rte-fromparser",1)}w.moveToElementEditStart(u)}}else{var n,o;if(q){if(q.is("li")||!b.test(q.getName())){n=q.clone()}if(q.isReadOnly()){n=null}}else{if(u){n=u.clone();if(u.isReadOnly()){n=null}}}if(!n){n=G.createElement(E);if(q&&(o=q.getDirection())){n.setAttribute("dir",o)}}else{if(r&&!n.is("li")){n.renameNode(E)}}if(n.is("dl")){n=new CKEDITOR.dom.element("p")}var j=B.elementPath;if(j){var F=-1;for(var A=j.elements.length-1;A>=0;A--){if(j.elements[A].$.contentEditable=="false"){F=A;break}}$().log({elementPath:j,elementPathBlock:j.block,elementPathBlockLimit:j.blockLimit,notEditableIndex:F},"RTE-enterkey");for(var A=0,C=j.elements.length;A<C;A++){var l=j.elements[A];if(l.equals(j.block)||l.equals(j.blockLimit)){break}if(A<=F){continue}if(CKEDITOR.dtd.$removeEmpty[l.getName()]){l=l.clone();n.moveChildren(l);n.append(l)}}}if(!CKEDITOR.env.ie){n.appendBogus()}n.setAttribute("data-rte-new-node",true);w.insertNode(n);if(CKEDITOR.env.ie&&m&&(!y||!q.getChildCount())){w.moveToElementEditStart(y?q:n);w.select()}w.moveToElementEditStart(m&&!y?u:n)}if(!CKEDITOR.env.ie){if(u){var D=G.createElement("span");D.setHtml("&nbsp;");w.insertNode(D);D.scrollIntoView();w.deleteContents()}else{n.scrollIntoView()}}w.select()},enterBr:function(r,q,o,m){o=o||f(r);if(!o){return}if(!o){return}var x=o.document;var p=(q==CKEDITOR.ENTER_DIV?"div":"p");var j=o.checkEndOfBlock();var y=new CKEDITOR.dom.elementPath(r.getSelection().getStartElement());var u=y.block,n=u&&y.block.getName();var k=false;if(!m&&n=="li"){h(r,q,o,m);return}if(!m&&j&&b.test(n)){var s,w;if((w=u.getDirection())){s=x.createElement("div");s.setAttribute("dir",w);s.insertAfter(u);o.setStart(s,0)}else{x.createElement("br").insertAfter(u);if(CKEDITOR.env.gecko){x.createText("").insertAfter(u)}o.setStartAt(u.getNext(),CKEDITOR.env.ie?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_START)}}else{var v;k=(n=="pre");if(k&&!CKEDITOR.env.gecko){v=x.createText(CKEDITOR.env.ie?"\r":"\n")}else{v=x.createElement("br");v.setAttribute("data-rte-shift-enter",true);if(b.test(n)){return}}o.deleteContents();o.insertNode(v);if(!CKEDITOR.env.ie){x.createText("\ufeff").insertAfter(v)}if(j&&!CKEDITOR.env.ie){v.getParent().appendBogus()}if(!CKEDITOR.env.ie){v.getNext().$.nodeValue=""}if(CKEDITOR.env.ie){o.setStartAt(v,CKEDITOR.POSITION_AFTER_END)}else{o.setStartAt(v.getNext(),CKEDITOR.POSITION_AFTER_START)}if(!CKEDITOR.env.ie){var l=null;if(!CKEDITOR.env.gecko){l=x.createElement("span");l.setHtml("&nbsp;")}else{l=x.createElement("br")}l.insertBefore(v.getNext());l.scrollIntoView();l.remove()}}o.collapse(true);o.select(k)}};var c=CKEDITOR.plugins.enterkey,a=c.enterBr,h=c.enterBlock,b=/^h[1-6]$/;function d(j){if(j.mode!="wysiwyg"){return false}if(j.getSelection().getStartElement().hasAscendant("pre",true)){setTimeout(function(){h(j,j.config.enterMode,null,true)},0);return true}else{return g(j,j.config.shiftEnterMode,1)}}function g(j,k,l){l=j.config.forceEnterMode||l;if(j.mode!="wysiwyg"){return false}if(!k){k=j.config.enterMode}setTimeout(function(){j.fire("saveSnapshot");if(k==CKEDITOR.ENTER_BR||j.getSelection().getStartElement().hasAscendant("pre",1)){a(j,k,null,l)}else{h(j,k,null,l)}},0);return true}function f(o){var k=o.getSelection().getRanges(true);if(k.length==0){k=o.getSelection().getRanges(false);var m=k[0];var l=new CKEDITOR.dom.elementPath(m.startContainer),p=new CKEDITOR.dom.elementPath(m.endContainer);if(!p.isContentEditable()){var j=m.endContainer.isReadOnly();if(j.is("p","div")){m.setEndAt(j,CKEDITOR.POSITION_BEFORE_END)}else{m.setEndAfter(j)}m.collapse(false)}else{m.collapse(false)}k=new CKEDITOR.dom.rangeList([m]);o.getSelection().selectRanges(k);o.getSelection().reset();if(!CKEDITOR.env.ie){k=o.getSelection().getRanges(false)}}if(k.length==0){k=o.getSelection().getRanges(false);var m=k[0];var l=new CKEDITOR.dom.elementPath(m.startContainer),p=new CKEDITOR.dom.elementPath(m.endContainer);if(!l.isContentEditable()||!p.isContentEditable()){var j=m.endContainer.isReadOnly();if(j.is("p","div")){m.setEndAt(j,CKEDITOR.POSITION_BEFORE_END)}else{m.setEndAfter(j)}m.collapse(false)}o.getSelection().selectRanges(new CKEDITOR.dom.rangeList([m]));k=o.getSelection().getRanges(false)}for(var n=k.length-1;n>0;n--){k[n].deleteContents()}return k[0]}})();(function(){var a="nbsp,gt,lt,quot";var d="iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro";var c="Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml";var f="Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv";function b(l,m){var p={},o=[];var k={nbsp:"\u00A0",shy:"\u00AD",gt:"\u003E",lt:"\u003C"};l=l.replace(/\b(nbsp|shy|gt|lt|amp)(?:,|$)/g,function(s,r){var u=m?"&"+r+";":k[r],q=m?k[r]:"&"+r+";";p[u]=q;o.push(u);return""});if(!m){l=l.split(",");var g=document.createElement("div"),n;g.innerHTML="&"+l.join(";&")+";";n=g.innerHTML;g=null;for(var j=0;j<n.length;j++){var h=n.charAt(j);p[h]="&"+l[j]+";";o.push(h)}}p.regex=o.join(m?"|":"");return p}CKEDITOR.plugins.add("entities",{afterInit:function(n){var l=n.config;var q=n.dataProcessor,h=q&&q.htmlFilter;if(h){var o=a;if(l.entities){o+=","+d;if(l.entities_latin){o+=","+c}if(l.entities_greek){o+=","+f}if(l.entities_additional){o+=","+l.entities_additional}}var j=b(o);var p="["+j.regex+"]";delete j.regex;if(l.entities&&l.entities_processNumerical){p="[^ -~]|"+p}p=new RegExp(p,"g");function r(s){return l.entities_processNumerical=="force"||!j[s]?"&#"+s.charCodeAt(0)+";":j[s]}var m=b([a,"shy"].join(","),true),k=new RegExp(m.regex,"g");function g(s){return m[s]}h.addRules({text:function(s){return s.replace(k,g).replace(p,r)}})}}})})();CKEDITOR.config.entities=true;CKEDITOR.config.entities_latin=true;CKEDITOR.config.entities_greek=true;CKEDITOR.config.entities_additional="#39";CKEDITOR.plugins.add("find",{init:function(b){var a=CKEDITOR.plugins.find;b.ui.addButton("Find",{label:b.lang.findAndReplace.find,command:"find"});var d=b.addCommand("find",new CKEDITOR.dialogCommand("find"));d.canUndo=false;b.ui.addButton("Replace",{label:b.lang.findAndReplace.replace,command:"replace"});var c=b.addCommand("replace",new CKEDITOR.dialogCommand("replace"));c.canUndo=false;CKEDITOR.dialog.add("find",this.path+"dialogs/find.js");CKEDITOR.dialog.add("replace",this.path+"dialogs/find.js")},requires:["styles"]});CKEDITOR.config.find_highlight={element:"span",styles:{"background-color":"#004",color:"#fff"}};(function(){function a(j,r,p,c,h,m,k){var d=j.config;var n=h.split(";"),o=[];var q={};for(var g=0;g<n.length;g++){var f=n[g];if(f){f=f.split("/");var l={},b=n[g]=f[0];l[p]=o[g]=f[1]||b;q[b]=new CKEDITOR.style(k,l);q[b]._.definition.name=b}else{n.splice(g--,1)}}j.ui.addRichCombo(r,{label:c.label,title:c.panelTitle,className:"cke_"+(p=="size"?"fontSize":"font"),panel:{css:j.skin.editor.css.concat(d.contentsCss),multiSelect:false,attributes:{"aria-label":c.panelTitle}},init:function(){this.startGroup(c.panelTitle);for(var u=0;u<n.length;u++){var s=n[u];this.add(s,q[s].buildPreview(),s)}},onClick:function(u){j.focus();j.fire("saveSnapshot");var s=q[u];if(this.getValue()==u){s.remove(j.document)}else{s.apply(j.document)}j.fire("saveSnapshot")},onRender:function(){j.on("selectionChange",function(x){var w=this.getValue();var v=x.data.path,z=v.elements;for(var u=0,s;u<z.length;u++){s=z[u];for(var y in q){if(q[y].checkElementRemovable(s,true)){if(y!=w){this.setValue(y)}return}}}this.setValue("",m)},this)}})}CKEDITOR.plugins.add("font",{requires:["richcombo","styles"],init:function(c){var b=c.config;a(c,"Font","family",c.lang.font,b.font_names,b.font_defaultLabel,b.font_style);a(c,"FontSize","size",c.lang.fontSize,b.fontSize_sizes,b.fontSize_defaultLabel,b.fontSize_style)}})})();CKEDITOR.config.font_names="Arial/Arial, Helvetica, sans-serif;Comic Sans MS/Comic Sans MS, cursive;Courier New/Courier New, Courier, monospace;Georgia/Georgia, serif;Lucida Sans Unicode/Lucida Sans Unicode, Lucida Grande, sans-serif;Tahoma/Tahoma, Geneva, sans-serif;Times New Roman/Times New Roman, Times, serif;Trebuchet MS/Trebuchet MS, Helvetica, sans-serif;Verdana/Verdana, Geneva, sans-serif";CKEDITOR.config.font_defaultLabel="";CKEDITOR.config.font_style={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]};CKEDITOR.config.fontSize_sizes="8/8px;9/9px;10/10px;11/11px;12/12px;14/14px;16/16px;18/18px;20/20px;22/22px;24/24px;26/26px;28/28px;36/36px;48/48px;72/72px";CKEDITOR.config.fontSize_defaultLabel="";CKEDITOR.config.fontSize_style={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]};CKEDITOR.plugins.add("format",{combo:false,requires:["richcombo","styles"],init:function(g){var b=g.config,a=g.lang.format;var k=b.format_tags.split(";");var j={};for(var d=0;d<k.length;d++){var l=k[d];j[l]=new CKEDITOR.style(b["format_"+l]);j[l]._.enterMode=g.config.enterMode}var c=b.format_disabled.split(";");var f=function(p){var o=this.getValue();var n=p.data.path;var q=n.block?n.block.getName():"";if(jQuery.inArray(q,c)>-1){this.setState(CKEDITOR.TRISTATE_DISABLED);return}else{this.setState(CKEDITOR.TRISTATE_OFF)}for(var m in j){if(j[m].checkActive(n)){if(m!=o){this.setValue(m,g.lang.format["tag_"+m])}return}}this.setValue("")};var h=this;g.on("selectionChange",function(m){f.apply(h.combo,[m])});g.ui.addRichCombo("Format",{label:a.label,title:a.panelTitle,className:"cke_format",panel:{css:g.skin.editor.css.concat(b.contentsCss),multiSelect:false,attributes:{"aria-label":a.panelTitle}},init:function(){this.startGroup(a.panelTitle);for(var m in j){var n=a["tag_"+m];this.add(m,"<"+m+">"+n+"</"+m+">",n)}},onClick:function(m){g.focus();g.fire("saveSnapshot");j[m].apply(g.document);setTimeout(function(){g.fire("saveSnapshot")},0)},onRender:function(){h.combo=this}})}});CKEDITOR.config.format_tags="p;h1;h2;h3;h4;h5;h6;pre;address;div";CKEDITOR.config.format_p={element:"p"};CKEDITOR.config.format_div={element:"div"};CKEDITOR.config.format_pre={element:"pre"};CKEDITOR.config.format_address={element:"address"};CKEDITOR.config.format_h1={element:"h1"};CKEDITOR.config.format_h2={element:"h2"};CKEDITOR.config.format_h3={element:"h3"};CKEDITOR.config.format_h4={element:"h4"};CKEDITOR.config.format_h5={element:"h5"};CKEDITOR.config.format_h6={element:"h6"};CKEDITOR.config.format_disabled="li;dt;dd";(function(){var G=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/;var H="{cke_protected}";function E(J){return J.type==CKEDITOR.NODE_ELEMENT&&J.name=="br"&&(typeof J.attributes["data-rte-washtml"]=="undefined")}function k(K){var L=K.children.length,J=K.children[L-1];while(J&&J.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(J.value)){J=K.children[--L]}return J}function r(M,J){var K=M.children,L=k(M);if(L){if((J||!CKEDITOR.env.ie)&&E(L)){K.pop()}if(L.type==CKEDITOR.NODE_TEXT&&G.test(L.value)){K.pop()}}}function F(M,J,K){if(!J&&(!K||typeof K=="function"&&(K(M)===false))){return false}if(J&&CKEDITOR.env.ie&&(document.documentMode>7||M.name in CKEDITOR.dtd.tr||M.name in CKEDITOR.dtd.$listItem)){return false}var L=k(M);return !L||L&&(M.name=="form"&&L.name=="input")}function n(K,J){return function(L){r(L,!K);if(F(L,!K,J)){if(K||CKEDITOR.env.ie){L.add(new CKEDITOR.htmlParser.text("\xa0"))}else{L.add(new CKEDITOR.htmlParser.element("br",{}))}}}}var v=CKEDITOR.dtd;var d=CKEDITOR.tools.extend({},v.$block,v.$listItem,v.$tableContent);for(var B in d){if(!("br" in v[B])){delete d[B]}}delete d.pre;var x={elements:{},attributeNames:[[(/^on/),"data-cke-pa-on"]]};var h={elements:{}};for(B in d){h.elements[B]=n()}var c={elementNames:[[(/^cke:/),""],[(/^\?xml:namespace$/),""]],attributeNames:[[(/^data-cke-(saved|pa)-/),""],[(/^data-cke.*/),""],["hidefocus",""]],elements:{$:function(L){var N=L.attributes;if(N){if(N["data-cke-temp"]){return false}var M=["name","href","src"],K;for(var J=0;J<M.length;J++){K="data-cke-saved-"+M[J];K in N&&(delete N[M[J]])}}return L},embed:function(K){var M=K.parent;if(M&&M.name=="object"){var L=M.attributes.width,J=M.attributes.height;L&&(K.attributes.width=L);J&&(K.attributes.height=J)}},param:function(J){J.children=[];J.isEmpty=true;return J},a:function(J){if(!(J.children.length||J.attributes.name||J.attributes["data-cke-saved-name"])){return false}},span:function(J){if(J.attributes["class"]=="Apple-style-span"){delete J.name}},html:function(J){delete J.attributes.contenteditable;delete J.attributes["class"]},body:function(J){delete J.attributes.spellcheck;delete J.attributes.contenteditable},style:function(J){var K=J.children[0];K&&K.value&&(K.value=CKEDITOR.tools.trim(K.value));if(!J.attributes.type){J.attributes.type="text/css"}},title:function(K){var J=K.children[0];J&&(J.value=K.attributes["data-cke-title"]||"")}},attributes:{"class":function(K,J){return CKEDITOR.tools.ltrim(K.replace(/(?:^|\s+)cke_[^\s]*/g,""))||false}},comment:function(J){if(J.substr(0,H.length)==H){if(J.substr(H.length,3)=="{C}"){J=J.substr(H.length+3)}else{J=J.substr(H.length)}return new CKEDITOR.htmlParser.cdata(decodeURIComponent(J))}return J}};if(CKEDITOR.env.ie){c.attributes.style=function(K,J){return K.toLowerCase()}}function o(J){J.attributes.contenteditable="false"}function a(J){delete J.attributes.contenteditable}for(B in {input:1,textarea:1}){x.elements[B]=o;c.elements[B]=a}var s=/<((?:a|area|img|input)\b[\s\S]*?\s)((href|src|name)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+)))([^>]*)>/gi,g=/\sdata-cke-saved-src\s*=/;var m=/(?:<style(?=[ >])[^>]*>[\s\S]*<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,I=/<cke:encoded>([^<]*)<\/cke:encoded>/gi;var l=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,p=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi;var j=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi;function u(J){return J.replace(s,function(K,O,N,M,L){if(M=="src"&&g.test(K)){return K}else{return"<"+O+N+" data-cke-saved-"+N+L+">"}})}function f(J){return J.replace(m,function(K){return"<cke:encoded>"+encodeURIComponent(K)+"</cke:encoded>"})}function b(J){return J.replace(I,function(K,L){return decodeURIComponent(L)})}function w(J){return J.replace(l,"$1cke:$2")}function z(J){return J.replace(p,"$1$2")}function D(J){return J.replace(j,"<cke:$1$2></cke:$1>")}function A(J){return J.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2")}function y(J){return J.replace(/<!--(?!{cke_protected})[\s\S]+?-->/g,function(K){return"<!--"+H+"{C}"+encodeURIComponent(K).replace(/--/g,"%2D%2D")+"-->"})}function q(J){return J.replace(/<!--\{cke_protected\}\{C\}([\s\S]+?)-->/g,function(K,L){return decodeURIComponent(L)})}function C(N,O){var K=[],M=/<\!--\{cke_temp(comment)?\}(\d*?)-->/g;var J=[(/<script[\s\S]*?<\/script>/gi),/<noscript[\s\S]*?<\/noscript>/gi].concat(O);N=N.replace((/<!--[\s\S]*?-->/g),function(P){return"<!--{cke_tempcomment}"+(K.push(P)-1)+"-->"});for(var L=0;L<J.length;L++){N=N.replace(J[L],function(P){P=P.replace(M,function(R,Q,S){return K[S]});return"<!--{cke_temp}"+(K.push(P)-1)+"-->"})}N=N.replace(M,function(Q,P,R){return"<!--"+H+(P?"{C}":"")+encodeURIComponent(K[R]).replace(/--/g,"%2D%2D")+"-->"});return N}CKEDITOR.plugins.add("htmldataprocessor",{requires:["htmlwriter"],init:function(L){var J=L.dataProcessor=new CKEDITOR.htmlDataProcessor(L);J.writer.forceSimpleAmpersand=L.config.forceSimpleAmpersand;J.dataFilter.addRules(x);J.dataFilter.addRules(h);J.htmlFilter.addRules(c);var K={elements:{}};for(B in d){K.elements[B]=n(true,L.config.fillEmptyBlocks)}J.htmlFilter.addRules(K)},onLoad:function(){!("fillEmptyBlocks" in CKEDITOR.config)&&(CKEDITOR.config.fillEmptyBlocks=1)}});CKEDITOR.htmlDataProcessor=function(J){this.editor=J;this.writer=new CKEDITOR.htmlWriter();this.dataFilter=new CKEDITOR.htmlParser.filter();this.htmlFilter=new CKEDITOR.htmlParser.filter()};CKEDITOR.htmlDataProcessor.prototype={toHtml:function(M,J){M=C(M,this.editor.config.protectedSource);M=u(M);M=f(M);M=w(M);M=D(M);M=A(M);var N=new CKEDITOR.dom.element("div");N.setHtml("a"+M);M=N.getHtml().substr(1);M=z(M);M=b(M);M=q(M);var K=CKEDITOR.htmlParser.fragment.fromHtml(M,J),L=new CKEDITOR.htmlParser.basicWriter();K.writeHtml(L,this.dataFilter);M=L.getHtml(true);M=y(M);return M},toDataFormat:function(L,J){var M=this.writer,K=CKEDITOR.htmlParser.fragment.fromHtml(L,J);M.reset();K.writeHtml(M,this.htmlFilter);return M.getHtml(true)}}})();(function(){function a(g,d){var c=g.createFakeParserElement(d,"cke_iframe","iframe",true),h=c.attributes.style||"";var f=d.attributes.width,b=d.attributes.height;if(typeof f!="undefined"){h+="width:"+CKEDITOR.tools.cssLength(f)+";"}if(typeof b!="undefined"){h+="height:"+CKEDITOR.tools.cssLength(b)+";"}c.attributes.style=h;return c}CKEDITOR.plugins.add("iframe",{requires:["dialog","fakeobjects"],init:function(b){var c="iframe",d=b.lang.iframe;CKEDITOR.dialog.add(c,this.path+"dialogs/iframe.js");b.addCommand(c,new CKEDITOR.dialogCommand(c));b.addCss("img.cke_iframe{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}");b.ui.addButton("Iframe",{label:d.toolbar,command:c});b.on("doubleclick",function(f){var g=f.data.element;if(g.is("img")&&g.data("cke-real-element-type")=="iframe"){f.data.dialog="iframe"}});if(b.addMenuItems){b.addMenuItems({iframe:{label:d.title,command:"iframe",group:"image"}})}if(b.contextMenu){b.contextMenu.addListener(function(f,g){if(f&&f.is("img")&&f.data("cke-real-element-type")=="iframe"){return{iframe:CKEDITOR.TRISTATE_OFF}}})}},afterInit:function(c){var b=c.dataProcessor,d=b&&b.dataFilter;if(d){d.addRules({elements:{iframe:function(f){return a(c,f)}}})}}})})();(function(){var b={ol:1,ul:1};var j=CKEDITOR.dom.walker.whitespaces(true),g=CKEDITOR.dom.walker.bookmark(false,true);function h(k,l){k.getCommand(this.name).setState(l)}function f(s){var m=s.editor;var v=s.data.path;var p=v.block?v.block.getName():"";if((/h\d/).test(p)){return h.call(this,m,CKEDITOR.TRISTATE_DISABLED)}if(p=="p"){var n=v.block.getStyle("text-align");if((n=="center")||(n=="right")){return h.call(this,m,CKEDITOR.TRISTATE_DISABLED)}}var u=s.data.path,o=u&&u.contains(b);if(o){return h.call(this,m,CKEDITOR.TRISTATE_OFF)}if(!this.useIndentClasses&&this.name=="indent"){return h.call(this,m,CKEDITOR.TRISTATE_OFF)}var v=s.data.path,r=v.block||v.blockLimit;if(!r){return h.call(this,m,CKEDITOR.TRISTATE_DISABLED)}if(this.useIndentClasses){var k=r.$.className.match(this.classNameRegex),q=0;if(k){k=k[1];q=this.indentClassMap[k]}if((this.name=="outdent"&&!q)||(this.name=="indent"&&q==m.config.indentClasses.length)){return h.call(this,m,CKEDITOR.TRISTATE_DISABLED)}return h.call(this,m,CKEDITOR.TRISTATE_OFF)}else{var l=parseInt(r.getStyle(c(r)),10);if(isNaN(l)){l=0}if(l<=0){return h.call(this,m,CKEDITOR.TRISTATE_DISABLED)}return h.call(this,m,CKEDITOR.TRISTATE_OFF)}}function a(m,k){this.name=k;this.useIndentClasses=m.config.indentClasses&&m.config.indentClasses.length>0;if(this.useIndentClasses){this.classNameRegex=new RegExp("(?:^|\\s+)("+m.config.indentClasses.join("|")+")(?=$|\\s)");this.indentClassMap={};for(var l=0;l<m.config.indentClasses.length;l++){this.indentClassMap[m.config.indentClasses[l]]=l+1}}this.startDisabled=k=="outdent"}function c(l,k){return(k||l.getComputedStyle("direction"))=="ltr"?"margin-left":"margin-right"}function d(k){return k.type=CKEDITOR.NODE_ELEMENT&&k.is("li")}a.prototype={exec:function(n){var x=this,v={};function C(J){var Y=w.startContainer,Z=w.endContainer;while(Y&&!Y.getParent().equals(J)){Y=Y.getParent()}while(Z&&!Z.getParent().equals(J)){Z=Z.getParent()}if(!Y||!Z){return}var R=Y,Q=[],V=false;while(!V){if(R.equals(Z)){V=true}Q.push(R);R=R.getNext()}if(Q.length<1){return}var S=J.getParents(true);for(var W=0;W<S.length;W++){if(S[W].getName&&b[S[W].getName()]){J=S[W];break}}var X=x.name=="indent"?1:-1,G=Q[0],T=Q[Q.length-1];var O=CKEDITOR.plugins.list.listToArray(J,v);O[T.getCustomData("listarray_index")].toIndent=true;var E=O[T.getCustomData("listarray_index")].indent;for(W=G.getCustomData("listarray_index");W<=T.getCustomData("listarray_index");W++){O[W].indent+=X;var N=O[W].parent;O[W].parent=new CKEDITOR.dom.element(N.getName(),N.getDocument())}for(W=T.getCustomData("listarray_index")+1;W<O.length&&O[W].indent>E;W++){O[W].indent+=X}var K=CKEDITOR.plugins.list.arrayToList(O,v,null,n.config.enterMode,J.getDirection());if(x.name=="outdent"){var F;if((F=J.getParent())&&F.is("li")){var I=K.listNode.getChildren(),M=[],P=I.count(),L;for(W=P-1;W>=0;W--){if((L=I.getItem(W))&&L.is&&L.is("li")){M.push(L)}}}}if(K){K.listNode.replace(J)}if(M&&M.length){for(W=0;W<M.length;W++){var U=M[W],H=U;while((H=H.getNext())&&H.is&&H.getName() in b){if(CKEDITOR.env.ie&&!U.getFirst(function(aa){return j(aa)&&g(aa)})){U.append(w.document.createText("\u00a0"))}U.append(H)}U.insertAfter(F)}}}function k(){var F=w.createIterator(),E=n.config.enterMode;F.enforceRealBlocks=true;F.enlargeBr=E!=CKEDITOR.ENTER_BR;var G;while((G=F.getNextParagraph())){l(G)}}function l(H,G){if(H.getCustomData("indent_processed")){return false}if(x.useIndentClasses){var F=H.$.className.match(x.classNameRegex),E=0;if(F){F=F[1];E=x.indentClassMap[F]}if(x.name=="outdent"){E--}else{E++}if(E<0){return false}E=Math.min(E,n.config.indentClasses.length);E=Math.max(E,0);H.$.className=CKEDITOR.tools.ltrim(H.$.className.replace(x.classNameRegex,""));if(E>0){H.addClass(n.config.indentClasses[E-1])}}else{var K=c(H,G),J=parseInt(H.getStyle(K),10);if(isNaN(J)){J=0}var I=n.config.indentOffset||40;J+=(x.name=="indent"?1:-1)*I;if(J<0){return false}J=Math.max(J,0);J=Math.ceil(J/I)*I;H.setStyle(K,J?J+(n.config.indentUnit||"px"):"");if(H.getAttribute("style")===""){H.removeAttribute("style")}}CKEDITOR.dom.element.setMarker(v,H,"indent_processed",1);return true}var D=n.getSelection(),q=D.createBookmarks(1),m=D&&D.getRanges(1),w;var y=m.createIterator();while((w=y.getNextRange())){var u=w.getCommonAncestor(),r=u;while(r&&!(r.type==CKEDITOR.NODE_ELEMENT&&b[r.getName()])){r=r.getParent()}if(!r){var A=w.getEnclosedNode();if(A&&A.type==CKEDITOR.NODE_ELEMENT&&A.getName() in b){w.setStartAt(A,CKEDITOR.POSITION_AFTER_START);w.setEndAt(A,CKEDITOR.POSITION_BEFORE_END);r=A}}if(r&&w.startContainer.type==CKEDITOR.NODE_ELEMENT&&w.startContainer.getName() in b){var z=new CKEDITOR.dom.walker(w);z.evaluator=d;w.startContainer=z.next()}if(r&&w.endContainer.type==CKEDITOR.NODE_ELEMENT&&w.endContainer.getName() in b){z=new CKEDITOR.dom.walker(w);z.evaluator=d;w.endContainer=z.previous()}if(r){var s=r.getFirst(d),o=!!s.getNext(d),B=w.startContainer,p=s.equals(B)||s.contains(B);if(!(p&&(x.name=="indent"||x.useIndentClasses||parseInt(r.getStyle(c(r)),10))&&l(r,!o&&s.getDirection()))){C(r)}}else{k()}}CKEDITOR.dom.element.clearAllMarkers(v);n.forceNextSelectionCheck();D.selectBookmarks(q)}};CKEDITOR.plugins.add("indent",{init:function(l){var k=new a(l,"indent"),m=new a(l,"outdent");l.addCommand("indent",k);l.addCommand("outdent",m);l.ui.addButton("Indent",{label:l.lang.indent,command:"indent"});l.ui.addButton("Outdent",{label:l.lang.outdent,command:"outdent"});l.on("selectionChange",CKEDITOR.tools.bind(f,k));l.on("selectionChange",CKEDITOR.tools.bind(f,m));if(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat){l.addCss("ul,ol{	margin-left: 0px;	padding-left: 40px;}")}l.on("dirChanged",function(v){var s=new CKEDITOR.dom.range(l.document);s.setStartBefore(v.data.node);s.setEndAfter(v.data.node);var n=new CKEDITOR.dom.walker(s),o;while((o=n.next())){if(o.type==CKEDITOR.NODE_ELEMENT){if(!o.equals(v.data.node)&&o.getDirection()){s.setStartAfter(o);n=new CKEDITOR.dom.walker(s);continue}var q=l.config.indentClasses;if(q){var w=(v.data.dir=="ltr")?["_rtl",""]:["","_rtl"];for(var r=0;r<q.length;r++){if(o.hasClass(q[r]+w[0])){o.removeClass(q[r]+w[0]);o.addClass(q[r]+w[1])}}}var p=o.getStyle("margin-right"),u=o.getStyle("margin-left");p?o.setStyle("margin-left",p):o.removeStyle("margin-left");u?o.setStyle("margin-right",u):o.removeStyle("margin-right")}}})},requires:["domiterator","list"]})})();CKEDITOR.plugins.add("keystrokes",{beforeInit:function(a){a.keystrokeHandler=new CKEDITOR.keystrokeHandler(a);a.specialKeys={}},init:function(d){var g=d.config.keystrokes,a=d.config.blockedKeystrokes;var f=d.keystrokeHandler.keystrokes,b=d.keystrokeHandler.blockedKeystrokes;for(var c=0;c<g.length;c++){f[g[c][0]]=g[c][1]}for(c=0;c<a.length;c++){b[a[c]]=1}}});CKEDITOR.keystrokeHandler=function(a){if(a.keystrokeHandler){return a.keystrokeHandler}this.keystrokes={};this.blockedKeystrokes={};this._={editor:a};return this};(function(){var c;var b=function(h){h=h.data;var d=h.getKeystroke();var k=this.keystrokes[d];var g=this._.editor;c=(g.fire("key",{keyCode:d})===true);if(!c){if(k){var j={from:"keystrokeHandler"};c=(g.execCommand(k,j)!==false)}if(!c){var f=g.specialKeys[d];c=(f&&f(g)===true);if(!c){c=!!this.blockedKeystrokes[d]}}}if(c){h.preventDefault(true)}return !c};var a=function(d){if(c){c=false;d.data.preventDefault(true)}};CKEDITOR.keystrokeHandler.prototype={attach:function(d){d.on("keydown",b,this);if(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.mac)){d.on("keypress",a,this)}}}})();CKEDITOR.config.blockedKeystrokes=[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85];CKEDITOR.config.keystrokes=[[CKEDITOR.ALT+121,"toolbarFocus"],[CKEDITOR.ALT+122,"elementsPathFocus"],[CKEDITOR.SHIFT+121,"contextMenu"],[CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu"],[CKEDITOR.CTRL+90,"undo"],[CKEDITOR.CTRL+89,"redo"],[CKEDITOR.CTRL+CKEDITOR.SHIFT+90,"redo"],[CKEDITOR.CTRL+76,"link"],[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+85,"underline"],[CKEDITOR.ALT+109,"toolbarCollapse"],[CKEDITOR.ALT+48,"a11yHelp"]];(function(){var r={ol:1,ul:1},c=/^[\n\r\t ]*$/;var l=CKEDITOR.dom.walker.whitespaces(),d=CKEDITOR.dom.walker.bookmark(),f=function(w){return !(l(w)||d(w))};CKEDITOR.plugins.list={listToArray:function(z,H,F,E,G){if(!r[z.getName()]){return[]}if(!E){E=0}if(!F){F=[]}for(var B=0,C=z.getChildCount();B<C;B++){var w=z.getChild(B);if(w.$.nodeName.toLowerCase()!="li"){continue}var D={parent:z,indent:E,element:w,contents:[]};if(!G){D.grandparent=z.getParent();if(D.grandparent&&D.grandparent.$.nodeName.toLowerCase()=="li"){D.grandparent=D.grandparent.getParent()}}else{D.grandparent=G}if(H){CKEDITOR.dom.element.setMarker(H,w,"listarray_index",F.length)}F.push(D);for(var A=0,x=w.getChildCount(),y;A<x;A++){y=w.getChild(A);if(y.type==CKEDITOR.NODE_ELEMENT&&r[y.getName()]){CKEDITOR.plugins.list.listToArray(y,H,F,E+1,D.grandparent)}else{D.contents.push(y)}}}return F},arrayToList:function(A,E,F,P,I){if(!F){F=0}if(!A||A.length<F+1){return null}var O=A[F].parent.getDocument(),H=new CKEDITOR.dom.documentFragment(O),N=null,y=F,J=Math.max(A[F].indent,0),w=null,D=(P==CKEDITOR.ENTER_P?"p":"div");while(1){var L=A[y];if(L.indent==J){if(!N||A[y].parent.getName()!=N.getName()){N=A[y].parent.clone(false,1);if(L.toIndent){N.removeAttribute("data-rte-empty-lines-before");N.setAttribute("data-rte-new-node",true)}I&&N.setAttribute("dir",I);H.append(N)}w=N.append(L.element.clone(0,1));for(var K=0;K<L.contents.length;K++){w.append(L.contents[K].clone(1,1))}y++}else{if(L.indent==Math.max(J,0)+1){var G=CKEDITOR.plugins.list.arrayToList(A,null,y,P);w.append(G.listNode);y=G.nextIndex}else{if(L.indent==-1&&!F&&L.grandparent){w;if(r[L.grandparent.getName()]){w=L.element.clone(false,true)}else{if(I||L.element.hasAttributes()||(P!=CKEDITOR.ENTER_BR&&L.grandparent.getName()!="td")){w=O.createElement(D);L.element.copyAttributes(w,{type:1,value:1});I&&w.setAttribute("dir",I);if(!I&&P==CKEDITOR.ENTER_BR&&!w.hasAttributes()){w=new CKEDITOR.dom.documentFragment(O)}}else{w=new CKEDITOR.dom.documentFragment(O)}}for(K=0;K<L.contents.length;K++){w.append(L.contents[K].clone(1,1))}if(w.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&y!=A.length-1){var C=w.getLast();if(C&&C.type==CKEDITOR.NODE_ELEMENT&&C.getAttribute("type")=="_moz"){C.remove()}if(!(C=w.getLast(f)&&C.type==CKEDITOR.NODE_ELEMENT&&C.getName() in CKEDITOR.dtd.$block)){w.append(O.createElement("br"))}}if(w.type==CKEDITOR.NODE_ELEMENT&&w.getName()==D&&w.$.firstChild){w.trim();var x=w.getFirst();if(x.type==CKEDITOR.NODE_ELEMENT&&x.isBlockBoundary()){var M=new CKEDITOR.dom.documentFragment(O);w.moveChildren(M);w=M}}var B=w.$.nodeName.toLowerCase();if(!CKEDITOR.env.ie&&(B=="div"||B=="p")){w.appendBogus()}H.append(w);N=null;y++}else{return null}}}if(A.length<=y||Math.max(A[y].indent,0)<J){break}}if(E){var z=H.getFirst();while(z){if(z.type==CKEDITOR.NODE_ELEMENT){CKEDITOR.dom.element.clearMarkers(E,z)}z=z.getNextSourceNode()}}return{listNode:H,nextIndex:y}}};function m(w,x){w.getCommand(this.name).setState(x)}function j(w){var B=w.data.path,x=B.blockLimit,A=B.elements,z;var C=B.block?B.block.getName():"";if((/h\d/).test(C)){return m.call(this,w.editor,CKEDITOR.TRISTATE_DISABLED)}for(var y=0;y<A.length&&(z=A[y])&&!z.equals(x);y++){if(r[A[y].getName()]){return m.call(this,w.editor,this.type==A[y].getName()?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}}return m.call(this,w.editor,CKEDITOR.TRISTATE_OFF)}function h(F,E,I,J){var B=CKEDITOR.plugins.list.listToArray(E.root,I),H=[];for(var D=0;D<E.contents.length;D++){var z=E.contents[D];z=z.getAscendant("li",true);if(!z||z.getCustomData("list_item_processed")){continue}H.push(z);CKEDITOR.dom.element.setMarker(I,z,"list_item_processed",true)}var G=E.root,C=G.getDocument().createElement(this.type);G.copyAttributes(C,{start:1,type:1});C.removeStyle("list-style-type");for(D=0;D<H.length;D++){var A=H[D].getCustomData("listarray_index");B[A].parent=C}var y=CKEDITOR.plugins.list.arrayToList(B,I,null,F.config.enterMode);var x,w=y.listNode.getChildCount();for(D=0;D<w&&(x=y.listNode.getChild(D));D++){if(x.getName()==this.type){J.push(x)}}y.listNode.replace(E.root)}var v=/^h[1-6]$/;function b(x,C,B){var K=C.contents,O=C.root.getDocument(),M=[];if(K.length==1&&K[0].equals(C.root)){var J=O.createElement("div");K[0].moveChildren&&K[0].moveChildren(J);K[0].append(J);K[0]=J}var G=C.contents[0].getParent();for(var I=0;I<K.length;I++){G=G.getCommonAncestor(K[I].getParent())}var L=x.config.useComputedState,H,w;L=L===undefined||L;for(I=0;I<K.length;I++){var z=K[I],D;while((D=z.getParent())){if(D.equals(G)){M.push(z);if(!w&&z.getDirection()){w=1}var F=z.getDirection(L);if(H!==null){if(H&&H!=F){H=null}else{H=F}}break}z=D}}if(M.length<1){return}var N=M[M.length-1].getNext(),y=O.createElement(this.type);x.fire("listCreated",{listNode:y});B.push(y);var A,E;while(M.length){A=M.shift();E=O.createElement("li");if(A.is("pre")||v.test(A.getName())){A.appendTo(E)}else{if(H&&A.getDirection()){A.removeStyle("direction");A.removeAttribute("dir")}A.copyAttributes(E);A.moveChildren(E);A.remove()}E.appendTo(y)}if(H&&w){y.setAttribute("dir",H)}if(N){y.insertBefore(N)}else{y.appendTo(G)}}function u(F,E,L){var B=CKEDITOR.plugins.list.listToArray(E.root,L),J=[];for(var C=0;C<E.contents.length;C++){var y=E.contents[C];y=y.getAscendant("li",true);if(!y||y.getCustomData("list_item_processed")){continue}J.push(y);CKEDITOR.dom.element.setMarker(L,y,"list_item_processed",true)}var G=null;for(C=0;C<J.length;C++){var A=J[C].getCustomData("listarray_index");B[A].indent=-1;G=A}for(C=G+1;C<B.length;C++){if(B[C].indent>B[C-1].indent+1){var I=B[C-1].indent+1-B[C].indent;var z=B[C].indent;while(B[C]&&B[C].indent>=z){B[C].indent+=I;C++}C--}}var x=CKEDITOR.plugins.list.arrayToList(B,L,null,F.config.enterMode,E.root.getAttribute("dir"));var H=x.listNode,w,D;function K(M){if((w=H[M?"getFirst":"getLast"]())&&!(w.is&&w.isBlockBoundary())&&(D=E.root[M?"getPrevious":"getNext"](CKEDITOR.dom.walker.whitespaces(true)))&&!(D.is&&D.isBlockBoundary({br:1}))){F.document.createElement("br")[M?"insertBefore":"insertAfter"](w)}}K(true);K();H.replace(E.root)}function o(w,x){this.name=w;this.type=x}o.prototype={exec:function(y){y.focus();var aa=y.document,Z=y.getSelection(),x=Z&&Z.getRanges(CKEDITOR.ONLY_FORMATTABLES);if(!x||x.length<1){return}if(this.state==CKEDITOR.TRISTATE_OFF){var I=aa.getBody();I.trim();if(!I.getFirst()){var W=aa.createElement(y.config.enterMode==CKEDITOR.ENTER_P?"p":(y.config.enterMode==CKEDITOR.ENTER_DIV?"div":"br"));W.appendTo(I);x=new CKEDITOR.dom.rangeList([new CKEDITOR.dom.range(aa)]);if(W.is("br")){x[0].setStartBefore(W);x[0].setEndAfter(W)}else{x[0].selectNodeContents(W)}Z.selectRanges(x)}else{var K=x.length==1&&x[0],U=K&&K.getEnclosedNode();if(U&&U.is&&this.type==U.getName()){m.call(this,y,CKEDITOR.TRISTATE_ON)}}}var A=Z.createBookmarks(true);var V=[],J={},H=x.createIterator(),C=0;while((K=H.getNextRange())&&++C){var T=K.getBoundaryNodes(),Y=T.startNode,L=T.endNode;if(Y.type==CKEDITOR.NODE_ELEMENT&&Y.getName()=="td"){K.setStartAt(T.startNode,CKEDITOR.POSITION_AFTER_START)}if(L.type==CKEDITOR.NODE_ELEMENT&&L.getName()=="td"){K.setEndAt(T.endNode,CKEDITOR.POSITION_BEFORE_END)}var N=K.createIterator(),G;N.forceBrBreak=(this.state==CKEDITOR.TRISTATE_OFF);while((G=N.getNextParagraph())){if(G.getCustomData("list_block")){continue}else{CKEDITOR.dom.element.setMarker(J,G,"list_block",1)}var M=new CKEDITOR.dom.elementPath(G),X=M.elements,S=X.length,z=null,F=0,B=M.blockLimit,w;for(var R=S-1;R>=0&&(w=X[R]);R--){if(r[w.getName()]&&B.contains(w)){B.removeCustomData("list_group_object_"+C);var E=w.getCustomData("list_group_object");if(E){E.contents.push(G)}else{E={root:w,contents:[G]};V.push(E);CKEDITOR.dom.element.setMarker(J,w,"list_group_object",E)}F=1;break}}if(F){continue}var Q=B;if(Q.getCustomData("list_group_object_"+C)){Q.getCustomData("list_group_object_"+C).contents.push(G)}else{E={root:Q,contents:[G]};CKEDITOR.dom.element.setMarker(J,Q,"list_group_object_"+C,E);V.push(E)}}}var D=[];while(V.length>0){E=V.shift();if(this.state==CKEDITOR.TRISTATE_OFF){if(r[E.root.getName()]){h.call(this,y,E,J,D)}else{b.call(this,y,E,D)}}else{if(this.state==CKEDITOR.TRISTATE_ON&&r[E.root.getName()]){u.call(this,y,E,J)}}}for(R=0;R<D.length;R++){z=D[R];var O,P=this;(O=function(ac){var ab=z[ac?"getPrevious":"getNext"](CKEDITOR.dom.walker.whitespaces(true));if(ab&&ab.getName&&ab.getName()==P.type){ab.remove();ab.moveChildren(z,ac)}})();O(1)}CKEDITOR.dom.element.clearAllMarkers(J);Z.selectBookmarks(A);y.focus()}};var n=CKEDITOR.dtd;var s=/[\t\r\n ]*(?:&nbsp;|\xa0)$/;function k(y,B){var A,x=y.children,z=x.length;for(var w=0;w<z;w++){A=x[w];if(A.name&&(A.name in B)){return w}}return z}function a(w){return function(C){var z=C.children,B=k(C,n.$list),y=z[B],x=y&&y.previous,D;if(x&&(x.name&&x.name=="br"||x.value&&(D=x.value.match(s)))){var A=x;if(!(D&&D.index)&&A==z[0]){z[0]=(w||CKEDITOR.env.ie)?new CKEDITOR.htmlParser.text("\xa0"):new CKEDITOR.htmlParser.element("br",{})}else{if(A.name=="br"){z.splice(B-1,1)}else{A.value=A.value.replace(s,"")}}}}}var g={elements:{}};for(var p in n.$listItem){g.elements[p]=a()}var q={elements:{}};for(p in n.$listItem){q.elements[p]=a(true)}CKEDITOR.plugins.add("list",{init:function(x){var y=new o("numberedlist","ol"),w=new o("bulletedlist","ul");x.addCommand("numberedlist",y);x.addCommand("bulletedlist",w);x.ui.addButton("NumberedList",{label:x.lang.numberedlist,command:"numberedlist"});x.ui.addButton("BulletedList",{label:x.lang.bulletedlist,command:"bulletedlist"});x.on("selectionChange",CKEDITOR.tools.bind(j,y));x.on("selectionChange",CKEDITOR.tools.bind(j,w))},afterInit:function(x){var w=x.dataProcessor;if(w){w.dataFilter.addRules(g);w.htmlFilter.addRules(q)}},requires:["domiterator"]})})();(function(){CKEDITOR.plugins.add("pastefromword",{init:function(c){var a=0;var b=function(){setTimeout(function(){a=0},0)};c.addCommand("pastefromword",{canUndo:false,exec:function(){a=1;if(c.execCommand("paste")===false){c.on("dialogHide",function(d){d.removeListener();b()})}else{b()}}});c.ui.addButton("PasteFromWord",{label:c.lang.pastefromword.toolbar,command:"pastefromword"});c.on("paste",function(d){var g=d.data,h;if((h=g.html)&&(a||(/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/).test(h))){var f=this.loadFilterRules(function(){if(f){c.fire("paste",g)}else{if(!c.config.pasteFromWordPromptCleanup||(a||confirm(c.lang.pastefromword.confirmCleanup))){g.html=CKEDITOR.cleanWord(h,c)}}});f&&d.cancel()}},this)},loadFilterRules:function(c){var a=CKEDITOR.cleanWord;if(a){c()}else{var b=CKEDITOR.getUrl(CKEDITOR.config.pasteFromWordCleanupFile||(this.path+"filter/default.js"));CKEDITOR.scriptLoader.load(b,c,null,false,true)}return !a}})})();(function(){var a={exec:function(c){var b=CKEDITOR.tools.tryThese(function(){var d=window.clipboardData.getData("Text");if(!d){throw 0}return d});if(!b){c.openDialog("pastetext");return false}else{c.fire("paste",{text:b})}return true}};CKEDITOR.plugins.add("pastetext",{init:function(c){var b="pastetext",d=c.addCommand(b,a);c.ui.addButton("PasteText",{label:c.lang.pasteText.button,command:b});CKEDITOR.dialog.add(b,CKEDITOR.getUrl(this.path+"dialogs/pastetext.js"));if(c.config.forcePasteAsPlainText){c.on("beforeCommandExec",function(f){if(f.data.name=="paste"){c.execCommand("pastetext");f.cancel()}},null,null,0)}},requires:["clipboard"]})})();CKEDITOR.plugins.add("popup");CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{popup:function(c,f,a,b){f=f||"80%";a=a||"70%";if(typeof f=="string"&&f.length>1&&f.substr(f.length-1,1)=="%"){f=parseInt(window.screen.width*parseInt(f,10)/100,10)}if(typeof a=="string"&&a.length>1&&a.substr(a.length-1,1)=="%"){a=parseInt(window.screen.height*parseInt(a,10)/100,10)}if(f<640){f=640}if(a<420){a=420}var j=parseInt((window.screen.height-a)/2,10),h=parseInt((window.screen.width-f)/2,10);b=(b||"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes")+",width="+f+",height="+a+",top="+j+",left="+h;var d=window.open("",null,b,true);if(!d){return false}try{d.moveTo(h,j);d.resizeTo(f,a);d.focus();d.location.href=c}catch(g){d=window.open(c,null,b,true)}return true}});(function(){var a={modes:{wysiwyg:1,source:1},canUndo:false,exec:function(p){var j,h=p.config,m=h.baseHref?'<base href="'+h.baseHref+'"/>':"",k=CKEDITOR.env.isCustomDomain();if(h.fullPage){j=p.getData().replace(/<head>/,"$&"+m).replace(/[^>]*(?=<\/title>)/,p.lang.preview)}else{var n="<body ",o=p.document&&p.document.getBody();if(o){if(o.getAttribute("id")){n+='id="'+o.getAttribute("id")+'" '}if(o.getAttribute("class")){n+='class="'+o.getAttribute("class")+'" '}}n+=">";j=p.config.docType+'<html dir="'+p.config.contentsLangDirection+'"><head>'+m+"<title>"+p.lang.preview+"</title>"+CKEDITOR.tools.buildStyleHtml(p.config.contentsCss)+"</head>"+n+p.getData()+"</body></html>"}var f=640,c=420,l=80;try{var r=window.screen;f=Math.round(r.width*0.8);c=Math.round(r.height*0.7);l=Math.round(r.width*0.1)}catch(q){}var g="";if(k){window._cke_htmlToLoad=j;g='javascript:void( (function(){document.open();document.domain="'+document.domain+'";document.write( window.opener._cke_htmlToLoad );document.close();window.opener._cke_htmlToLoad = null;})() )'}var d=window.open(g,null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+f+",height="+c+",left="+l);if(!k){d.document.open();d.document.write(j);d.document.close()}}};var b="preview";CKEDITOR.plugins.add(b,{init:function(c){c.addCommand(b,a);c.ui.addButton("Preview",{label:c.lang.preview,command:b})}})})();CKEDITOR.plugins.add("print",{init:function(a){var b="print";var c=a.addCommand(b,CKEDITOR.plugins.print);a.ui.addButton("Print",{label:a.lang.print,command:b})}});CKEDITOR.plugins.print={exec:function(a){if(CKEDITOR.env.opera){return}else{if(CKEDITOR.env.gecko){a.window.$.print()}else{a.document.$.execCommand("Print")}}},canUndo:false,modes:{wysiwyg:!(CKEDITOR.env.opera)}};CKEDITOR.plugins.add("removeformat",{requires:["selection"],init:function(a){a.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat);a.ui.addButton("RemoveFormat",{label:a.lang.removeFormat,command:"removeFormat"});a._.removeFormat={filters:[]}}});CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(m){var l=m._.removeFormatRegex||(m._.removeFormatRegex=new RegExp("^(?:"+m.config.removeFormatTags.replace(/,/g,"|")+")$","i"));var o=m._.removeAttributes||(m._.removeAttributes=m.config.removeFormatAttributes.split(","));var c=CKEDITOR.plugins.removeformat.filter;var a=m.getSelection().getRanges(1),h=a.createIterator(),j;while((j=h.getNextRange())){if(j.collapsed){continue}j.enlarge(CKEDITOR.ENLARGE_ELEMENT);var n=j.createBookmark();var d=n.startNode,k=n.endNode;var g=function(s){var u=new CKEDITOR.dom.elementPath(s),p=u.elements;for(var q=1,r;r=p[q];q++){if(r.equals(u.block)||r.equals(u.blockLimit)){break}if(l.test(r.getName())&&c(m,r)){s.breakParent(r)}}};g(d);g(k);var b=d.getNextSourceNode(true,CKEDITOR.NODE_ELEMENT);while(b){if(b.equals(k)){break}var f=b.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT);if(!(b.getName()=="img"&&b.data("cke-realelement"))&&c(m,b)){if(l.test(b.getName())){b.remove(1)}else{b.removeAttributes(o);m.fire("removeFormatCleanup",b)}}b=f}j.moveToBookmark(n)}m.getSelection().selectRanges(a)}}},filter:function(c,b){var d=c._.removeFormat.filters;for(var a=0;a<d.length;a++){if(d[a](b)===false){return false}}return true}};CKEDITOR.editor.prototype.addRemoveFormatFilter=function(a){this._.removeFormat.filters.push(a)};CKEDITOR.config.removeFormatTags="b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var";CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign";CKEDITOR.plugins.add("resize",{init:function(d){var c=d.config;!c.resize_dir&&(c.resize_dir="both");(c.resize_maxWidth==undefined)&&(c.resize_maxWidth=3000);(c.resize_maxHeight==undefined)&&(c.resize_maxHeight=3000);(c.resize_minWidth==undefined)&&(c.resize_minWidth=750);(c.resize_minHeight==undefined)&&(c.resize_minHeight=250);if(c.resize_enabled!==false){var b=null,j,l,g=(c.resize_dir=="both"||c.resize_dir=="horizontal")&&(c.resize_minWidth!=c.resize_maxWidth),a=(c.resize_dir=="both"||c.resize_dir=="vertical")&&(c.resize_minHeight!=c.resize_maxHeight);function f(o){var p=o.data.$.screenX-j.x,n=o.data.$.screenY-j.y,r=l.width,m=l.height,q=r+p*(d.lang.dir=="rtl"?-1:1),s=m+n;if(g){r=Math.max(c.resize_minWidth,Math.min(q,c.resize_maxWidth))}if(a){m=Math.max(c.resize_minHeight,Math.min(s,c.resize_maxHeight))}d.resize(r,m)}function k(m){CKEDITOR.document.removeListener("mousemove",f);CKEDITOR.document.removeListener("mouseup",k);if(d.document){d.document.removeListener("mousemove",f);d.document.removeListener("mouseup",k)}}var h=CKEDITOR.tools.addFunction(function(m){if(!b){b=d.getResizable()}l={width:b.$.offsetWidth||0,height:b.$.offsetHeight||0};j={x:m.screenX,y:m.screenY};c.resize_minWidth>l.width&&(c.resize_minWidth=l.width);c.resize_minHeight>l.height&&(c.resize_minHeight=l.height);CKEDITOR.document.on("mousemove",f);CKEDITOR.document.on("mouseup",k);if(d.document){d.document.on("mousemove",f);d.document.on("mouseup",k)}});d.on("destroy",function(){CKEDITOR.tools.removeFunction(h)});d.on("themeSpace",function(m){if(m.data.space=="bottom"){var n="";if(g&&!a){n=" cke_resizer_horizontal"}if(!g&&a){n=" cke_resizer_vertical"}m.data.html+='<div class="cke_resizer'+n+'" title="'+CKEDITOR.tools.htmlEncode(d.lang.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+h+', event)"></div>'}},d,null,100)}}});CKEDITOR.plugins.add("smiley",{requires:["dialog"],init:function(a){a.config.smiley_path=a.config.smiley_path||(this.path+"images/");a.addCommand("smiley",new CKEDITOR.dialogCommand("smiley"));a.ui.addButton("Smiley",{label:a.lang.smiley.toolbar,command:"smiley"});CKEDITOR.dialog.add("smiley",this.path+"dialogs/smiley.js")}});CKEDITOR.config.smiley_images=["regular_smile.gif","sad_smile.gif","wink_smile.gif","teeth_smile.gif","confused_smile.gif","tounge_smile.gif","embaressed_smile.gif","omg_smile.gif","whatchutalkingabout_smile.gif","angry_smile.gif","angel_smile.gif","shades_smile.gif","devil_smile.gif","cry_smile.gif","lightbulb.gif","thumbs_down.gif","thumbs_up.gif","heart.gif","broken_heart.gif","kiss.gif","envelope.gif"];CKEDITOR.config.smiley_descriptions=["smiley","sad","wink","laugh","frown","cheeky","blush","surprise","indecision","angry","angel","cool","devil","crying","enlightened","no","yes","heart","broken heart","kiss","mail"];(function(){var f=".%2 p,.%2 div,.%2 pre,.%2 address,.%2 blockquote,.%2 h1,.%2 h2,.%2 h3,.%2 h4,.%2 h5,.%2 h6{background-repeat: no-repeat;background-position: top %3;border: 1px dotted gray;padding-top: 8px;padding-%3: 8px;}.%2 p{%1p.png);}.%2 div{%1div.png);}.%2 pre{%1pre.png);}.%2 address{%1address.png);}.%2 blockquote{%1blockquote.png);}.%2 h1{%1h1.png);}.%2 h2{%1h2.png);}.%2 h3{%1h3.png);}.%2 h4{%1h4.png);}.%2 h5{%1h5.png);}.%2 h6{%1h6.png);}";var a=/%1/g,b=/%2/g,d=/%3/g;var c={preserveState:true,editorFocus:false,exec:function(g){this.toggleState();this.refresh(g)},refresh:function(g){var h=(this.state==CKEDITOR.TRISTATE_ON)?"addClass":"removeClass";g.document.getBody()[h]("cke_show_blocks")}};CKEDITOR.plugins.add("showblocks",{requires:["wysiwygarea"],init:function(g){var h=g.addCommand("showblocks",c);h.canUndo=false;if(g.config.startupOutlineBlocks){h.setState(CKEDITOR.TRISTATE_ON)}g.addCss(f.replace(a,"background-image: url("+CKEDITOR.getUrl(this.path)+"images/block_").replace(b,"cke_show_blocks ").replace(d,g.lang.dir=="rtl"?"right":"left"));g.ui.addButton("ShowBlocks",{label:g.lang.showBlocks,command:"showblocks"});g.on("mode",function(){if(h.state!=CKEDITOR.TRISTATE_DISABLED){h.refresh(g)}});g.on("contentDom",function(){if(h.state!=CKEDITOR.TRISTATE_DISABLED){h.refresh(g)}})}})})();(function(){var a="cke_show_border",b,d=(CKEDITOR.env.ie6Compat?[".%1 table.%2,",".%1 table.%2 td, .%1 table.%2 th,","{","border : #d3d3d3 1px dotted","}"]:[".%1 table.%2,",".%1 table.%2 > tr > td, .%1 table.%2 > tr > th,",".%1 table.%2 > tbody > tr > td, .%1 table.%2 > tbody > tr > th,",".%1 table.%2 > thead > tr > td, .%1 table.%2 > thead > tr > th,",".%1 table.%2 > tfoot > tr > td, .%1 table.%2 > tfoot > tr > th","{","border : #d3d3d3 1px dotted","}"]).join("");b=d.replace(/%2/g,a).replace(/%1/g,"cke_show_borders ");var c={preserveState:true,editorFocus:false,exec:function(f){this.toggleState();this.refresh(f)},refresh:function(f){var g=(this.state==CKEDITOR.TRISTATE_ON)?"addClass":"removeClass";f.document.getBody()[g]("cke_show_borders")}};CKEDITOR.plugins.add("showborders",{requires:["wysiwygarea"],modes:{wysiwyg:1},init:function(f){var g=f.addCommand("showborders",c);g.canUndo=false;if(f.config.startupShowBorders!==false){g.setState(CKEDITOR.TRISTATE_ON)}f.addCss(b);f.on("mode",function(){if(g.state!=CKEDITOR.TRISTATE_DISABLED){g.refresh(f)}},null,null,100);f.on("contentDom",function(){if(g.state!=CKEDITOR.TRISTATE_DISABLED){g.refresh(f)}});f.on("removeFormatCleanup",function(h){var j=h.data;if(f.getCommand("showborders").state==CKEDITOR.TRISTATE_ON&&j.is("table")&&(!j.hasAttribute("border")||parseInt(j.getAttribute("border"),10)<=0)){j.addClass(a)}})},afterInit:function(g){var f=g.dataProcessor,h=f&&f.dataFilter,j=f&&f.htmlFilter;if(h){h.addRules({elements:{table:function(n){var l=n.attributes,k=l["class"],m=parseInt(l.border,10);if(!m||m<=0){l["class"]=(k||"")+" "+a}}}})}if(j){j.addRules({elements:{table:function(m){var l=m.attributes,k=l["class"];k&&(l["class"]=k.replace(a,"").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}}});CKEDITOR.on("dialogDefinition",function(j){var k=j.data.name;if(k=="table"||k=="tableProperties"){var n=j.data.definition,h=n.getContents("info"),g=h.get("txtBorder"),f=g.commit;g.commit=CKEDITOR.tools.override(f,function(o){return function(r,p){o.apply(this,arguments);var q=parseInt(this.getValue(),10);p[(!q||q<=0)?"addClass":"removeClass"](a)}});var m=n.getContents("advanced"),l=m&&m.get("advCSSClasses");if(l){l.setup=CKEDITOR.tools.override(l.setup,function(o){return function(){o.apply(this,arguments);this.setValue(this.getValue().replace(/cke_show_border/,""))}});l.commit=CKEDITOR.tools.override(l.commit,function(o){return function(q,p){o.apply(this,arguments);if(!parseInt(p.getAttribute("border"),10)){p.addClass("cke_show_border")}}})}}})})();CKEDITOR.plugins.add("sourcearea",{requires:["editingblock"],init:function(a){var c=CKEDITOR.plugins.sourcearea,b=CKEDITOR.document.getWindow();a.on("editingBlockReady",function(){var d,f;a.addMode("source",{load:function(h,k){if(CKEDITOR.env.ie&&CKEDITOR.env.version<8){h.setStyle("position","relative")}a.textarea=d=new CKEDITOR.dom.element("textarea");d.setAttributes({dir:"ltr",tabIndex:CKEDITOR.env.webkit?-1:a.tabIndex,role:"textbox","aria-label":a.lang.editorTitle.replace("%1",a.name)});d.addClass("cke_source");d.addClass("cke_enable_context_menu");var j={width:CKEDITOR.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left"};if(CKEDITOR.env.ie){f=function(){d.hide();d.setStyle("height",h.$.clientHeight+"px");d.setStyle("width",h.$.clientWidth+"px");d.show()};a.on("resize",f);b.on("resize",f);setTimeout(f,0)}h.setHtml("");h.append(d);d.setStyles(j);a.fire("ariaWidget",d);d.on("blur",function(){a.focusManager.blur()});d.on("focus",function(){a.focusManager.focus()});a.mayBeDirty=true;this.loadData(k);var g=a.keystrokeHandler;if(g){g.attach(d)}setTimeout(function(){a.mode="source";a.fire("mode")},(CKEDITOR.env.gecko||CKEDITOR.env.webkit)?100:0)},loadData:function(g){d.setValue(g);a.fire("dataReady")},getData:function(){return d.getValue()},getSnapshotData:function(){return d.getValue()},unload:function(g){d.clearCustomData();a.textarea=d=null;if(f){a.removeListener("resize",f);b.removeListener("resize",f)}if(CKEDITOR.env.ie&&CKEDITOR.env.version<8){g.removeStyle("position")}},focus:function(){d.focus()}})});a.addCommand("source",c.commands.source);if(a.ui.addButton){a.ui.addButton("Source",{label:a.lang.source,command:"source"})}a.on("mode",function(){a.getCommand("source").setState(a.mode=="source"?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)})}});CKEDITOR.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},editorFocus:false,exec:function(a){if(a.mode=="wysiwyg"){a.fire("saveSnapshot")}a.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED);a.setMode(a.mode=="source"?"wysiwyg":"source")},canUndo:false}}};(function(){CKEDITOR.plugins.add("stylescombo",{requires:["richcombo","styles"],init:function(f){var d=f.config,h=f.lang.stylesCombo,g={},c=[];function b(j){f.getStylesSet(function(p){if(!c.length){var n,l;for(var k=0,o=p.length;k<o;k++){var m=p[k];l=m.name;n=g[l]=new CKEDITOR.style(m);n._name=l;n._.enterMode=d.enterMode;c.push(n)}c.sort(a)}j&&j()})}f.ui.addRichCombo("Styles",{label:h.label,title:h.panelTitle,className:"cke_styles",panel:{css:f.skin.editor.css.concat(d.contentsCss),multiSelect:true,attributes:{"aria-label":h.panelTitle}},init:function(){var j=this;b(function(){var o,l;var n;for(var k=0,p=c.length;k<p;k++){o=c[k];l=o._name;var m=o.type;if(m!=n){j.startGroup(h["panelTitle"+String(m)]);n=m}j.add(l,o.type==CKEDITOR.STYLE_OBJECT?l:o.buildPreview(),l)}j.commit();j.onOpen()})},onClick:function(m){f.focus();f.fire("saveSnapshot");var l=g[m],k=f.getSelection();var j=new CKEDITOR.dom.elementPath(k.getStartElement());if(l.type==CKEDITOR.STYLE_INLINE&&l.checkActive(j)){l.remove(f.document)}else{if(l.type==CKEDITOR.STYLE_OBJECT&&l.checkActive(j)){l.remove(f.document)}else{l.apply(f.document)}}f.fire("saveSnapshot")},onRender:function(){f.on("selectionChange",function(o){var m=this.getValue();var l=o.data.path,q=l.elements;for(var k=0,n=q.length,j;k<n;k++){j=q[k];for(var p in g){if(g[p].checkElementRemovable(j,true)){if(p!=m){this.setValue(p)}return}}}this.setValue("")},this)},onOpen:function(){if(CKEDITOR.env.ie||CKEDITOR.env.webkit){f.focus()}var p=f.getSelection(),l=p.getSelectedElement(),o=new CKEDITOR.dom.elementPath(l||p.getStartElement());var j=[0,0,0,0];this.showAll();this.unmarkAll();for(var k in g){var n=g[k],m=n.type;if(n.checkActive(o)){this.mark(k)}else{if(m==CKEDITOR.STYLE_OBJECT&&!n.checkApplicable(o)){this.hideItem(k);j[m]--}}j[m]++}if(!j[CKEDITOR.STYLE_BLOCK]){this.hideGroup(h["panelTitle"+String(CKEDITOR.STYLE_BLOCK)])}if(!j[CKEDITOR.STYLE_INLINE]){this.hideGroup(h["panelTitle"+String(CKEDITOR.STYLE_INLINE)])}if(!j[CKEDITOR.STYLE_OBJECT]){this.hideGroup(h["panelTitle"+String(CKEDITOR.STYLE_OBJECT)])}}});f.on("instanceReady",function(){b()})}});function a(c,b){var f=c.type,d=b.type;return f==d?0:f==CKEDITOR.STYLE_OBJECT?-1:d==CKEDITOR.STYLE_OBJECT?1:d==CKEDITOR.STYLE_BLOCK?1:-1}})();CKEDITOR.plugins.add("table",{init:function(a){var b=CKEDITOR.plugins.table,c=a.lang.table;a.addCommand("table",new CKEDITOR.dialogCommand("table"));a.addCommand("tableProperties",new CKEDITOR.dialogCommand("tableProperties"));a.ui.addButton("Table",{label:c.toolbar,command:"table"});CKEDITOR.dialog.add("table",this.path+"dialogs/table.js");CKEDITOR.dialog.add("tableProperties",this.path+"dialogs/table.js");if(a.addMenuItems){a.addMenuItems({table:{label:c.menu,command:"tableProperties",group:"table",order:5},tabledelete:{label:c.deleteTable,command:"tableDelete",group:"table",order:1}})}a.on("doubleclick",function(d){var f=d.data.element;if(f.is("table")){d.data.dialog="tableProperties"}});if(a.contextMenu){a.contextMenu.addListener(function(d,f){if(!d||d.isReadOnly()){return null}var g=d.hasAscendant("table",1);if(g){return{tabledelete:CKEDITOR.TRISTATE_OFF,table:CKEDITOR.TRISTATE_OFF}}return null})}}});(function(){function g(y,x){if(CKEDITOR.env.ie){y.removeAttribute(x)}else{delete y[x]}}var b=/^(?:td|th)$/;function v(I){var B=I.createBookmarks();var y=I.getRanges();var z=[];var J={};function G(K){if(z.length>0){return}if(K.type==CKEDITOR.NODE_ELEMENT&&b.test(K.getName())&&!K.getCustomData("selected_cell")){CKEDITOR.dom.element.setMarker(J,K,"selected_cell",true);z.push(K)}}for(var E=0;E<y.length;E++){var F=y[E];if(F.collapsed){var A=F.getCommonAncestor();var D=A.getAscendant("td",true)||A.getAscendant("th",true);if(D){z.push(D)}}else{var x=new CKEDITOR.dom.walker(F);var C;x.guard=G;while((C=x.next())){var H=C.getParent();if(H&&b.test(H.getName())&&!H.getCustomData("selected_cell")){CKEDITOR.dom.element.setMarker(J,H,"selected_cell",true);z.push(H)}}}}CKEDITOR.dom.element.clearAllMarkers(J);I.selectBookmarks(B);return z}function w(y){var z=0,A=y.length-1,C={},x,D,B;while((x=y[z++])){CKEDITOR.dom.element.setMarker(C,x,"delete_cell",true)}z=0;while((x=y[z++])){if((D=x.getPrevious())&&!D.getCustomData("delete_cell")||(D=x.getNext())&&!D.getCustomData("delete_cell")){CKEDITOR.dom.element.clearAllMarkers(C);return D}}CKEDITOR.dom.element.clearAllMarkers(C);B=y[0].getParent();if((B=B.getPrevious())){return B.getLast()}B=y[A].getParent();if((B=B.getNext())){return B.getChild(0)}return null}function d(z){var x=z.cells;for(var y=0;y<x.length;y++){x[y].innerHTML="";if(!CKEDITOR.env.ie){(new CKEDITOR.dom.element(x[y])).appendBogus()}}}function a(z,y){var A=z.getStartElement().getAscendant("tr");if(!A){return}var x=A.clone(1);y?x.insertBefore(A):x.insertAfter(A);d(x.$)}function c(z){if(z instanceof CKEDITOR.dom.selection){var H=v(z),y=H.length,F=[],x,B,E;for(var A=0;A<y;A++){var J=H[A].getParent(),D=J.$.rowIndex;!A&&(B=D-1);F[D]=J;A==y-1&&(E=D+1)}var G=J.getAscendant("table"),I=G.$.rows,C=I.length;x=new CKEDITOR.dom.element(E<C&&G.$.rows[E]||B>0&&G.$.rows[B]||G.$.parentNode);for(A=F.length;A>=0;A--){if(F[A]){c(F[A])}}return x}else{if(z instanceof CKEDITOR.dom.element){G=z.getAscendant("table");if(G.$.rows.length==1){G.remove()}else{z.remove()}}}return 0}function p(C,y){var D=C.getStartElement();var E=D.getAscendant("td",1)||D.getAscendant("th",1);if(!E){return}var F=E.getAscendant("table");var A=E.$.cellIndex;for(var x=0;x<F.$.rows.length;x++){var z=F.$.rows[x];if(z.cells.length<(A+1)){continue}E=(new CKEDITOR.dom.element(z.cells[A])).clone(0);if(!CKEDITOR.env.ie){E.appendBogus()}var B=new CKEDITOR.dom.element(z.cells[A]);if(y){E.insertBefore(B)}else{E.insertAfter(B)}}}function u(A){var z=[],D=A[0]&&A[0].getAscendant("table"),B,C,y,x;for(B=0,C=A.length;B<C;B++){z.push(A[B].$.cellIndex)}z.sort();for(B=1,C=z.length;B<C;B++){if(z[B]-z[B-1]>1){y=z[B-1]+1;break}}if(!y){y=z[0]>0?(z[0]-1):(z[z.length-1]+1)}var E=D.$.rows;for(B=0,C=E.length;B<C;B++){x=E[B].cells[y];if(x){break}}return x?new CKEDITOR.dom.element(x):D.getPrevious()}function k(z){if(z instanceof CKEDITOR.dom.selection){var D=v(z),A=u(D);for(var y=D.length-1;y>=0;y--){if(D[y]){k(D[y])}}return A}else{if(z instanceof CKEDITOR.dom.element){var B=z.getAscendant("table");if(!B){return null}var x=z.$.cellIndex;for(y=B.$.rows.length-1;y>=0;y--){var C=new CKEDITOR.dom.element(B.$.rows[y]);if(!x&&C.$.cells.length==1){c(C);continue}if(C.$.cells[x]){C.$.removeChild(C.$.cells[x])}}}}return null}function m(A,y){var z=A.getStartElement();var x=z.getAscendant("td",1)||z.getAscendant("th",1);if(!x){return}var B=x.clone();if(!CKEDITOR.env.ie){B.appendBogus()}if(y){B.insertBefore(x)}else{B.insertAfter(x)}}function o(A){if(A instanceof CKEDITOR.dom.selection){var x=v(A);var B=x[0]&&x[0].getAscendant("table");var y=w(x);for(var z=x.length-1;z>=0;z--){o(x[z])}if(y){h(y,true)}else{if(B){B.remove()}}}else{if(A instanceof CKEDITOR.dom.element){var C=A.getParent();if(C.getChildCount()==1){C.remove()}else{A.remove()}}}}function j(x){var y=x.getBogus();y&&y.remove();x.trim()}function h(x,z){var y=new CKEDITOR.dom.range(x.getDocument());if(!y["moveToElementEdit"+(z?"End":"Start")](x)){y.selectNodeContents(x);y.collapse(z?false:true)}y.select(true)}function s(B,A,x){var y=B[A];if(typeof x=="undefined"){return y}for(var z=0;y&&z<y.length;z++){if(x.is&&y[z]==x.$){return z}else{if(z==x){return new CKEDITOR.dom.element(y[z])}}}return x.is?-1:null}function q(C,y,x){var A=[];for(var z=0;z<C.length;z++){var B=C[z];if(typeof x=="undefined"){A.push(B[y])}else{if(x.is&&B[y]==x.$){return z}else{if(z==x){return new CKEDITOR.dom.element(B[y])}}}}return(typeof x=="undefined")?A:x.is?-1:null}function n(ab,J,M){var F=v(ab);var H;if((J?F.length!=1:F.length<2)||(H=ab.getCommonAncestor())&&H.type==CKEDITOR.NODE_ELEMENT&&H.is("table")){return false}var A,C=F[0],W=C.getAscendant("table"),Y=CKEDITOR.tools.buildTableMap(W),T=Y.length,V=Y[0].length,x=C.getParent().$.rowIndex,G=s(Y,x,C);if(J){var R;try{R=Y[J=="up"?(x-1):J=="down"?(x+1):x][J=="left"?(G-1):J=="right"?(G+1):G]}catch(Z){return false}if(!R||C.$==R){return false}F[(J=="up"||J=="left")?"unshift":"push"](new CKEDITOR.dom.element(R))}var ac=C.getDocument(),B=x,aa=0,D=0,z=!M&&new CKEDITOR.dom.documentFragment(ac),X=0;for(var U=0;U<F.length;U++){A=F[U];var y=A.getParent(),L=A.getFirst(),K=A.$.colSpan,E=A.$.rowSpan,O=y.$.rowIndex,Q=s(Y,O,A);X+=K*E;D=Math.max(D,Q-G+K);aa=Math.max(aa,O-x+E);if(!M){if(j(A),A.getChildren().count()){if(O!=B&&L&&!(L.isBlockBoundary&&L.isBlockBoundary({br:1}))){var N=z.getLast(CKEDITOR.dom.walker.whitespaces(true));if(N&&!(N.is&&N.is("br"))){z.append(new CKEDITOR.dom.element("br"))}}A.moveChildren(z)}U?A.remove():A.setHtml("")}B=O}if(!M){z.moveChildren(C);if(!CKEDITOR.env.ie){C.appendBogus()}if(D>=V){C.removeAttribute("rowSpan")}else{C.$.rowSpan=aa}if(aa>=T){C.removeAttribute("colSpan")}else{C.$.colSpan=D}var P=new CKEDITOR.dom.nodeList(W.$.rows),I=P.count();for(U=I-1;U>=0;U--){var S=P.getItem(U);if(!S.$.cells.length){S.remove();I++;continue}}return C}else{return(aa*D)==X}}function f(Q,E){var z=v(Q);if(z.length>1){return false}else{if(E){return true}}var y=z[0],x=y.getParent(),M=x.getAscendant("table"),P=CKEDITOR.tools.buildTableMap(M),G=x.$.rowIndex,J=s(P,G,y),A=y.$.rowSpan,I,C,B,K;if(A>1){C=Math.ceil(A/2);B=Math.floor(A/2);K=G+C;var H=new CKEDITOR.dom.element(M.$.rows[K]),N=s(P,K),D;I=y.clone();for(var O=0;O<N.length;O++){D=N[O];if(D.parentNode==H.$&&O>J){I.insertBefore(new CKEDITOR.dom.element(D));break}else{D=null}}if(!D){H.append(I,true)}}else{B=C=1;H=x.clone();H.insertAfter(x);H.append(I=y.clone());var F=s(P,G);for(var L=0;L<F.length;L++){F[L].rowSpan++}}if(!CKEDITOR.env.ie){I.appendBogus()}y.$.rowSpan=C;I.$.rowSpan=B;if(C==1){y.removeAttribute("rowSpan")}if(B==1){I.removeAttribute("rowSpan")}return I}function r(G,E){var L=v(G);if(L.length>1){return false}else{if(E){return true}}var I=L[0],D=I.getParent(),K=D.getAscendant("table"),x=CKEDITOR.tools.buildTableMap(K),F=D.$.rowIndex,H=s(x,F,I),A=I.$.colSpan,z,C,J;if(A>1){C=Math.ceil(A/2);J=Math.floor(A/2)}else{J=C=1;var B=q(x,H);for(var y=0;y<B.length;y++){B[y].colSpan++}}z=I.clone();z.insertAfter(I);if(!CKEDITOR.env.ie){z.appendBogus()}I.$.colSpan=C;z.$.colSpan=J;if(C==1){I.removeAttribute("colSpan")}if(J==1){z.removeAttribute("colSpan")}return z}var l={thead:1,tbody:1,tfoot:1,td:1,tr:1,th:1};CKEDITOR.plugins.tabletools={init:function(x){var y=x.lang.table;x.addCommand("cellProperties",new CKEDITOR.dialogCommand("cellProperties"));CKEDITOR.dialog.add("cellProperties",this.path+"dialogs/tableCell.js");x.addCommand("tableDelete",{exec:function(D){var C=D.getSelection(),B=C&&C.getStartElement(),E=B&&B.getAscendant("table",1);if(!E){return}C.selectElement(E);var z=C.getRanges()[0];z.collapse();C.selectRanges([z]);var A=E.getParent();if(A.getChildCount()==1&&!A.is("body","td","th")){A.remove()}else{E.remove()}}});x.addCommand("rowDelete",{exec:function(A){var z=A.getSelection();h(c(z))}});x.addCommand("rowInsertBefore",{exec:function(A){var z=A.getSelection();a(z,true)}});x.addCommand("rowInsertAfter",{exec:function(A){var z=A.getSelection();a(z)}});x.addCommand("columnDelete",{exec:function(B){var A=B.getSelection();var z=k(A);z&&h(z,true)}});x.addCommand("columnInsertBefore",{exec:function(A){var z=A.getSelection();p(z,true)}});x.addCommand("columnInsertAfter",{exec:function(A){var z=A.getSelection();p(z)}});x.addCommand("cellDelete",{exec:function(A){var z=A.getSelection();o(z)}});x.addCommand("cellMerge",{exec:function(z){h(n(z.getSelection()),true)}});x.addCommand("cellMergeRight",{exec:function(z){h(n(z.getSelection(),"right"),true)}});x.addCommand("cellMergeDown",{exec:function(z){h(n(z.getSelection(),"down"),true)}});x.addCommand("cellVerticalSplit",{exec:function(z){h(f(z.getSelection()))}});x.addCommand("cellHorizontalSplit",{exec:function(z){h(r(z.getSelection()))}});x.addCommand("cellInsertBefore",{exec:function(A){var z=A.getSelection();m(z,true)}});x.addCommand("cellInsertAfter",{exec:function(A){var z=A.getSelection();m(z)}});if(x.addMenuItems){x.addMenuItems({tablecell:{label:y.cell.menu,group:"tablecell",order:1,getItems:function(){var A=x.getSelection(),z=v(A);return{tablecell_insertBefore:CKEDITOR.TRISTATE_OFF,tablecell_insertAfter:CKEDITOR.TRISTATE_OFF,tablecell_delete:CKEDITOR.TRISTATE_OFF,tablecell_merge:n(A,null,true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_right:n(A,"right",true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_down:n(A,"down",true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_vertical:f(A,true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_horizontal:r(A,true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_properties:z.length>0?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}},tablecell_insertBefore:{label:y.cell.insertBefore,group:"tablecell",command:"cellInsertBefore",order:5},tablecell_insertAfter:{label:y.cell.insertAfter,group:"tablecell",command:"cellInsertAfter",order:10},tablecell_delete:{label:y.cell.deleteCell,group:"tablecell",command:"cellDelete",order:15},tablecell_merge:{label:y.cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_merge_right:{label:y.cell.mergeRight,group:"tablecell",command:"cellMergeRight",order:17},tablecell_merge_down:{label:y.cell.mergeDown,group:"tablecell",command:"cellMergeDown",order:18},tablecell_split_horizontal:{label:y.cell.splitHorizontal,group:"tablecell",command:"cellHorizontalSplit",order:19},tablecell_split_vertical:{label:y.cell.splitVertical,group:"tablecell",command:"cellVerticalSplit",order:20},tablecell_properties:{label:y.cell.title,group:"tablecellproperties",command:"cellProperties",order:21},tablerow:{label:y.row.menu,group:"tablerow",order:1,getItems:function(){return{tablerow_insertBefore:CKEDITOR.TRISTATE_OFF,tablerow_insertAfter:CKEDITOR.TRISTATE_OFF,tablerow_delete:CKEDITOR.TRISTATE_OFF}}},tablerow_insertBefore:{label:y.row.insertBefore,group:"tablerow",command:"rowInsertBefore",order:5},tablerow_insertAfter:{label:y.row.insertAfter,group:"tablerow",command:"rowInsertAfter",order:10},tablerow_delete:{label:y.row.deleteRow,group:"tablerow",command:"rowDelete",order:15},tablecolumn:{label:y.column.menu,group:"tablecolumn",order:1,getItems:function(){return{tablecolumn_insertBefore:CKEDITOR.TRISTATE_OFF,tablecolumn_insertAfter:CKEDITOR.TRISTATE_OFF,tablecolumn_delete:CKEDITOR.TRISTATE_OFF}}},tablecolumn_insertBefore:{label:y.column.insertBefore,group:"tablecolumn",command:"columnInsertBefore",order:5},tablecolumn_insertAfter:{label:y.column.insertAfter,group:"tablecolumn",command:"columnInsertAfter",order:10},tablecolumn_delete:{label:y.column.deleteColumn,group:"tablecolumn",command:"columnDelete",order:15}})}if(x.contextMenu){x.contextMenu.addListener(function(z,A){if(!z||z.isReadOnly()){return null}while(z){if(z.getName() in l){return{tablecell:CKEDITOR.TRISTATE_OFF,tablerow:CKEDITOR.TRISTATE_OFF,tablecolumn:CKEDITOR.TRISTATE_OFF}}z=z.getParent()}return null})}},getSelectedCells:v};CKEDITOR.plugins.add("tabletools",CKEDITOR.plugins.tabletools)})();CKEDITOR.tools.buildTableMap=function(p){var o=p.$.rows;var a=-1;var n=[];for(var g=0;g<o.length;g++){a++;!n[a]&&(n[a]=[]);var m=-1;for(var f=0;f<o[g].cells.length;f++){var l=o[g].cells[f];m++;while(n[a][m]){m++}var d=isNaN(l.colSpan)?1:l.colSpan;var h=isNaN(l.rowSpan)?1:l.rowSpan;for(var b=0;b<h;b++){if(!n[a+b]){n[a+b]=[]}for(var k=0;k<d;k++){n[a+b][m+k]=o[g].cells[f]}}m+=d-1}}return n};CKEDITOR.plugins.add("specialchar",{availableLangs:{en:1},init:function(a){var c="specialchar",b=this;CKEDITOR.dialog.add(c,this.path+"dialogs/specialchar.js");a.addCommand(c,{exec:function(){var d=a.langCode;d=b.availableLangs[d]?d:"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(b.path+"lang/"+d+".js"),function(){CKEDITOR.tools.extend(a.lang.specialChar,b.lang[d]);a.openDialog(c)})},modes:{wysiwyg:1},canUndo:false});a.ui.addButton("SpecialChar",{label:a.lang.specialChar.toolbar,command:c})}});CKEDITOR.config.specialChars=["!","&quot;","#","$","%","&amp;","'","(",")","*","+","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","&lt;","=","&gt;","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","&euro;","&lsquo;","&rsquo;","&ldquo;","&rdquo;","&ndash;","&mdash;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&reg;","&macr;","&deg;","&","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&","&frac14;","&frac12;","&frac34;","&iquest;","&Agrave;","&Aacute;","&Acirc;","&Atilde;","&Auml;","&Aring;","&AElig;","&Ccedil;","&Egrave;","&Eacute;","&Ecirc;","&Euml;","&Igrave;","&Iacute;","&Icirc;","&Iuml;","&ETH;","&Ntilde;","&Ograve;","&Oacute;","&Ocirc;","&Otilde;","&Ouml;","&times;","&Oslash;","&Ugrave;","&Uacute;","&Ucirc;","&Uuml;","&Yacute;","&THORN;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&uuml;","&yacute;","&thorn;","&yuml;","&OElig;","&oelig;","&#372;","&#374","&#373","&#375;","&sbquo;","&#8219;","&bdquo;","&hellip;","&trade;","&#9658;","&bull;","&rarr;","&rArr;","&hArr;","&diams;","&asymp;"];(function(){var d={editorFocus:false,modes:{wysiwyg:1,source:1}};var a={exec:function(f){f.container.focusNext(true,f.tabIndex)}};var b={exec:function(f){f.container.focusPrevious(true,f.tabIndex)}};function c(f){return{editorFocus:false,canUndo:false,modes:{wysiwyg:1},exec:function(n){if(n.focusManager.hasFocus){var g=n.getSelection(),l=g.getCommonAncestor(),p;if((p=(l.getAscendant("td",true)||l.getAscendant("th",true)))){var o=new CKEDITOR.dom.range(n.document),k=CKEDITOR.tools.tryThese(function(){var v=p.getParent(),u=v.$.cells[p.$.cellIndex+(f?-1:1)];u.parentNode.parentNode;return u},function(){var w=p.getParent(),v=w.getAscendant("table"),u=v.$.rows[w.$.rowIndex+(f?-1:1)];return u.cells[f?u.cells.length-1:0]});if(!(k||f)){var r=p.getAscendant("table").$,s=p.getParent().$.cells;var q=new CKEDITOR.dom.element(r.insertRow(-1),n.document);for(var j=0,m=s.length;j<m;j++){var h=q.append(new CKEDITOR.dom.element(s[j],n.document).clone(false,false));!CKEDITOR.env.ie&&h.appendBogus()}o.moveToElementEditStart(q)}else{if(k){k=new CKEDITOR.dom.element(k);o.moveToElementEditStart(k);if(!(o.checkStartOfBlock()&&o.checkEndOfBlock())){o.selectNodeContents(k)}}else{return true}}o.select(true);return true}}return false}}}CKEDITOR.plugins.add("tab",{requires:["keystrokes"],init:function(h){var g=h.config.enableTabKeyTools!==false,j=h.config.tabSpaces||0,f="";while(j--){f+="\xa0"}if(f){h.on("key",function(k){if(k.data.keyCode==9){h.insertHtml(f);k.cancel()}})}if(g){h.on("key",function(k){if(k.data.keyCode==9&&h.execCommand("selectNextCell")||k.data.keyCode==(CKEDITOR.SHIFT+9)&&h.execCommand("selectPreviousCell")){k.cancel()}})}if(CKEDITOR.env.webkit||CKEDITOR.env.gecko){h.on("key",function(k){var l=k.data.keyCode;if(l==9&&!f){k.cancel();h.execCommand("blur")}if(l==(CKEDITOR.SHIFT+9)){h.execCommand("blurBack");k.cancel()}})}h.addCommand("blur",CKEDITOR.tools.extend(a,d));h.addCommand("blurBack",CKEDITOR.tools.extend(b,d));h.addCommand("selectNextCell",c());h.addCommand("selectPreviousCell",c(true))}})})();CKEDITOR.dom.element.prototype.focusNext=function(b,c){var f=this.$,g=(c===undefined?this.getTabIndex():c),k,j,a,h,d,l;if(g<=0){d=this.getNextSourceNode(b,CKEDITOR.NODE_ELEMENT);while(d){if(d.isVisible()&&d.getTabIndex()===0){a=d;break}d=d.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT)}}else{d=this.getDocument().getBody().getFirst();while((d=d.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT))){if(!k){if(!j&&d.equals(this)){j=true;if(b){if(!(d=d.getNextSourceNode(true,CKEDITOR.NODE_ELEMENT))){break}k=1}}else{if(j&&!this.contains(d)){k=1}}}if(!d.isVisible()||(l=d.getTabIndex())<0){continue}if(k&&l==g){a=d;break}if(l>g&&(!a||!h||l<h)){a=d;h=l}else{if(!a&&l===0){a=d;h=l}}}}if(a){a.focus()}};CKEDITOR.dom.element.prototype.focusPrevious=function(b,c){var f=this.$,g=(c===undefined?this.getTabIndex():c),k,j,a,h=0,l;var d=this.getDocument().getBody().getLast();while((d=d.getPreviousSourceNode(false,CKEDITOR.NODE_ELEMENT))){if(!k){if(!j&&d.equals(this)){j=true;if(b){if(!(d=d.getPreviousSourceNode(true,CKEDITOR.NODE_ELEMENT))){break}k=1}}else{if(j&&!this.contains(d)){k=1}}}if(!d.isVisible()||(l=d.getTabIndex())<0){continue}if(g<=0){if(k&&l===0){a=d;break}if(l>h){a=d;h=l}}else{if(k&&l==g){a=d;break}if(l<g&&(!a||l>h)){a=d;h=l}}}if(a){a.focus()}};(function(){CKEDITOR.plugins.add("templates",{requires:["dialog"],init:function(c){CKEDITOR.dialog.add("templates",CKEDITOR.getUrl(this.path+"dialogs/templates.js"));c.addCommand("templates",new CKEDITOR.dialogCommand("templates"));c.ui.addButton("Templates",{label:c.lang.templates.button,command:"templates"})}});var b={},a={};CKEDITOR.addTemplates=function(c,d){b[c]=d};CKEDITOR.getTemplates=function(c){return b[c]};CKEDITOR.loadTemplates=function(g,h){var f=[];for(var c=0,d=g.length;c<d;c++){if(!a[g[c]]){f.push(g[c]);a[g[c]]=1}}if(f.length){CKEDITOR.scriptLoader.load(f,h)}else{setTimeout(h,0)}}})();CKEDITOR.config.templates_files=[CKEDITOR.getUrl("plugins/templates/templates/default.js")];CKEDITOR.config.templates_replaceContent=true;(function(){CKEDITOR.plugins.add("undo",{requires:["selection","wysiwygarea"],init:function(j){var m=new g(j);var h=j.addCommand("undo",{exec:function(){if(m.undo()){j.selectionChange();j.fire("afterUndo")}},state:CKEDITOR.TRISTATE_DISABLED,canUndo:false});var k=j.addCommand("redo",{exec:function(){if(m.redo()){j.selectionChange();j.fire("afterRedo")}},state:CKEDITOR.TRISTATE_DISABLED,canUndo:false});m.onChange=function(){h.setState(m.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);k.setState(m.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)};function l(n){if(m.enabled&&n.data.command.canUndo!==false){m.save()}}j.on("beforeCommandExec",l);j.on("afterCommandExec",l);j.on("saveSnapshot",function(){m.save()});j.on("contentDom",function(){j.document.on("keydown",function(n){if(!n.data.$.ctrlKey&&!n.data.$.metaKey){m.type(n)}})});j.on("beforeModeUnload",function(){j.mode=="wysiwyg"&&m.save(true)});j.on("mode",function(){m.enabled=j.mode=="wysiwyg";m.onChange()});j.ui.addButton("Undo",{label:j.lang.undo,command:"undo"});j.ui.addButton("Redo",{label:j.lang.redo,command:"redo"});j.resetUndo=function(){m.reset();j.fire("saveSnapshot")};j.on("updateSnapshot",function(){if(m.currentImage&&new c(j).equals(m.currentImage)){setTimeout(function(){m.update()},0)}})}});CKEDITOR.plugins.undo={};var c=CKEDITOR.plugins.undo.Image=function(j){this.editor=j;j.fire("beforeCreateUndoSnapshot");var k=j.getSnapshot(),h=k&&j.getSelection();CKEDITOR.env.ie&&k&&(k=k.replace(/\s+data-cke-expando=".*?"/g,""));this.contents=k;this.bookmarks=h&&h.createBookmarks2(true);j.fire("afterCreateUndoSnapshot")};var f=/\b(?:href|src|name)="[^"]*?"/gi;c.prototype={equals:function(q,l){var o=this.contents,p=q.contents;if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)){o=o.replace(f,"");p=p.replace(f,"")}if(o!=p){return false}if(l){return true}var j=this.bookmarks,h=q.bookmarks;if(j||h){if(!j||!h||j.length!=h.length){return false}for(var n=0;n<j.length;n++){var m=j[n],k=h[n];if(m.startOffset!=k.startOffset||m.endOffset!=k.endOffset||!CKEDITOR.tools.arrayCompare(m.start,k.start)||!CKEDITOR.tools.arrayCompare(m.end,k.end)){return false}}}return true}};function g(h){this.editor=h;this.reset()}var b={8:1,46:1},d={16:1,17:1,18:1},a={37:1,38:1,39:1,40:1};g.prototype={type:function(l){var q=l&&l.data.getKey(),h=q in d,m=q in b,r=this.lastKeystroke in b,s=m&&q==this.lastKeystroke,p=q in a,u=this.lastKeystroke in a,k=(!m&&!p),j=(m&&!s),o=!(h||this.typing)||(k&&(r||u));if(o||j){var n=new c(this.editor);CKEDITOR.tools.setTimeout(function(){var v=this.editor.getSnapshot();if(CKEDITOR.env.ie){v=v.replace(/\s+data-cke-expando=".*?"/g,"")}if(n.contents!=v){this.typing=true;if(!this.save(false,n,false)){this.snapshots.splice(this.index+1,this.snapshots.length-this.index-1)}this.hasUndo=true;this.hasRedo=false;this.typesCount=1;this.modifiersCount=1;this.onChange()}},0,this)}this.lastKeystroke=q;if(m){this.typesCount=0;this.modifiersCount++;if(this.modifiersCount>25){this.save(false,null,false);this.modifiersCount=1}}else{if(!p){this.modifiersCount=0;this.typesCount++;if(this.typesCount>25){this.save(false,null,false);this.typesCount=1}}}},reset:function(){this.lastKeystroke=0;this.snapshots=[];this.index=-1;this.limit=this.editor.config.undoStackSize||20;this.currentImage=null;this.hasUndo=false;this.hasRedo=false;this.resetType()},resetType:function(){this.typing=false;delete this.lastKeystroke;this.typesCount=0;this.modifiersCount=0},fireChange:function(){this.hasUndo=!!this.getNextImage(true);this.hasRedo=!!this.getNextImage(false);this.resetType();this.onChange()},save:function(h,k,l){var j=this.snapshots;if(!k){k=new c(this.editor)}if(k.contents===false){return false}if(this.currentImage&&k.equals(this.currentImage,h)){return false}j.splice(this.index+1,j.length-this.index-1);if(j.length==this.limit){j.shift()}this.index=j.push(k)-1;this.currentImage=k;if(l!==false){this.fireChange()}return true},restoreImage:function(h){this.editor.loadSnapshot(h.contents);if(h.bookmarks){this.editor.getSelection().selectBookmarks(h.bookmarks)}else{if(CKEDITOR.env.ie){var j=this.editor.document.getBody().$.createTextRange();j.collapse(true);j.select()}}this.index=h.index;this.update();this.fireChange()},getNextImage:function(h){var l=this.snapshots,k=this.currentImage,m,j;if(k){if(h){for(j=this.index-1;j>=0;j--){m=l[j];if(!k.equals(m,true)){m.index=j;return m}}}else{for(j=this.index+1;j<l.length;j++){m=l[j];if(!k.equals(m,true)){m.index=j;return m}}}}return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(true);var h=this.getNextImage(true);if(h){return this.restoreImage(h),true}}return false},redo:function(){if(this.redoable()){this.save(true);if(this.redoable()){var h=this.getNextImage(false);if(h){return this.restoreImage(h),true}}}return false},update:function(){this.snapshots.splice(this.index,1,(this.currentImage=new c(this.editor)))}}})();(function(){var a={table:1,pre:1};var g=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi;var l=CKEDITOR.dom.walker.whitespaces(true);function r(v){return(v.getName() in a)||v.isBlockBoundary()&&CKEDITOR.dtd.$empty[v.getName()]}function n(v){if(v.getType()==CKEDITOR.SELECTION_ELEMENT){return v.getSelectedElement().isReadOnly()}else{return v.getCommonAncestor().isReadOnly()}}function f(v){return function(w){if(this.mode=="wysiwyg"){this.focus();var y=this.getSelection();if(n(y)){var z={result:true,selection:y};editor.fire("forbiddenInsertContent",z);if(z.result){return}}this.fire("saveSnapshot");var x={selection:y,ranges:y&&y.getRanges(),data:w.data};this.fire("beforeInsertContent",x);v.call(this,w.data);CKEDITOR.tools.setTimeout(function(){this.fire("afterInsertContent",x);this.fire("saveSnapshot")},0,this)}}}function k(z){if(this.dataProcessor){z=this.dataProcessor.toHtml(z)}var w=this.getSelection();if(CKEDITOR.env.ie){var y=w.isLocked;if(y){w.unlock()}var B=w.getNative();if(B.type=="Control"){B.clear()}else{if(w.getType()==CKEDITOR.SELECTION_TEXT){var v=w.getRanges()[0],x=v&&v.endContainer;if(x&&x.type==CKEDITOR.NODE_ELEMENT&&x.getAttribute("contenteditable")=="false"&&v.checkBoundaryOfElement(x,CKEDITOR.END)){v.setEndAfter(v.endContainer);v.deleteContents()}}}try{B.createRange().pasteHTML(z)}catch(A){}if(y){this.getSelection().lock()}}else{this.document.$.execCommand("inserthtml",false,z)}if(CKEDITOR.env.webkit){w=this.getSelection();w.scrollIntoView()}}function m(C){var A=this.getSelection(),y=A.getStartElement().hasAscendant("pre",true)?CKEDITOR.ENTER_BR:this.config.enterMode,z=y==CKEDITOR.ENTER_BR;var x=CKEDITOR.tools.htmlEncode(C.replace(/\r\n|\r/g,"\n"));x=x.replace(/^[ \t]+|[ \t]+$/g,function(F,H,G){if(F.length==1){return"&nbsp;"}else{if(!H){return CKEDITOR.tools.repeat("&nbsp;",F.length-1)+" "}else{return" "+CKEDITOR.tools.repeat("&nbsp;",F.length-1)}}});x=x.replace(/[ \t]{2,}/g,function(F){return CKEDITOR.tools.repeat("&nbsp;",F.length-1)+" "});var B=y==CKEDITOR.ENTER_P?"p":"div";if(!z){x=x.replace(/(\n{2})([\s\S]*?)(?:$|\1)/g,function(G,F,H){return"<"+B+">"+H+"</"+B+">"})}x=x.replace(/\n/g,"<br>");if(!(z||CKEDITOR.env.ie)){x=x.replace(new RegExp("<br>(?=</"+B+">)"),function(F){return CKEDITOR.tools.repeat(F,2)})}if(CKEDITOR.env.gecko||CKEDITOR.env.webkit){var E=new CKEDITOR.dom.elementPath(A.getStartElement()),v=[];for(var w=0;w<E.elements.length;w++){var D=E.elements[w].getName();if(D in CKEDITOR.dtd.$inline){v.unshift(E.elements[w].getOuterHtml().match(/^<.*?>/))}else{if(D in CKEDITOR.dtd.$block){break}}}x=v.join("")+x}k.call(this,x)}function o(A){var H=this.getSelection(),w=H.getRanges(),J=A.getName(),y=CKEDITOR.dtd.$block[J];var I=H.isLocked;if(I){H.unlock()}var C,G,F,E;for(var z=w.length-1;z>=0;z--){C=w[z];C.deleteContents();G=!z&&A||A.clone(1);var D,v;if(y){while((D=C.getCommonAncestor(0,1))&&(v=CKEDITOR.dtd[D.getName()])&&!(v&&v[J])){if(D.getName() in CKEDITOR.dtd.span){C.splitElement(D)}else{if(C.checkStartOfBlock()&&C.checkEndOfBlock()){C.setStartBefore(D);C.collapse(true);D.remove()}else{C.splitBlock()}}}}C.insertNode(G);if(!F){F=G}}C.moveToPosition(F,CKEDITOR.POSITION_AFTER_END);if(y){var B=F.getNext(l),x=B&&B.type==CKEDITOR.NODE_ELEMENT&&B.getName();if(x&&CKEDITOR.dtd.$block[x]&&CKEDITOR.dtd[x]["#"]){C.moveToElementEditStart(B)}}H.selectRanges([C]);if(I){this.getSelection().lock()}}function s(v){if(!v.checkDirty()){setTimeout(function(){v.resetDirty()},0)}}var q=CKEDITOR.dom.walker.whitespaces(true),p=CKEDITOR.dom.walker.bookmark(false,true);function u(v){return q(v)&&p(v)}function h(v){return v.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(v.getText()).match(/^(?:&nbsp;|\xa0)$/)}function j(v){if(v.isLocked){v.unlock();setTimeout(function(){v.lock()},0)}}function d(v){return v.getOuterHtml().match(g)}q=CKEDITOR.dom.walker.whitespaces(true);function c(D){var C=D.window,F=D.document,A=D.document.getBody(),z=A.getChildren().count();if(!z||(z==1&&A.getFirst().hasAttribute("_moz_editor_bogus_node"))){s(D);var E=D.element.getDocument();var y=E.getDocumentElement();var w=y.$.scrollTop;var x=y.$.scrollLeft;var v=F.$.createEvent("KeyEvents");v.initKeyEvent("keypress",true,true,C.$,false,false,false,false,0,32);F.$.dispatchEvent(v);if(w!=y.$.scrollTop||x!=y.$.scrollLeft){E.getWindow().$.scrollTo(x,w)}z&&A.getFirst().remove();F.getBody().appendBogus();var B=new CKEDITOR.dom.range(F);B.setStartAt(A,CKEDITOR.POSITION_AFTER_START);B.select()}}function b(H){var C=H.editor,I=H.data.path,E=I.blockLimit,G=H.data.selection,A=G.getRanges()[0],B=C.document.getBody(),F=C.config.enterMode;CKEDITOR.env.gecko&&c(C);if(F!=CKEDITOR.ENTER_BR&&A.collapsed&&E.getName()=="body"&&!I.block){C.fire("updateSnapshot");s(C);CKEDITOR.env.ie&&j(G);var x=A.fixBlock(true,C.config.enterMode==CKEDITOR.ENTER_DIV?"div":"p");if(CKEDITOR.env.ie){var z=x.getFirst(u);z&&h(z)&&z.remove()}if(d(x)){var y=x.getNext(q);if(y&&y.type==CKEDITOR.NODE_ELEMENT&&!r(y)){A.moveToElementEditStart(y);x.remove()}else{y=x.getPrevious(q);if(y&&y.type==CKEDITOR.NODE_ELEMENT&&!r(y)){A.moveToElementEditEnd(y);x.remove()}}}A.select();if(!CKEDITOR.env.ie){C.selectionChange()}}var w=new CKEDITOR.dom.range(C.document),v=new CKEDITOR.dom.walker(w);w.selectNodeContents(B);v.evaluator=function(J){return J.type==CKEDITOR.NODE_ELEMENT&&(J.getName() in a)};v.guard=function(K,J){return !((K.type==CKEDITOR.NODE_TEXT&&q(K))||J)};if(v.previous()){C.fire("updateSnapshot");s(C);CKEDITOR.env.ie&&j(G);var D;if(F!=CKEDITOR.ENTER_BR){D=B.append(new CKEDITOR.dom.element(F==CKEDITOR.ENTER_P?"p":"div"))}else{D=B}if(!CKEDITOR.env.ie){D.appendBogus()}}}CKEDITOR.plugins.add("wysiwygarea",{requires:["editingblock"],init:function(z){var C=(z.config.enterMode!=CKEDITOR.ENTER_BR)?z.config.enterMode==CKEDITOR.ENTER_DIV?"div":"p":false;var w=z.lang.editorTitle.replace("%1",z.name);var A;z.on("editingBlockReady",function(){var M,E,H,I,L,J;var F=CKEDITOR.env.isCustomDomain();var G=function(R){if(E){E.remove()}var S="document.open();"+(F?('document.domain="'+document.domain+'";'):"")+"document.close();";S=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent(S)+"}())":"";E=CKEDITOR.dom.element.createFromHtml('<iframe style="width:100%;height:100%" frameBorder="0" title="'+w+'" src="'+S+'" tabIndex="'+(CKEDITOR.env.webkit?-1:z.tabIndex)+'" allowTransparency="true"></iframe>');if(document.location.protocol=="chrome:"){CKEDITOR.event.useCapture=true}E.on("load",function(T){L=1;T.removeListener();var U=E.getFrameDocument();U.write(R);CKEDITOR.env.air&&K(U.getWindow().$)});if(document.location.protocol=="chrome:"){CKEDITOR.event.useCapture=false}var Q=z.element,P=CKEDITOR.env.gecko&&!Q.isVisible(),O={};if(P){Q.show();O={position:Q.getStyle("position"),top:Q.getStyle("top")};Q.setStyles({position:"absolute",top:"-3000px"})}M.append(E);if(P){setTimeout(function(){Q.hide();Q.setStyles(O)},1000)}};A=CKEDITOR.tools.addFunction(K);var N='<script id="cke_actscrpt" type="text/javascript" data-cke-temp="1">'+(F?('document.domain="'+document.domain+'";'):"")+"window.parent.CKEDITOR.tools.callFunction( "+A+", window );<\/script>";function K(S){if(!L){return}L=0;z.fire("ariaWidget",E);var U=S.document,P=U.body;var Q=U.getElementById("cke_actscrpt");Q&&Q.parentNode.removeChild(Q);P.spellcheck=!z.config.disableNativeSpellChecker;if(CKEDITOR.env.ie){P.hideFocus=true;P.disabled=true;P.contentEditable=true;P.removeAttribute("disabled")}else{setTimeout(function(){if(CKEDITOR.env.gecko&&CKEDITOR.env.version>=10900||CKEDITOR.env.opera){U.$.body.contentEditable=true}else{if(CKEDITOR.env.webkit){U.$.body.parentNode.contentEditable=true}else{U.$.designMode="on"}}},0)}CKEDITOR.env.gecko&&CKEDITOR.tools.setTimeout(c,0,null,z);S=z.window=new CKEDITOR.dom.window(S);U=z.document=new CKEDITOR.dom.document(U);U.on("dblclick",function(W){var X=W.data.getTarget(),Y={element:X,dialog:""};z.fire("doubleclick",Y);Y.dialog&&z.openDialog(Y.dialog)});if(!(CKEDITOR.env.ie||CKEDITOR.env.opera)){U.on("mousedown",function(W){var X=W.data.getTarget();if(X.is("img","hr","input","textarea","select")){z.getSelection().selectElement(X)}})}if(CKEDITOR.env.gecko){U.on("mouseup",function(X){if(X.data.$.button==2){var Y=X.data.getTarget();if(!Y.getOuterHtml().replace(g,"")){var W=new CKEDITOR.dom.range(U);W.moveToElementEditStart(Y);W.select(true)}}})}U.on("click",function(W){W=W.data;if(W.getTarget().is("a")&&W.$.button!=2){W.preventDefault()}});if(CKEDITOR.env.webkit){U.on("click",function(W){if(W.data.getTarget().is("input","select")){W.data.preventDefault()}});U.on("mouseup",function(W){if(W.data.getTarget().is("input","textarea")){W.data.preventDefault()}})}if(CKEDITOR.env.ie&&U.$.compatMode=="CSS1Compat"||CKEDITOR.env.opera){var T=U.getDocumentElement();T.on("mousedown",function(W){if(W.data.getTarget().equals(T)){x.focus()}})}S.on("blur",function(){z.focusManager.blur()});var R;S.on("focus",function(){var W=z.document;if(CKEDITOR.env.gecko&&CKEDITOR.env.version>=10900){y()}else{if(CKEDITOR.env.opera){W.getBody().focus()}else{if(CKEDITOR.env.webkit){if(!R){z.document.getDocumentElement().focus();R=1}}}}z.focusManager.focus()});var O=z.keystrokeHandler;if(O){O.attach(U)}if(CKEDITOR.env.ie){U.getDocumentElement().addClass(U.$.compatMode);U.on("keydown",function(W){var aa=W.data.getKeystroke();if(aa in {8:1,46:1}){var Y=z.getSelection(),Z=Y.getSelectedElement();if(Z){z.fire("saveSnapshot");var X=Y.getRanges()[0].createBookmark();Z.remove();Y.selectBookmarks([X]);z.fire("saveSnapshot");W.data.preventDefault()}}});if(U.$.compatMode=="CSS1Compat"){var V={33:1,34:1};U.on("keydown",function(W){if(W.data.getKeystroke() in V){setTimeout(function(){z.getSelection().scrollIntoView()},0)}})}}if(z.contextMenu){z.contextMenu.addTarget(U,z.config.browserContextMenuOnCtrl!==false)}setTimeout(function(){z.fire("contentDom");if(J){z.mode="wysiwyg";z.fire("mode");J=false}H=false;if(I){z.focus();I=false}setTimeout(function(){z.fire("dataReady")},0);try{z.document.$.execCommand("enableObjectResizing",false,!z.config.disableObjectResizing)}catch(W){}try{z.document.$.execCommand("enableInlineTableEditing",false,!z.config.disableNativeTableHandles)}catch(W){}if(CKEDITOR.env.ie){setTimeout(function(){if(z.document){var X=z.document.$.body;X.runtimeStyle.marginBottom="0px";X.runtimeStyle.marginBottom=""}},1000)}},0)}z.addMode("wysiwyg",{load:function(O,P,Q){M=O;if(CKEDITOR.env.ie&&CKEDITOR.env.quirks){O.setStyle("position","relative")}z.mayBeDirty=true;J=true;if(Q){this.loadSnapshotData(P)}else{this.loadData(P)}},loadData:function(S){H=true;var Q=z.config,O=Q.fullPage,T=Q.docType;var R='<style type="text/css" data-cke-temp="1">'+z._.styles.join("\n")+"</style>";!O&&(R=CKEDITOR.tools.buildStyleHtml(z.config.contentsCss)+R);var P=Q.baseHref?'<base href="'+Q.baseHref+'" data-cke-temp="1" />':"";if(O){S=S.replace(/<!DOCTYPE[^>]*>/i,function(U){z.docType=T=U;return""})}if(z.dataProcessor){S=z.dataProcessor.toHtml(S,C)}if(O){if(!(/<body[\s|>]/).test(S)){S="<body>"+S}if(!(/<html[\s|>]/).test(S)){S="<html>"+S+"</html>"}if(!(/<head[\s|>]/).test(S)){S=S.replace(/<html[^>]*>/,"$&<head><title></title></head>")}else{if(!(/<title[\s|>]/).test(S)){S=S.replace(/<head[^>]*>/,"$&<title></title>")}}P&&(S=S.replace(/<head>/,"$&"+P));S=S.replace(/<\/head\s*>/,R+"$&");S=T+S}else{S=Q.docType+'<html dir="'+Q.contentsLangDirection+'" lang="'+(Q.contentsLanguage||z.langCode)+'"><head><title>'+w+"</title>"+P+R+"</head><body"+(Q.bodyId?' id="'+Q.bodyId+'"':"")+(Q.bodyClass?' class="'+Q.bodyClass+'"':"")+">"+S+"</html>"}S+=N;this.onDispose();G(S)},getData:function(){var P=z.config,O=P.fullPage,S=O&&z.docType,R=E.getFrameDocument();var Q=O?R.getDocumentElement().getOuterHtml():R.getBody().getHtml();if(z.dataProcessor){Q=z.dataProcessor.toDataFormat(Q,C)}if(P.ignoreEmptyParagraph){Q=Q.replace(g,function(T,U){return U})}if(S){Q=S+"\n"+Q}return Q},getSnapshotData:function(){return E.getFrameDocument().getBody().getHtml()},loadSnapshotData:function(O){E.getFrameDocument().getBody().setHtml(O)},onDispose:function(){if(!z.document){return}z.document.getDocumentElement().clearCustomData();z.document.getBody().clearCustomData();z.window.clearCustomData();z.document.clearCustomData();E.clearCustomData();E.remove()},unload:function(O){this.onDispose();z.window=z.document=E=M=I=null;z.fire("contentDomUnload")},focus:function(){var P=z.window;if(H){I=true}else{if(CKEDITOR.env.opera&&z.document){var O=z.window.$.frameElement;O.blur(),O.focus();z.document.getBody().focus();z.selectionChange()}else{if(!CKEDITOR.env.opera&&P){CKEDITOR.env.air?setTimeout(function(){P.focus()},0):P.focus();z.selectionChange()}}}}});z.on("insertHtml",f(k),null,null,20);z.on("insertElement",f(o),null,null,20);z.on("insertText",f(m),null,null,20);z.on("selectionChange",b,null,null,1)});var v;z.on("contentDom",function(){var E=z.document.getElementsByTag("title").getItem(0);E.data("cke-title",z.document.$.title);z.document.$.title=w});if(CKEDITOR.env.ie8Compat){z.addCss("html.CSS1Compat [contenteditable=false]{ min-height:0 !important;}");var B=[];for(var D in CKEDITOR.dtd.$removeEmpty){B.push("html.CSS1Compat "+D+"[contenteditable=false]")}z.addCss(B.join(",")+"{ display:inline-block;}")}else{if(CKEDITOR.env.gecko){z.addCss("html { height: 100% !important; }")}}function y(E){CKEDITOR.tools.tryThese(function(){z.document.$.designMode="on";setTimeout(function(){z.document.$.designMode="off";if(CKEDITOR.currentInstance==z){z.document.getBody().focus()}},50)},function(){z.document.$.designMode="off";var F=z.document.getBody();F.setAttribute("contentEditable",false);F.setAttribute("contentEditable",true);!E&&y(1)})}if(CKEDITOR.env.ie||CKEDITOR.env.opera){var x;z.on("uiReady",function(){x=z.container.append(CKEDITOR.dom.element.createFromHtml('<span tabindex="-1" style="position:absolute;" role="presentation"></span>'));x.on("focus",function(){z.focus()})});z.on("destroy",function(){CKEDITOR.tools.removeFunction(A);x.clearCustomData()})}z.on("insertElement",function(E){var F=E.data;if(F.type==CKEDITOR.NODE_ELEMENT&&(F.is("input")||F.is("textarea"))){if(!F.isReadOnly()){F.setAttribute("contentEditable",false);F.setCustomData("_cke_notReadOnly",1)}}})}});if(CKEDITOR.env.gecko){(function(){var v=document.body;if(!v){window.addEventListener("load",arguments.callee,false)}else{var w=v.getAttribute("onpageshow");v.setAttribute("onpageshow",(w?w+";":"")+'event.persisted && (function(){var allInstances = CKEDITOR.instances, editor, doc;for ( var i in allInstances ){	editor = allInstances[ i ];	doc = editor.document;	if ( doc )	{		doc.$.designMode = "off";		doc.$.designMode = "on";	}}})();')}})()}})();CKEDITOR.config.disableObjectResizing=false;CKEDITOR.config.disableNativeTableHandles=true;CKEDITOR.config.disableNativeSpellChecker=true;CKEDITOR.config.ignoreEmptyParagraph=true;CKEDITOR.DIALOG_RESIZE_NONE=0;CKEDITOR.DIALOG_RESIZE_WIDTH=1;CKEDITOR.DIALOG_RESIZE_HEIGHT=2;CKEDITOR.DIALOG_RESIZE_BOTH=3;(function(){var h=CKEDITOR.tools.cssLength;function f(G){return !!this._.tabs[G][0].$.offsetHeight}function r(){var H=this._.currentTabId,J=this._.tabIdList.length,G=CKEDITOR.tools.indexOf(this._.tabIdList,H)+J;for(var I=G-1;I>G-J;I--){if(f.call(this,this._.tabIdList[I%J])){return this._.tabIdList[I%J]}}return null}function B(){var H=this._.currentTabId,J=this._.tabIdList.length,G=CKEDITOR.tools.indexOf(this._.tabIdList,H);for(var I=G+1;I<G+J;I++){if(f.call(this,this._.tabIdList[I%J])){return this._.tabIdList[I%J]}}return null}function s(H,J){var G=H.$.getElementsByTagName("input");for(var I=0,L=G.length;I<L;I++){var K=new CKEDITOR.dom.element(G[I]);if(K.getAttribute("type").toLowerCase()=="text"){if(J){K.setAttribute("value",K.getCustomData("fake_value")||"");K.removeCustomData("fake_value")}else{K.setCustomData("fake_value",K.getAttribute("value"));K.setAttribute("value","")}}}}CKEDITOR.dialog=function(J,N){var K=CKEDITOR.dialog._.dialogDefinitions[N],X=CKEDITOR.tools.clone(v),ac=J.config.dialog_buttonsOrder||"OS",Q=J.lang.dir;if((ac=="OS"&&CKEDITOR.env.mac)||(ac=="rtl"&&Q=="ltr")||(ac=="ltr"&&Q=="rtl")){X.buttons.reverse()}K=CKEDITOR.tools.extend(K(J),X);K=CKEDITOR.tools.clone(K);K=new u(this,K);var ad=CKEDITOR.document;var V=J.theme.buildDialog(J);this._={editor:J,element:V.element,name:N,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:false,focusList:[],currentFocusIndex:0,hasFocus:false};this.parts=V.parts;CKEDITOR.tools.setTimeout(function(){J.fire("ariaWidget",this.parts.contents)},0,this);this.parts.dialog.setStyles({position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,left:0,visibility:"hidden"});CKEDITOR.event.call(this);this.definition=K=CKEDITOR.fire("dialogDefinition",{name:N,definition:K},J).definition;var I={};if(!("removeDialogTabs" in J._)&&J.config.removeDialogTabs){var aa=J.config.removeDialogTabs.split(";");for(W=0;W<aa.length;W++){var S=aa[W].split(":");if(S.length==2){var H=S[0];if(!I[H]){I[H]=[]}I[H].push(S[1])}}J._.removeDialogTabs=I}if(J._.removeDialogTabs&&(I=J._.removeDialogTabs[N])){for(W=0;W<I.length;W++){K.removeContents(I[W])}}if(K.onLoad){this.on("load",K.onLoad)}if(K.onShow){this.on("show",K.onShow)}if(K.onHide){this.on("hide",K.onHide)}if(K.onOk){this.on("ok",function(ae){J.fire("saveSnapshot");setTimeout(function(){J.fire("saveSnapshot")},0);if(K.onOk.call(this,ae)===false){ae.data.hide=false}})}if(K.onCancel){this.on("cancel",function(ae){if(K.onCancel.call(this,ae)===false){ae.data.hide=false}})}var ab=this;var T=function(ai){var ah=ab._.contents,ag=false;for(var af in ah){for(var ae in ah[af]){ag=ai.call(this,ah[af][ae]);if(ag){return}}}};this.on("ok",function(ae){T(function(ah){if(ah.validate){var ai=ah.validate(this);if(typeof ai=="string"){var ag=this.getDialog()._.editor;RTE.tools.alert(ag.lang.errorPopupTitle,ai);ai=false}if(ai===false){var af=ah.getDialog();af.fire("notvalid",{item:ah});if(ah.select){ah.select()}else{ah.focus()}ae.data.hide=false;ae.stop();return true}}})},this,null,0);this.on("cancel",function(ae){if(this._.name=="link"){return false}T(function(af){if(af.isChanged()){if(!confirm(J.lang.common.confirmCancel)){ae.data.hide=false}return true}})},this,null,0);this.parts.close.on("click",function(ae){this.fire("close",{close:true});if(this.fire("cancel",{hide:true}).hide!==false){this.hide()}ae.data.preventDefault()},this);function P(){var ag=ab._.focusList;ag.sort(function(ai,ah){if(ai.tabIndex!=ah.tabIndex){return ah.tabIndex-ai.tabIndex}else{return ai.focusIndex-ah.focusIndex}});var af=ag.length;for(var ae=0;ae<af;ae++){ag[ae].focusIndex=ae}}function Z(af){var ak=ab._.focusList,aj=af?1:-1;if(ak.length<1){return}var ah=ab._.currentFocusIndex;try{ak[ah].getInputElement().$.blur()}catch(ag){}var ai=(ah+aj+ak.length)%ak.length,ae=ai;while(!ak[ae].isFocusable()){ae=(ae+aj+ak.length)%ak.length;if(ae==ai){break}}ak[ae].focus();if(ak[ae].type=="text"){ak[ae].select()}}this.changeFocus=Z;var G;function R(ae){if(ab!=CKEDITOR.dialog._.currentTop){return}var ai=ae.data.getKeystroke(),ah=J.lang.dir=="rtl";G=0;if(ai==9||ai==CKEDITOR.SHIFT+9){var ag=(ai==CKEDITOR.SHIFT+9);if(ab._.tabBarMode){var af=ag?r.call(ab):B.call(ab);ab.selectPage(af);ab._.tabs[af][0].focus()}else{Z(!ag)}G=1}else{if(ai==CKEDITOR.ALT+121&&!ab._.tabBarMode&&ab.getPageCount()>1){ab._.tabBarMode=true;ab._.tabs[ab._.currentTabId][0].focus();G=1}else{if((ai==37||ai==39)&&ab._.tabBarMode){af=(ai==(ah?39:37)?r.call(ab):B.call(ab));ab.selectPage(af);ab._.tabs[af][0].focus();G=1}else{if((ai==13||ai==32)&&ab._.tabBarMode){this.selectPage(this._.currentTabId);this._.tabBarMode=false;this._.currentFocusIndex=-1;Z(true);G=1}}}}if(G){ae.stop();ae.data.preventDefault()}}function M(ae){G&&ae.data.preventDefault()}var U=this._.element;this.on("show",function(){U.on("keydown",R,this,null,0);if(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.mac)){U.on("keypress",M,this)}});this.on("hide",function(){U.removeListener("keydown",R);if(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.mac)){U.removeListener("keypress",M)}});this.on("iframeAdded",function(ae){var af=new CKEDITOR.dom.document(ae.data.iframe.$.contentWindow.document);af.on("keydown",R,this,null,0)});this.on("show",function(){P();if(J.config.dialog_startupFocusTab&&ab._.pageCount>1){ab._.tabBarMode=true;ab._.tabs[ab._.currentTabId][0].focus()}else{if(!this._.hasFocus){this._.currentFocusIndex=-1;if(K.onFocus){var af=K.onFocus.call(this);af&&af.focus()}else{Z(true)}if(this._.editor.mode=="wysiwyg"&&CKEDITOR.env.ie){var ae=J.document.$.selection,ah=ae.createRange();if(ah){if(ah.parentElement&&ah.parentElement().ownerDocument==J.document.$||ah.item&&ah.item(0).ownerDocument==J.document.$){var ag=document.body.createTextRange();ag.moveToElementText(this.getElement().getFirst().$);ag.collapse(true);ag.select()}}}}}},this,null,4294967295);if(CKEDITOR.env.ie6Compat){this.on("load",function(ae){var ag=this.getElement(),af=ag.getFirst();af.remove();af.appendTo(ag)},this)}w(this);E(this);(new CKEDITOR.dom.text(K.title,CKEDITOR.document)).appendTo(this.parts.title);for(var W=0;W<K.contents.length;W++){var L=K.contents[W];L&&this.addPage(L)}this.parts.tabs.on("click",function(ae){var af=ae.data.getTarget();if(af.hasClass("cke_dialog_tab")){var ag=af.$.id;this.selectPage(ag.substring(4,ag.lastIndexOf("_")));if(this._.tabBarMode){this._.tabBarMode=false;this._.currentFocusIndex=-1;Z(true)}ae.data.preventDefault()}},this);var O=[],Y=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:K.buttons},O).getChild();this.parts.footer.setHtml(O.join(""));for(W=0;W<Y.length;W++){this._.buttons[Y[W].id]=Y[W]}};function C(I,H,G){this.element=H;this.focusIndex=G;this.tabIndex=0;this.isFocusable=function(){return !H.getAttribute("disabled")&&H.isVisible()};this.focus=function(){I._.currentFocusIndex=this.focusIndex;this.element.focus()};H.on("keydown",function(J){if(J.data.getKeystroke() in {32:1,13:1}){this.fire("click")}});H.on("focus",function(){this.fire("mouseover")});H.on("blur",function(){this.fire("mouseout")})}CKEDITOR.dialog.prototype={destroy:function(){this.hide();this._.element.remove()},resize:(function(){return function(H,G){if(this._.contentSize&&this._.contentSize.width==H&&this._.contentSize.height==G){return}CKEDITOR.dialog.fire("resize",{dialog:this,skin:this._.editor.skinName,width:H,height:G},this._.editor);this._.contentSize={width:H,height:G}}})(),getSize:function(){var G=this._.element.getFirst();return{width:G.$.offsetWidth||0,height:G.$.offsetHeight||0}},move:(function(){var G;return function(H,L,K){var J=this._.element.getFirst();if(G===undefined){G=J.getComputedStyle("position")=="fixed"}if(G&&this._.position&&this._.position.x==H&&this._.position.y==L){return}this._.position={x:H,y:L};if(!G){var I=CKEDITOR.document.getWindow().getScrollPosition();H+=I.x;L+=I.y}J.setStyles({left:(H>0?H:0)+"px",top:(L>0?L:0)+"px"});K&&(this._.moved=1)}})(),getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var L=this._.editor;if(L.mode=="wysiwyg"&&CKEDITOR.env.ie){var K=L.getSelection();K&&K.lock()}var I=this._.element;var H=this.definition;if(!(I.getParent()&&I.getParent().equals(CKEDITOR.document.getBody()))){I.appendTo(CKEDITOR.document.getBody())}else{I.setStyle("display","block")}if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){var J=this.parts.dialog;J.setStyle("position","absolute");setTimeout(function(){J.setStyle("position","fixed")},0)}this.resize(this._.contentSize&&this._.contentSize.width||H.minWidth,this._.contentSize&&this._.contentSize.height||H.minHeight);this.reset();this.selectPage(this.definition.contents[0].id);if(CKEDITOR.dialog._.currentZIndex===null){CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex}this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10);if(CKEDITOR.dialog._.currentTop===null){CKEDITOR.dialog._.currentTop=this;this._.parentDialog=null;j(this._.editor);I.on("keydown",o);I.on(CKEDITOR.env.opera?"keypress":"keyup",z);for(var M in {keyup:1,keydown:1,keypress:1}){I.on(M,D)}}else{this._.parentDialog=CKEDITOR.dialog._.currentTop;var G=this._.parentDialog.getElement().getFirst();G.$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2);CKEDITOR.dialog._.currentTop=this}m(this,this,"\x1b",null,function(){this.fireOnce("close",{esc:true});this.getButton("cancel")&&this.getButton("cancel").click()});this._.hasFocus=false;CKEDITOR.tools.setTimeout(function(){this.layout();this.parts.dialog.setStyle("visibility","");this.fireOnce("load",{});CKEDITOR.ui.fire("ready",this);this.fire("show",{});this._.editor.fire("dialogShow",this);this.foreach(function(N){N.setInitValue&&N.setInitValue()})},100,this)},layout:function(){var H=CKEDITOR.document.getWindow().getViewPaneSize(),G=this.getSize();this.move(this._.moved?this._.position.x:(H.width-G.width)/2,this._.moved?this._.position.y:(H.height-G.height)/2)},foreach:function(I){for(var H in this._.contents){for(var G in this._.contents[H]){I(this._.contents[H][G])}}return this},reset:(function(){var G=function(H){if(H.reset){H.reset(1)}};return function(){this.foreach(G);return this}})(),setupContent:function(){var G=arguments;this.foreach(function(H){if(H.setup){H.setup.apply(H,G)}})},commitContent:function(){var G=arguments;this.foreach(function(H){if(H.commit){H.commit.apply(H,G)}})},hide:function(){if(!this.parts.dialog.isVisible()){return}this.fire("hide",{});this._.editor.fire("dialogHide",this);var H=this._.element;H.setStyle("display","none");this.parts.dialog.setStyle("visibility","hidden");l(this);while(CKEDITOR.dialog._.currentTop!=this){CKEDITOR.dialog._.currentTop.hide()}if(!this._.parentDialog){p()}else{var G=this._.parentDialog.getElement().getFirst();G.setStyle("z-index",parseInt(G.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}CKEDITOR.dialog._.currentTop=this._.parentDialog;if(!this._.parentDialog){CKEDITOR.dialog._.currentZIndex=null;H.removeListener("keydown",o);H.removeListener(CKEDITOR.env.opera?"keypress":"keyup",z);for(var K in {keyup:1,keydown:1,keypress:1}){H.removeListener(K,D)}var J=this._.editor;J.focus();if(J.mode=="wysiwyg"&&CKEDITOR.env.ie){var I=J.getSelection();I&&I.unlock(true)}}else{CKEDITOR.dialog._.currentZIndex-=10}delete this._.parentDialog;this.foreach(function(L){L.resetInitValue&&L.resetInitValue()})},addPage:function(M){var J=[],N=M.label?' title="'+CKEDITOR.tools.htmlEncode(M.label)+'"':"",G=M.elements,Q=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:M.elements,expand:!!M.expand,padding:M.padding,style:M.style||"width: 100%;"},J);var P=CKEDITOR.dom.element.createFromHtml(J.join(""));P.setAttribute("role","tabpanel");var O=CKEDITOR.env;var I="cke_"+M.id+"_"+CKEDITOR.tools.getNextNumber(),K=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',(this._.pageCount>0?" cke_last":"cke_first"),N,(!!M.hidden?' style="display:none"':""),' id="',I,'"',O.gecko&&O.version>=10900&&!O.hc?"":' href="javascript:void(0)"',' tabIndex="-1"',' hidefocus="true"',' role="tab">',M.label,'<img class="chevron" src="'+window.wgBlankImgUrl+'" />',"</a>"].join(""));P.setAttribute("aria-labelledby",I);this._.tabs[M.id]=[K,P];this._.tabIdList.push(M.id);!M.hidden&&this._.pageCount++;this._.lastTab=K;this.updateStyle();var L=this._.contents[M.id]={},R,H=Q.getChild();while((R=H.shift())){L[R.id]=R;if(typeof(R.getChild)=="function"){H.push.apply(H,R.getChild())}}P.setAttribute("name",M.id);P.appendTo(this.parts.contents);K.unselectable();this.parts.tabs.append(K);if(M.accessKey){m(this,this,"CTRL+"+M.accessKey,F,g);this._.accessKeyMap["CTRL+"+M.accessKey]=M.id}},selectPage:function(K){if(this._.currentTabId==K){return}if(this.fire("selectPage",{page:K,currentPage:this._.currentTabId})===true){return}for(var G in this._.tabs){var I=this._.tabs[G][0],J=this._.tabs[G][1];if(G!=K){I.removeClass("cke_dialog_tab_selected");J.hide()}J.setAttribute("aria-hidden",G!=K)}var H=this._.tabs[K];H[0].addClass("cke_dialog_tab_selected");if(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat){s(H[1]);H[1].show();setTimeout(function(){s(H[1],1)},0)}else{H[1].show()}this._.currentTabId=K;this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,K)},updateStyle:function(){this.parts.dialog[(this._.pageCount===1?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(H){var G=this._.tabs[H]&&this._.tabs[H][0];if(!G||this._.pageCount==1||!G.isVisible()){return}else{if(H==this._.currentTabId){this.selectPage(r.call(this))}}G.hide();this._.pageCount--;this.updateStyle()},showPage:function(H){var G=this._.tabs[H]&&this._.tabs[H][0];if(!G){return}G.show();this._.pageCount++;this.updateStyle()},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(H,G){var I=this._.contents[H];return I&&I[G]},getValueOf:function(H,G){return this.getContentElement(H,G).getValue()},setValueOf:function(H,G,I){return this.getContentElement(H,G).setValue(I)},getButton:function(G){return this._.buttons[G]},click:function(G){return this._.buttons[G].click()},disableButton:function(G){return this._.buttons[G].disable()},enableButton:function(G){return this._.buttons[G].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(I,G){if(typeof G=="undefined"){G=this._.focusList.length;this._.focusList.push(new C(this,I,G))}else{this._.focusList.splice(G,0,new C(this,I,G));for(var H=G+1;H<this._.focusList.length;H++){this._.focusList[H].focusIndex++}}}};CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(G,H){if(!this._.dialogDefinitions[G]||typeof H=="function"){this._.dialogDefinitions[G]=H}},exists:function(G){return !!this._.dialogDefinitions[G]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},okButton:(function(){var G=function(I,H){H=H||{};return CKEDITOR.tools.extend({id:"ok",type:"button",label:I.lang.common.ok,"class":"cke_dialog_ui_button_ok",onClick:function(J){var K=J.data.dialog;if(K.fire("ok",{hide:true}).hide!==false){K.hide()}}},H,true)};G.type="button";G.override=function(H){return CKEDITOR.tools.extend(function(I){return G(I,H)},{type:"button"},true)};return G})(),cancelButton:(function(){var G=function(I,H){H=H||{};return CKEDITOR.tools.extend({id:"cancel",type:"button",label:I.lang.common.cancel,"class":"cke_dialog_ui_button_cancel",onClick:function(J){var K=J.data.dialog;K.fireOnce("cancelClicked");if(K.fire("cancel",{hide:true}).hide!==false){K.hide()}}},H,true)};G.type="button";G.override=function(H){return CKEDITOR.tools.extend(function(I){return G(I,H)},{type:"button"},true)};return G})(),addUIElement:function(H,G){this._.uiElementBuilders[H]=G}});CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null};CKEDITOR.event.implementOn(CKEDITOR.dialog);CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype,true);var v={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton]};var A=function(L,K,J){for(var H=0,I;(I=L[H]);H++){if(I.id==K){return I}if(J&&I[J]){var G=A(I[J],K,J);if(G){return G}}}return null};var c=function(N,I,M,K,L){if(M){for(var H=0,J;(J=N[H]);H++){if(J.id==M){N.splice(H,0,I);return I}if(K&&J[K]){var G=c(J[K],I,M,K,true);if(G){return G}}}if(L){return null}}N.push(I);return I};var k=function(L,K,J){for(var H=0,I;(I=L[H]);H++){if(I.id==K){return L.splice(H,1)}if(J&&I[J]){var G=k(I[J],K,J);if(G){return G}}}return null};var u=function(H,K){this.dialog=H;var J=K.contents;for(var G=0,I;(I=J[G]);G++){J[G]=I&&new b(H,I)}CKEDITOR.tools.extend(this,K)};u.prototype={getContents:function(G){return A(this.contents,G)},getButton:function(G){return A(this.buttons,G)},addContents:function(G,H){return c(this.contents,G,H)},addButton:function(G,H){return c(this.buttons,G,H)},removeContents:function(G){k(this.contents,G)},removeButton:function(G){k(this.buttons,G)}};function b(G,H){this._={dialog:G};CKEDITOR.tools.extend(this,H)}b.prototype={get:function(G){return A(this.elements,G,"children")},add:function(H,G){return c(this.elements,H,G,"children")},remove:function(G){k(this.elements,G,"children")}};function w(L){var I=null,N=null,H=L.getElement().getFirst(),J=L.getParentEditor(),G=J.config.dialog_magnetDistance,M=J.skin.margins||[0,0,0,0];if(typeof G=="undefined"){G=20}function K(V){var P=L.getSize(),S=CKEDITOR.document.getWindow().getViewPaneSize(),U=V.data.$.screenX,T=V.data.$.screenY,X=U-I.x,W=T-I.y,R,Q;I={x:U,y:T};N.x+=X;N.y+=W;if(N.x+M[3]<G){R=-M[3]}else{if(N.x-M[1]>S.width-P.width-G){R=S.width-P.width+(J.lang.dir=="rtl"?0:M[1])}else{R=N.x}}if(N.y+M[0]<G){Q=-M[0]}else{if(N.y-M[2]>S.height-P.height-G){Q=S.height-P.height+M[2]}else{Q=N.y}}L.move(R,Q,1);V.data.preventDefault()}function O(P){CKEDITOR.document.removeListener("mousemove",K);CKEDITOR.document.removeListener("mouseup",O);if(CKEDITOR.env.ie6Compat){var Q=x.getChild(0).getFrameDocument();Q.removeListener("mousemove",K);Q.removeListener("mouseup",O)}}L.parts.title.on("mousedown",function(P){I={x:P.data.$.screenX,y:P.data.$.screenY};CKEDITOR.document.on("mousemove",K);CKEDITOR.document.on("mouseup",O);N=L.getPosition();if(CKEDITOR.env.ie6Compat){var Q=x.getChild(0).getFrameDocument();Q.on("mousemove",K);Q.on("mouseup",O)}P.data.preventDefault()},L)}function E(M){var H=M.definition,G=H.resizable;if(G==CKEDITOR.DIALOG_RESIZE_NONE){return}var L=M.getParentEditor();var J,I,N,P,Q;function R(U){if(M._.moved&&L.lang.dir=="rtl"){var T=M._.element.getFirst();T.setStyle("right",U+"px");T.removeStyle("left")}else{if(!M._.moved){M.layout()}}}var O=CKEDITOR.tools.addFunction(function(T){Q=M.getSize();I=Q.height-M.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.opera||CKEDITOR.env.ie&&CKEDITOR.env.quirks));J=Q.width-M.parts.contents.getSize("width",1);P={x:T.screenX,y:T.screenY};N=CKEDITOR.document.getWindow().getViewPaneSize();CKEDITOR.document.on("mousemove",K);CKEDITOR.document.on("mouseup",S);if(CKEDITOR.env.ie6Compat){var U=x.getChild(0).getFrameDocument();U.on("mousemove",K);U.on("mouseup",S)}T.preventDefault&&T.preventDefault()});M.on("load",function(){var T="";if(G==CKEDITOR.DIALOG_RESIZE_WIDTH){T=" cke_resizer_horizontal"}else{if(G==CKEDITOR.DIALOG_RESIZE_HEIGHT){T=" cke_resizer_vertical"}}var U=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+T+'" title="'+CKEDITOR.tools.htmlEncode(L.lang.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+O+', event )"></div>');M.parts.footer.append(U,1)});L.on("destroy",function(){CKEDITOR.tools.removeFunction(O)});function K(aa){var Y=L.lang.dir=="rtl",ad=(aa.data.$.screenX-P.x)*(Y?-1:1),ac=aa.data.$.screenY-P.y,T=Q.width,ab=Q.height,U=T+ad*(M._.moved?1:2),W=ab+ac*(M._.moved?1:2),V=M._.element.getFirst(),Z=Y&&V.getComputedStyle("right"),X=M.getPosition();if(Z){Z=Z=="auto"?N.width-(X.x||0)-V.getSize("width"):parseInt(Z,10)}if(X.y+W>N.height){W=N.height-X.y}if((Y?Z:X.x)+U>N.width){U=N.width-(Y?Z:X.x)}if((G==CKEDITOR.DIALOG_RESIZE_WIDTH||G==CKEDITOR.DIALOG_RESIZE_BOTH)&&!(Y&&ad>0&&!X.x)){T=Math.max(H.minWidth||0,U-J)}if(G==CKEDITOR.DIALOG_RESIZE_HEIGHT||G==CKEDITOR.DIALOG_RESIZE_BOTH){ab=Math.max(H.minHeight||0,W-I)}M.resize(T,ab);R(Z);aa.data.preventDefault()}function S(){CKEDITOR.document.removeListener("mouseup",S);CKEDITOR.document.removeListener("mousemove",K);if(CKEDITOR.env.ie6Compat){var V=x.getChild(0).getFrameDocument();V.removeListener("mouseup",S);V.removeListener("mousemove",K)}if(L.lang.dir=="rtl"){var T=M._.element.getFirst(),U=T.getComputedStyle("left");if(U=="auto"){U=N.width-parseInt(T.getStyle("right"),10)-M.getSize().width}else{U=parseInt(U,10)}T.removeStyle("right");M._.position.x+=1;M.move(U,M._.position.y)}}}var q;var n={},x;function j(O){var N=CKEDITOR.document.getWindow();var H=O.config,P=H.dialog_backgroundCoverColor||"white",J=H.dialog_backgroundCoverOpacity,Q=H.baseFloatZIndex,S=CKEDITOR.tools.genKey(P,J,Q),I=n[S];if(!I){var M=['<div style="position: ',(CKEDITOR.env.ie6Compat?"absolute":"fixed"),"; z-index: ",Q,"; top: 0px; left: 0px; ",(!CKEDITOR.env.ie6Compat?"background-color: "+P:""),'" class="cke_dialog_background_cover blackout">'];if(CKEDITOR.env.ie6Compat){var L=CKEDITOR.env.isCustomDomain(),R="<html><body style=\\'background-color:"+P+";\\'></body></html>";M.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:');M.push("void((function(){document.open();"+(L?"document.domain='"+document.domain+"';":"")+"document.write( '"+R+"' );document.close();})())");M.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')}M.push("</div>");I=CKEDITOR.dom.element.createFromHtml(M.join(""));I.setOpacity(J!=undefined?J:0.5);I.appendTo(CKEDITOR.document.getBody());n[S]=I}else{I.show()}x=I;var T=function(){var U=N.getViewPaneSize();I.setStyles({width:U.width+"px",height:U.height+"px"})};var K=function(){var W=N.getScrollPosition(),V=CKEDITOR.dialog._.currentTop;I.setStyles({left:W.x+"px",top:W.y+"px"});do{var U=V.getPosition();V.move(U.x,U.y)}while((V=V._.parentDialog))};q=T;N.on("resize",T);T();if(CKEDITOR.env.ie6Compat){var G=function(){K();arguments.callee.prevScrollHandler.apply(this,arguments)};N.$.setTimeout(function(){G.prevScrollHandler=window.onscroll||function(){};window.onscroll=G},0);K()}}function p(){if(!x){return}var G=CKEDITOR.document.getWindow();x.hide();G.removeListener("resize",q);if(CKEDITOR.env.ie6Compat){G.$.setTimeout(function(){var H=window.onscroll&&window.onscroll.prevScrollHandler;window.onscroll=H||null},0)}q=null}function d(){for(var G in n){n[G].remove()}n={}}var y={};var o=function(I){var K=I.data.$.ctrlKey||I.data.$.metaKey,L=I.data.$.altKey,H=I.data.$.shiftKey,J=String.fromCharCode(I.data.$.keyCode),G=y[(K?"CTRL+":"")+(L?"ALT+":"")+(H?"SHIFT+":"")+J];if(!G||!G.length){return}G=G[G.length-1];G.keydown&&G.keydown.call(G.uiElement,G.dialog,G.key);I.data.preventDefault()};var z=function(I){var K=I.data.$.ctrlKey||I.data.$.metaKey,L=I.data.$.altKey,H=I.data.$.shiftKey,J=String.fromCharCode(I.data.$.keyCode),G=y[(K?"CTRL+":"")+(L?"ALT+":"")+(H?"SHIFT+":"")+J];if(!G||!G.length){return}G=G[G.length-1];if(G.keyup){G.keyup.call(G.uiElement,G.dialog,G.key);I.data.preventDefault()}};var m=function(G,I,H,J,L){var K=y[H]||(y[H]=[]);K.push({uiElement:G,dialog:I,key:H,keyup:L||G.accessKeyUp,keydown:J||G.accessKeyDown})};var l=function(J){for(var H in y){var I=y[H];for(var G=I.length-1;G>=0;G--){if(I[G].dialog==J||I[G].uiElement==J){I.splice(G,1)}}if(I.length===0){delete y[H]}}};var g=function(H,G){if(H._.accessKeyMap[G]){H.selectPage(H._.accessKeyMap[G])}};var F=function(H,G){};var a={27:1,13:1};var D=function(G){if(G.data.getKeystroke() in a){G.data.stopPropagation()}};(function(){CKEDITOR.ui.dialog={uiElement:function(X,S,T,J,V,H,I){if(arguments.length<4){return}var G=(J.call?J(S):J)||"div",Q=["<",G," "],P=(V&&V.call?V(S):V)||{},O=(H&&H.call?H(S):H)||{},M=(I&&I.call?I.call(this,X,S):I)||"",L=this.domId=O.id||CKEDITOR.tools.getNextId()+"_uiElement",U=this.id=S.id,W;O.id=L;var Y={};if(S.type){Y["cke_dialog_ui_"+S.type]=1}if(S.className){Y[S.className]=1}var N=(O["class"]&&O["class"].split)?O["class"].split(" "):[];for(W=0;W<N.length;W++){if(N[W]){Y[N[W]]=1}}var K=[];for(W in Y){K.push(W)}O["class"]=K.join(" ");if(S.title){O.title=S.title}var R=(S.style||"").split(";");for(W in P){R.push(W+":"+P[W])}if(S.hidden){R.push("display:none")}for(W=R.length-1;W>=0;W--){if(R[W]===""){R.splice(W,1)}}if(R.length>0){O.style=(O.style?(O.style+"; "):"")+R.join("; ")}for(W in O){Q.push(W+'="'+CKEDITOR.tools.htmlEncode(O[W])+'" ')}Q.push(">",M,"</",G,">");T.push(Q.join(""));(this._||(this._={})).dialog=X;if(typeof(S.isChanged)=="boolean"){this.isChanged=function(){return S.isChanged}}if(typeof(S.isChanged)=="function"){this.isChanged=S.isChanged}CKEDITOR.event.implementOn(this);this.registerEvents(S);if(this.accessKeyUp&&this.accessKeyDown&&S.accessKey){m(this,X,"CTRL+"+S.accessKey)}var Z=this;X.on("load",function(){if(Z.getInputElement()){Z.getInputElement().on("focus",function(){X._.tabBarMode=false;X._.hasFocus=true;Z.fire("focus")},Z)}});if(this.keyboardFocusable){this.tabIndex=S.tabIndex||0;this.focusIndex=X._.focusList.push(this)-1;this.on("focus",function(){X._.currentFocusIndex=Z.focusIndex})}CKEDITOR.tools.extend(this,S)},hbox:function(M,Q,R,I,H){if(arguments.length<4){return}this._||(this._={});var J=this._.children=Q,K=H&&H.widths||null,O=H&&H.height||null,P={},L;var N=function(){var S=['<tbody><tr class="cke_dialog_ui_hbox">'];for(L=0;L<R.length;L++){var T="cke_dialog_ui_hbox_child",U=[];if(L===0){T="cke_dialog_ui_hbox_first"}if(L==R.length-1){T="cke_dialog_ui_hbox_last"}S.push('<td class="',T,'" role="presentation" ');if(K){if(K[L]){U.push("width:"+h(K[L]))}}else{U.push("width:"+Math.floor(100/R.length)+"%")}if(O){U.push("height:"+h(O))}if(H&&H.padding!=undefined){U.push("padding:"+h(H.padding))}if(U.length>0){S.push('style="'+U.join("; ")+'" ')}S.push(">",R[L],"</td>")}S.push("</tr></tbody>");return S.join("")};var G={role:"presentation"};H&&H.align&&(G.align=H.align);CKEDITOR.ui.dialog.uiElement.call(this,M,H||{type:"hbox"},I,"table",P,G,N)},vbox:function(K,N,O,I,G){if(arguments.length<3){return}this._||(this._={});var J=this._.children=N,H=G&&G.width||null,L=G&&G.heights||null;var M=function(){var Q=['<table role="presentation" cellspacing="0" border="0" '];Q.push('style="');if(G&&G.expand){Q.push("height:100%;")}Q.push("width:"+h(H||"100%"),";");Q.push('"');Q.push('align="',CKEDITOR.tools.htmlEncode((G&&G.align)||(K.getParentEditor().lang.dir=="ltr"?"left":"right")),'" ');Q.push("><tbody>");for(var P=0;P<O.length;P++){var R=[];Q.push('<tr><td role="presentation" ');if(H){R.push("width:"+h(H||"100%"))}if(L){R.push("height:"+h(L[P]))}else{if(G&&G.expand){R.push("height:"+Math.floor(100/O.length)+"%")}}if(G&&G.padding!=undefined){R.push("padding:"+h(G.padding))}if(R.length>0){Q.push('style="',R.join("; "),'" ')}Q.push(' class="cke_dialog_ui_vbox_child">',O[P],"</td></tr>")}Q.push("</tbody></table>");return Q.join("")};CKEDITOR.ui.dialog.uiElement.call(this,K,G||{type:"vbox"},I,"div",null,{role:"presentation"},M)}}})();CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(H,G){this.getInputElement().setValue(H);!G&&this.fire("change",{value:H});return this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return false},selectParentTab:function(){var H=this.getInputElement(),I=H,G;while((I=I.getParent())&&I.$.className.search("cke_dialog_page_contents")==-1){}if(!I){return this}G=I.getAttribute("name");if(this._.dialog._.currentTabId!=G){this._.dialog.selectPage(G)}return this},focus:function(){this.selectParentTab().getInputElement().focus();return this},registerEvents:function(I){var J=/^on([A-Z]\w+)/,G;var K=function(M,N,L,O){N.on("load",function(){M.getInputElement().on(L,O,M)})};for(var H in I){if(!(G=H.match(J))){continue}if(this.eventProcessors[H]){this.eventProcessors[H].call(this,this._.dialog,I[H])}else{K(this,this._.dialog,G[1].toLowerCase(),I[H])}}return this},eventProcessors:{onLoad:function(G,H){G.on("load",H,this)},onShow:function(G,H){G.on("show",H,this)},onHide:function(G,H){G.on("hide",H,this)}},accessKeyDown:function(H,G){this.focus()},accessKeyUp:function(H,G){},disable:function(){var G=this.getInputElement();G.setAttribute("disabled","true");G.addClass("cke_disabled")},enable:function(){var G=this.getInputElement();G.removeAttribute("disabled");G.removeClass("cke_disabled")},isEnabled:function(){return !this.getInputElement().getAttribute("disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){if(!this.isEnabled()||!this.isVisible()){return false}return true}};CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(G){if(arguments.length<1){return this._.children.concat()}if(!G.splice){G=[G]}if(G.length<2){return this._.children[G[0]]}else{return(this._.children[G[0]]&&this._.children[G[0]].getChild)?this._.children[G[0]].getChild(G.slice(1,G.length)):null}}},true);CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox();(function(){var G={build:function(N,H,K){var J=H.children,I,P=[],O=[];for(var M=0;(M<J.length&&(I=J[M]));M++){var L=[];P.push(L);O.push(CKEDITOR.dialog._.uiElementBuilders[I.type].build(N,I,L))}return new CKEDITOR.ui.dialog[H.type](N,O,P,K,H)}};CKEDITOR.dialog.addUIElement("hbox",G);CKEDITOR.dialog.addUIElement("vbox",G)})();CKEDITOR.dialogCommand=function(G){this.dialogName=G};CKEDITOR.dialogCommand.prototype={exec:function(G){G.openDialog(this.dialogName)},canUndo:false,editorFocus:CKEDITOR.env.ie||CKEDITOR.env.webkit};(function(){var H=/^([a]|[^a])+$/,G=/^\d*$/,I=/^\d*(?:\.\d+)?$/;CKEDITOR.VALIDATE_OR=1;CKEDITOR.VALIDATE_AND=2;CKEDITOR.dialog.validate={functions:function(){return function(){var M=this&&this.getValue?this.getValue():arguments[0];var O=undefined,L=CKEDITOR.VALIDATE_AND,N=[],J;for(J=0;J<arguments.length;J++){if(typeof(arguments[J])=="function"){N.push(arguments[J])}else{break}}if(J<arguments.length&&typeof(arguments[J])=="string"){O=arguments[J];J++}if(J<arguments.length&&typeof(arguments[J])=="number"){L=arguments[J]}var P=(L==CKEDITOR.VALIDATE_AND?true:false);for(J=0;J<N.length;J++){if(L==CKEDITOR.VALIDATE_AND){P=P&&N[J](M)}else{P=P||N[J](M)}}if(!P){if(O!==undefined){var K=this.getDialog()._.editor;RTE.tools.alert(K.lang.errorPopupTitle,O)}if(this&&(this.select||this.focus)){(this.select||this.focus)()}return false}return true}},regex:function(J,K){return function(){var M=this&&this.getValue?this.getValue():arguments[0];if(!J.test(M)){if(K!==undefined){var L=this.getDialog()._.editor;RTE.tools.alert(L.lang.errorPopupTitle,K)}if(this&&(this.select||this.focus)){if(this.select){this.select()}else{this.focus()}}return false}return true}},notEmpty:function(J){return this.regex(H,J)},integer:function(J){return this.regex(G,J)},number:function(J){return this.regex(I,J)},equals:function(J,K){return this.functions(function(L){return L==J},K)},notEqual:function(J,K){return this.functions(function(L){return L!=J},K)}};CKEDITOR.on("instanceDestroyed",function(K){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){var J;while((J=CKEDITOR.dialog._.currentTop)){J.hide()}d()}var M=K.editor._.storedDialogs;for(var L in M){M[L].destroy()}})})()})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(c,l){var b=CKEDITOR.dialog._.dialogDefinitions[c],a=this.skin.dialog;if(typeof b=="function"&&a._isLoaded){var j=this._.storedDialogs||(this._.storedDialogs={});var g=j[c]||(j[c]=new CKEDITOR.dialog(this,c));l&&l.call(g,g);g.show();return g}else{if(b=="failed"){throw new Error('[CKEDITOR.dialog.openDialog] Dialog "'+c+'" failed when loading definition.')}}var d=CKEDITOR.document.getBody(),m=d.$.style.cursor,h=this;d.setStyle("cursor","wait");function f(o){var p=CKEDITOR.dialog._.dialogDefinitions[c],n=h.skin.dialog;if(!n._isLoaded||k&&typeof o=="undefined"){return}if(typeof p!="function"){CKEDITOR.dialog._.dialogDefinitions[c]="failed"}h.openDialog(c,l);d.setStyle("cursor",m)}if(typeof b=="string"){var k=1;CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(b),f)}CKEDITOR.skins.load(this,"dialog",f);return null}});CKEDITOR.plugins.add("dialog",{requires:["dialogui"]});CKEDITOR.plugins.add("styles",{requires:["selection"],init:function(a){a.on("contentDom",function(){a.document.setCustomData("cke_includeReadonly",!a.config.disableReadonlyStyling)})}});CKEDITOR.editor.prototype.attachStyleStateChange=function(a,c){var b=this._.styleStateChangeCallbacks;if(!b){b=this._.styleStateChangeCallbacks=[];this.on("selectionChange",function(g){for(var d=0;d<b.length;d++){var h=b[d];var f=h.style.checkActive(g.data.path)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;if(h.state!==f){h.fn.call(this,f);h.state=f}}})}b.push({style:a,fn:c})};CKEDITOR.STYLE_BLOCK=1;CKEDITOR.STYLE_INLINE=2;CKEDITOR.STYLE_OBJECT=3;(function(){var j={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1};var y={a:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1};var G=/\s*(?:;\s*|$)/;CKEDITOR.style=function(K,J){if(J){K=CKEDITOR.tools.clone(K);l(K.attributes,J);l(K.styles,J)}var I=this.element=(K.element||"*").toLowerCase();this.type=(I=="#"||j[I])?CKEDITOR.STYLE_BLOCK:y[I]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE;this._={definition:K}};CKEDITOR.style.prototype={apply:function(I){E.call(this,I,false)},remove:function(I){E.call(this,I,true)},applyToRange:function(I){return(this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?o:this.type==CKEDITOR.STYLE_BLOCK?v:this.type==CKEDITOR.STYLE_OBJECT?d:null).call(this,I)},removeFromRange:function(I){return(this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?z:this.type==CKEDITOR.STYLE_OBJECT?s:null).call(this,I)},applyToObject:function(I){H(I,this)},checkActive:function(K){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(K.block||K.blockLimit,true);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:var L=K.elements;for(var J=0,I;J<L.length;J++){I=L[J];if(this.type==CKEDITOR.STYLE_INLINE&&(I==K.block||I==K.blockLimit)){continue}if(this.type==CKEDITOR.STYLE_OBJECT&&!(I.getName() in y)){continue}if(this.checkElementRemovable(I,true)){return true}}}return false},checkApplicable:function(I){switch(this.type){case CKEDITOR.STYLE_INLINE:case CKEDITOR.STYLE_BLOCK:break;case CKEDITOR.STYLE_OBJECT:return I.lastElement.getAscendant(this.element,true)}return true},checkElementRemovable:function(M,K){if(!M){return false}var L=this._.definition,I;if(M.getName()==this.element){if(!K&&!M.hasAttributes()){return true}I=n(L);if(I._length){for(var O in I){if(O=="_length"){continue}var P=M.getAttribute(O)||"";if(O=="style"?w(I[O],m(P,false)):I[O]==P){if(!K){return true}}else{if(K){return false}}}if(K){return true}}else{return true}}var J=A(this)[M.getName()];if(J){if(!(I=J.attributes)){return true}for(var N=0;N<I.length;N++){O=I[N][0];var Q=M.getAttribute(O);if(Q){var R=I[N][1];if(R===null||(typeof R=="string"&&Q==R)||R.test(Q)){return true}}}}return false},buildPreview:function(){var L=this._.definition,K=[],I=L.element;if(I=="bdo"){I="span"}K=["<",I];var M=L.attributes;if(M){for(var J in M){K.push(" ",J,'="',M[J],'"')}}var N=CKEDITOR.style.getStyleText(L);if(N){K.push(' style="',N,'"')}K.push(">",L.name,"</",I,">");return K.join("")}};CKEDITOR.style.getStyleText=function(L){var J=L._ST;if(J){return J}J=L.styles;var I=(L.attributes&&L.attributes.style)||"",M="";if(I.length){I=I.replace(G,";")}for(var K in J){var O=J[K],N=(K+":"+O).replace(G,";");if(O=="inherit"){M+=N}else{I+=N}}if(I.length){I=m(I)}I+=M;return(L._ST=I)};function k(K){var I,J;while((K=K.getParent())){if(K.getName()=="body"){break}if(K.getAttribute("data-cke-nostyle")){I=K}else{if(!J){var L=K.getAttribute("contentEditable");if(L=="false"){I=K}else{if(L=="true"){J=1}}}}}return I}function o(aa){var ab=aa.document;if(aa.collapsed){var J=p(this,ab);aa.insertNode(J);aa.moveToPosition(J,CKEDITOR.POSITION_BEFORE_END);return}var W=this.element;var Y=this._.definition;var ae;var S=Y.includeReadonly;if(S==undefined){S=ab.getCustomData("cke_includeReadonly")}var ad=CKEDITOR.dtd[W]||(ae=true,CKEDITOR.dtd.span);aa.enlarge(CKEDITOR.ENLARGE_ELEMENT);aa.trim();var ai=aa.createBookmark(),af=ai.startNode,P=ai.endNode;var L=af;var X;var N=k(af),ag=k(P);if(N){L=N.getNextSourceNode(true)}if(ag){P=ag}if(L.getPosition(P)==CKEDITOR.POSITION_FOLLOWING){L=0}while(L){var al=false;if(L.equals(P)){L=null;al=true}else{var O=L.type;var I=O==CKEDITOR.NODE_ELEMENT?L.getName():null;var Q=I&&(L.getAttribute("contentEditable")=="false");var R=I&&L.getAttribute("data-cke-nostyle");var K=Q&&(L.getAttribute("formateditable")=="true");if(I&&L.data("cke-bookmark")){L=L.getNextSourceNode(true);continue}if(!I||(ad[I]&&!R&&(!Q||S)&&(L.getPosition(P)|CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED)==(CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IDENTICAL+CKEDITOR.POSITION_IS_CONTAINED)&&(!Y.childRule||Y.childRule(L)))||K){var am=L.getParent();if(am&&((am.getDtd()||CKEDITOR.dtd.span)[W]||ae)&&(!Y.parentRule||Y.parentRule(am))){if(!X&&(!I||!CKEDITOR.dtd.$removeEmpty[I]||(L.getPosition(P)|CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED)==(CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IDENTICAL+CKEDITOR.POSITION_IS_CONTAINED))){X=new CKEDITOR.dom.range(ab);X.setStartBefore(L)}if(O==CKEDITOR.NODE_TEXT||Q||(O==CKEDITOR.NODE_ELEMENT&&!L.getChildCount())){var Z=L;var U;while(!Z.$.nextSibling&&(U=Z.getParent(),ad[U.getName()])&&(U.getPosition(af)|CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED)==(CKEDITOR.POSITION_FOLLOWING+CKEDITOR.POSITION_IDENTICAL+CKEDITOR.POSITION_IS_CONTAINED)&&(!Y.childRule||Y.childRule(U))){Z=U}X.setEndAfter(Z);if(!Z.$.nextSibling){al=true}}}else{al=true}}else{al=true}L=L.getNextSourceNode(R||Q)}if(al&&X&&!X.collapsed){X.enlargeFormattables();var ak=p(this,ab),T=ak.hasAttributes();var V=X.getCommonAncestor();var aj={styles:{},attrs:{},blockedStyles:{},blockedAttrs:{}};var ah,M,ac;while(ak&&V){if(V.getName()==W){for(ah in Y.attributes){if(aj.blockedAttrs[ah]||!(ac=V.getAttribute(M))){continue}if(ak.getAttribute(ah)==ac){aj.attrs[ah]=1}else{aj.blockedAttrs[ah]=1}}for(M in Y.styles){if(aj.blockedStyles[M]||!(ac=V.getStyle(M))){continue}if(ak.getStyle(M)==ac){aj.styles[M]=1}else{aj.blockedStyles[M]=1}}}V=V.getParent()}for(ah in aj.attrs){ak.removeAttribute(ah)}for(M in aj.styles){ak.removeStyle(M)}if(T&&!ak.hasAttributes()){ak=null}if(ak){X.extractContents().appendTo(ak);h(this,ak);X.insertNode(ak);ak.mergeSiblings();if(!CKEDITOR.env.ie){ak.$.normalize()}}else{ak=new CKEDITOR.dom.element("span");X.extractContents().appendTo(ak);X.insertNode(ak);h(this,ak);ak.remove(true)}X=null}}aa.moveToBookmark(ai);aa.shrink(CKEDITOR.SHRINK_TEXT)}function z(Q){Q.enlarge(CKEDITOR.ENLARGE_ELEMENT);var T=Q.createBookmark(),K=T.startNode;if(Q.collapsed){var W=new CKEDITOR.dom.elementPath(K.getParent()),M;for(var O=0,P;O<W.elements.length&&(P=W.elements[O]);O++){if(P==W.block||P==W.blockLimit){break}if(this.checkElementRemovable(P)){var I;if(Q.collapsed&&(Q.checkBoundaryOfElement(P,CKEDITOR.END)||(I=Q.checkBoundaryOfElement(P,CKEDITOR.START)))){M=P;M.match=I?"start":"end"}else{P.mergeSiblings();b(this,P)}}}if(M){var N=K;for(O=0;;O++){var S=W.elements[O];if(S.equals(M)){break}else{if(S.match){continue}else{S=S.clone()}}S.append(N);N=S}N[M.match=="start"?"insertBefore":"insertAfter"](M)}}else{var R=T.endNode,U=this;function V(){var ab=new CKEDITOR.dom.elementPath(K.getParent()),X=new CKEDITOR.dom.elementPath(R.getParent()),ac=null,aa=null;for(var Z=0;Z<ab.elements.length;Z++){var Y=ab.elements[Z];if(Y==ab.block||Y==ab.blockLimit){break}if(U.checkElementRemovable(Y)){ac=Y}}for(Z=0;Z<X.elements.length;Z++){Y=X.elements[Z];if(Y==X.block||Y==X.blockLimit){break}if(U.checkElementRemovable(Y)){aa=Y}}if(aa){R.breakParent(aa)}if(ac){K.breakParent(ac)}}V();var J=K.getNext();while(!J.equals(R)){var L=J.getNextSourceNode();if(J.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(J)){if(J.getName()==this.element){b(this,J)}else{B(J,A(this)[J.getName()])}if(L.type==CKEDITOR.NODE_ELEMENT&&L.contains(K)){V();L=K.getNext()}}J=L}}Q.moveToBookmark(T)}function d(J){var I=J.getCommonAncestor(true,true),K=I.getAscendant(this.element,true);K&&H(K,this)}function s(N){var P=N.getCommonAncestor(true,true),M=P.getAscendant(this.element,true);if(!M){return}var I=this;var J=I._.definition;var K=J.attributes;var Q=CKEDITOR.style.getStyleText(J);if(K){for(var O in K){M.removeAttribute(O,K[O])}}if(J.styles){for(var L in J.styles){if(!J.styles.hasOwnProperty(L)){continue}M.removeStyle(L)}}}function v(I){var K=I.createBookmark(true);var J=I.createIterator();J.enforceRealBlocks=true;if(this._.enterMode){J.enlargeBr=(this._.enterMode!=CKEDITOR.ENTER_BR)}var N;var L=I.document;var M;while((N=J.getNextParagraph())){var O=p(this,L,N);C(N,O)}I.moveToBookmark(K)}function C(M,N){if(!M.$.parentNode){return}var I=N.is("pre");var J=M.is("pre");var L=I&&!J;var K=!I&&J;if(L){N=a(M,N)}else{if(K){N=q(f(M),N)}else{M.moveChildren(N)}}N.replace(M);if(I){F(N)}}var u=CKEDITOR.dom.walker.whitespaces(true);function F(K){var J;if(!((J=K.getPrevious(u))&&J.is&&J.is("pre"))){return}var I=D(J.getHtml(),/\n$/,"")+"\n\n"+D(K.getHtml(),/^\n/,"");if(CKEDITOR.env.ie){K.$.outerHTML="<pre>"+I+"</pre>"}else{K.setHtml(I)}J.remove()}function f(M){var K=/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,J=M.getName(),I=D(M.getOuterHtml(),K,function(N,O,P){return O+"</pre>"+P+"<pre>"});var L=[];I.replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(O,N){L.push(N)});return L}function D(M,L,J){var I="",K="";M=M.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(P,O,N){O&&(I=O);N&&(K=N);return""});return I+M.replace(L,J)+K}function q(L,N){var K=new CKEDITOR.dom.documentFragment(N.getDocument());for(var J=0;J<L.length;J++){var I=L[J];I=I.replace(/(\r\n|\r)/g,"\n");I=D(I,/^[ \t]*\n/,"");I=D(I,/\n$/,"");I=D(I,/^[ \t]+|[ \t]+$/g,function(O,Q,P){if(O.length==1){return"&nbsp;"}else{if(!Q){return CKEDITOR.tools.repeat("&nbsp;",O.length-1)+" "}else{return" "+CKEDITOR.tools.repeat("&nbsp;",O.length-1)}}});I=I.replace(/\n/g,"<br>");I=I.replace(/[ \t]{2,}/g,function(O){return CKEDITOR.tools.repeat("&nbsp;",O.length-1)+" "});var M=N.clone();M.setHtml(I);K.append(M)}return K}function a(K,L){var J=K.getHtml();J=D(J,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");J=J.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1");J=J.replace(/([ \t\n\r]+|&nbsp;)/g," ");J=J.replace(/<br\b[^>]*>/gi,"\n");if(CKEDITOR.env.ie){var I=K.getDocument().createElement("div");I.append(L);L.$.outerHTML="<pre>"+J+"</pre>";L=I.getFirst().remove()}else{L.setHtml(J)}return L}function b(L,K){var N=L._.definition,I=CKEDITOR.tools.extend({},N.attributes,A(L)[K.getName()]),M=N.styles,P=CKEDITOR.tools.isEmpty(I)&&CKEDITOR.tools.isEmpty(M);for(var O in I){if((O=="class"||L._.definition.fullMatch)&&K.getAttribute(O)!=r(O,I[O])){continue}P=K.hasAttribute(O);K.removeAttribute(O)}for(var J in M){if(L._.definition.fullMatch&&K.getStyle(J)!=r(J,M[J],true)){continue}P=P||!!K.getStyle(J);K.removeStyle(J)}P&&x(K)}function h(J,L){var K=J._.definition,I=K.attributes,R=K.styles,P=A(J);var Q=L.getElementsByTag(J.element);for(var M=Q.count();--M>=0;){b(J,Q.getItem(M))}for(var O in P){if(O!=J.element){Q=L.getElementsByTag(O);for(M=Q.count()-1;M>=0;M--){var N=Q.getItem(M);B(N,P[O])}}}}function B(L,N){var I=N&&N.attributes;if(I){for(var K=0;K<I.length;K++){var M=I[K][0],O;if((O=L.getAttribute(M))){var J=I[K][1];if(J===null||(J.test&&J.test(O))||(typeof J=="string"&&O==J)){L.removeAttribute(M)}}}}x(L)}function x(I){if(!I.hasAttributes()){var K=I.getFirst();var J=I.getLast();I.remove(true);if(K){K.type==CKEDITOR.NODE_ELEMENT&&K.mergeSiblings();if(J&&!K.equals(J)&&J.type==CKEDITOR.NODE_ELEMENT){J.mergeSiblings()}}}}function p(L,M,J){var K;var N=L._.definition;var I=L.element;if(I=="*"){I="span"}K=new CKEDITOR.dom.element(I,M);if(J){J.copyAttributes(K)}return H(K,L)}function H(L,K){var N=K._.definition;var J=N.attributes;var M=CKEDITOR.style.getStyleText(N);if(J){for(var I in J){L.setAttribute(I,J[I])}}if(M){L.setAttribute("style",M)}return L}var c=/#\((.+?)\)/g;function l(K,I){for(var J in K){K[J]=K[J].replace(c,function(L,M){return I[M]})}}function n(J){var M=J._AC;if(M){return M}M={};var K=0;var L=J.attributes;if(L){for(var I in L){K++;M[I]=L[I]}}var N=CKEDITOR.style.getStyleText(J);if(N){if(!M.style){K++}M.style=N}M._length=K;return(J._AC=M)}function A(I){if(I._.overrides){return I._.overrides}var P=(I._.overrides={}),L=I._.definition.overrides;if(L){if(!CKEDITOR.tools.isArray(L)){L=[L]}for(var M=0;M<L.length;M++){var J=L[M];var R;var N;var Q;if(typeof J=="string"){R=J.toLowerCase()}else{R=J.element?J.element.toLowerCase():I.element;Q=J.attributes}N=P[R]||(P[R]={});if(Q){var K=(N.attributes=N.attributes||new Array());for(var O in Q){K.push([O.toLowerCase(),Q[O]])}}}}return P}function r(J,L,K){var I=new CKEDITOR.dom.element("span");I[K?"setStyle":"setAttribute"](J,L);return I[K?"getStyle":"getAttribute"](J)}function m(K,J){var L;if(J!==false){var I=new CKEDITOR.dom.element("span");I.setAttribute("style",K);L=I.getAttribute("style")||""}else{L=K}return L.replace(/\s*([;:])\s*/,"$1").replace(/([^\s;])$/,"$1;").replace(/,\s+/g,",").replace(/\"/g,"").toLowerCase()}function g(J){var I={};J.replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(L,K,M){I[K]=M});return I}function w(J,K){typeof J=="string"&&(J=g(J));typeof K=="string"&&(K=g(K));for(var I in J){if(!(I in K&&(K[I]==J[I]||J[I]=="inherit"||K[I]=="inherit"))){return false}}return true}function E(J,I){var O=J.getSelection(),N=O.createBookmarks(1),K=O.getRanges(CKEDITOR.ONLY_FORMATTABLES),P=I?this.removeFromRange:this.applyToRange,L;J.fire("applyStyle",{style:this.element,remove:I,selection:O,ranges:K});var M=K.createIterator();while((L=M.getNextRange())){P.call(this,L)}J.fire("afterApplyStyle",{style:this.element,remove:I,selection:O,ranges:K});if(N.length==1&&N[0].collapsed){O.selectRanges(K);J.getById(N[0].startNode).remove()}else{O.selectBookmarks(N)}}})();CKEDITOR.styleCommand=function(a){this.style=a};CKEDITOR.styleCommand.prototype.exec=function(a){a.focus();var b=a.document;if(b){if(this.state==CKEDITOR.TRISTATE_OFF){this.style.apply(b)}else{if(this.state==CKEDITOR.TRISTATE_ON){this.style.remove(b)}}}return !!b};CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet");CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet);CKEDITOR.loadStylesSet=function(b,a,c){CKEDITOR.stylesSet.addExternal(b,a,"");CKEDITOR.stylesSet.load(b,c)};CKEDITOR.editor.prototype.getStylesSet=function(h){if(!this._.stylesDefinitions){var d=this,b=d.config.stylesCombo_stylesSet||d.config.stylesSet||"default";if(b instanceof Array){d._.stylesDefinitions=b;h(b);return}var c=b.split(":"),g=c[0],f=c[1],a=CKEDITOR.plugins.registered.styles.path;CKEDITOR.stylesSet.addExternal(g,f?c.slice(1).join(":"):a+"styles/"+g+".js","");CKEDITOR.stylesSet.load(g,function(j){d._.stylesDefinitions=j[g];h(d._.stylesDefinitions)})}else{h(this._.stylesDefinitions)}};CKEDITOR.plugins.add("domiterator");(function(){function b(d){if(arguments.length<1){return}this.range=d;this.forceBrBreak=0;this.enlargeBr=1;this.enforceRealBlocks=0;this._||(this._={})}var c=/^[\r\n\t ]+$/,a=CKEDITOR.dom.walker.bookmark();b.prototype={getNextParagraph:function(F){var p;var u;var s;var y;var z,l;if(!this._.lastNode){u=this.range.clone();u.shrink(CKEDITOR.NODE_ELEMENT,true);y=u.endContainer.hasAscendant("pre",true)||u.startContainer.hasAscendant("pre",true);u.enlarge(this.forceBrBreak&&!y||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS);var A=new CKEDITOR.dom.walker(u),r=CKEDITOR.dom.walker.bookmark(true,true);A.evaluator=r;this._.nextNode=A.next();A=new CKEDITOR.dom.walker(u);A.evaluator=r;var m=A.previous();this._.lastNode=m.getNextSourceNode(true);if(this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()){var n=new CKEDITOR.dom.range(u.document);n.moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END);if(n.checkEndOfBlock()){var x=new CKEDITOR.dom.elementPath(n.endContainer);var E=x.block||x.blockLimit;this._.lastNode=E.getNextSourceNode(true)}}if(!this._.lastNode){this._.lastNode=this._.docEndMarker=u.document.createText("");this._.lastNode.insertAfter(m)}u=null}var k=this._.nextNode;m=this._.lastNode;this._.nextNode=null;while(k){var g=0,q=k.hasAscendant("pre");var h=(k.type!=CKEDITOR.NODE_ELEMENT),G=0;if(!h){var d=k.getName();if(k.isBlockBoundary(this.forceBrBreak&&!q&&{br:1})){if(d=="br"){h=1}else{if(!u&&!k.getChildCount()&&d!="hr"){p=k;s=k.equals(m);break}}if(u){u.setEndAt(k,CKEDITOR.POSITION_BEFORE_START);if(d!="br"){this._.nextNode=k}}g=1}else{if(k.getFirst()){if(!u){u=new CKEDITOR.dom.range(this.range.document);u.setStartAt(k,CKEDITOR.POSITION_BEFORE_START)}k=k.getFirst();continue}h=1}}else{if(k.type==CKEDITOR.NODE_TEXT){if(c.test(k.getText())){h=0}}}if(h&&!u){u=new CKEDITOR.dom.range(this.range.document);u.setStartAt(k,CKEDITOR.POSITION_BEFORE_START)}s=((!g||h)&&k.equals(m));if(u&&!g){while(!k.getNext()&&!s){var o=k.getParent();if(o.isBlockBoundary(this.forceBrBreak&&!q&&{br:1})){g=1;s=s||(o.equals(m));break}k=o;h=1;s=(k.equals(m));G=1}}if(h){u.setEndAt(k,CKEDITOR.POSITION_AFTER_END)}k=k.getNextSourceNode(G,null,m);s=!k;if(s||(g&&u)){break}}if(!p){if(!u){this._.docEndMarker&&this._.docEndMarker.remove();this._.nextNode=null;return null}u.enlargeFormattables();var D=new CKEDITOR.dom.elementPath(u.startContainer);var w=D.blockLimit,f={div:1,th:1,td:1};p=D.block;if(!p&&!this.enforceRealBlocks&&f[w.getName()]&&u.checkStartOfBlock()&&u.checkEndOfBlock()){p=w}else{if(!p||(this.enforceRealBlocks&&p.getName()=="li")){p=this.range.document.createElement(F||"p");u.extractContents().appendTo(p);p.trim();u.insertNode(p);z=l=true}else{if(p.getName()!="li"){if(!u.checkStartOfBlock()||!u.checkEndOfBlock()){p=p.clone(false);u.extractContents().appendTo(p);p.trim();var B=u.splitBlock();z=!B.wasStartOfBlock;l=!B.wasEndOfBlock;u.insertNode(p)}}else{if(!s){this._.nextNode=(p.equals(m)?null:u.getBoundaryNodes().endNode.getNextSourceNode(true,null,m))}}}}}var j=CKEDITOR.dom.walker.bookmark(false,true);if(z){var v=p.getPrevious();if(v&&v.type==CKEDITOR.NODE_ELEMENT){if(v.getName()=="br"){v.remove()}else{if(v.getLast()&&v.getLast().$.nodeName.toLowerCase()=="br"){v.getLast().remove()}}}}if(l){var C=p.getLast();if(C&&C.type==CKEDITOR.NODE_ELEMENT&&C.getName()=="br"){if(CKEDITOR.env.ie||C.getPrevious(j)||C.getNext(j)){C.remove()}}}if(!this._.nextNode){this._.nextNode=(s||p.equals(m))?null:p.getNextSourceNode(true,null,m)}if(!j(this._.nextNode)){this._.nextNode=this._.nextNode.getNextSourceNode(true,null,function(H){return !H.equals(m)&&j(H)})}return p}};CKEDITOR.dom.range.prototype.createIterator=function(){return new b(this)}})();CKEDITOR.plugins.add("panelbutton",{requires:["button"],beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_PANELBUTTON,CKEDITOR.ui.panelButton.handler)}});CKEDITOR.UI_PANELBUTTON=4;(function(){var a=function(c){var b=this._;if(b.state==CKEDITOR.TRISTATE_DISABLED){return}this.createPanel(c);if(b.on){b.panel.hide();return}b.panel.showBlock(this._.id,this.document.getById(this._.id),4)};CKEDITOR.ui.panelButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(b){var c=b.panel;delete b.panel;this.base(b);this.document=(c&&c.parent&&c.parent.getDocument())||CKEDITOR.document;c.block={attributes:c.attributes};this.hasArrow=true;this.click=a;this._={panelDefinition:c}},statics:{handler:{create:function(b){return new CKEDITOR.ui.panelButton(b)}}},proto:{createPanel:function(d){var c=this._;if(c.panel){return}var k=this._.panelDefinition||{},h=this._.panelDefinition.block,g=k.parent||CKEDITOR.document.getBody(),b=this._.panel=new CKEDITOR.ui.floatPanel(d,g,k),j=b.addBlock(c.id,h),f=this;b.onShow=function(){if(f.className){this.element.getFirst().addClass(f.className+"_panel")}f.setState(CKEDITOR.TRISTATE_ON);c.on=1;if(f.onOpen){f.onOpen()}};b.onHide=function(l){if(f.className){this.element.getFirst().removeClass(f.className+"_panel")}f.setState(f.modes&&f.modes[d.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);c.on=0;if(!l&&f.onClose){f.onClose()}};b.onEscape=function(){b.hide();f.document.getById(c.id).focus()};if(this.onBlock){this.onBlock(b,j)}j.onHide=function(){c.on=0;f.setState(CKEDITOR.TRISTATE_OFF)}}}})})();CKEDITOR.plugins.add("floatpanel",{requires:["panel"]});(function(){var b={};var a=false;function c(j,k,f,h,l){var g=CKEDITOR.tools.genKey(k.getUniqueId(),f.getUniqueId(),j.skinName,j.lang.dir,j.uiColor||"",h.css||"",l||"");var d=b[g];if(!d){d=b[g]=new CKEDITOR.ui.panel(k,h);d.element=f.append(CKEDITOR.dom.element.createFromHtml(d.renderHtml(j),k));d.element.setStyles({display:"none",position:"absolute"})}return d}CKEDITOR.ui.floatPanel=CKEDITOR.tools.createClass({$:function(k,f,h,m){h.forceIFrame=1;var l=f.getDocument(),d=c(k,l,f,h,m||0),g=d.element,j=g.getFirst().getFirst();this.element=g;this._={panel:d,parentElement:f,definition:h,document:l,iframe:j,children:[],dir:k.lang.dir};k.on("mode",function(){this.hide()},this)},proto:{addBlock:function(d,f){return this._.panel.addBlock(d,f)},addListBlock:function(d,f){return this._.panel.addListBlock(d,f)},getBlock:function(d){return this._.panel.getBlock(d)},showBlock:function(g,f,u,p,m){var d=this._.panel,k=d.showBlock(g);this.allowBlur(false);a=1;var n=this.element,l=this._.iframe,h=this._.definition,o=f.getDocumentPosition(n.getDocument()),s=this._.dir=="rtl";var j=o.x+(p||0),r=o.y+(m||0);if(s&&(u==1||u==4)){j+=f.$.offsetWidth}else{if(!s&&(u==2||u==3)){j+=f.$.offsetWidth-1}}if(u==3||u==4){r+=f.$.offsetHeight-1}this._.panel._.offsetParentId=f.getId();n.setStyles({top:r+"px",left:0,display:""});n.setOpacity(0);n.getFirst().removeStyle("width");if(!this._.blurSet){var q=CKEDITOR.env.ie?l:new CKEDITOR.dom.window(l.$.contentWindow);CKEDITOR.event.useCapture=true;q.on("blur",function(v){if(!this.allowBlur()){return}var w;if(CKEDITOR.env.ie&&!this.allowBlur()||(w=v.data.getTarget())&&w.getName&&w.getName()!="iframe"){return}if(this.visible&&!this._.activeChild&&!a){this.hide()}},this);q.on("focus",function(){this._.focused=true;this.hideChild();this.allowBlur(true)},this);CKEDITOR.event.useCapture=false;this._.blurSet=1}d.onEscape=CKEDITOR.tools.bind(function(v){if(this.onEscape&&this.onEscape(v)===false){return false}},this);CKEDITOR.tools.setTimeout(function(){if(s){j-=n.$.offsetWidth}var v=CKEDITOR.tools.bind(function(){var D=n.getFirst();if(k.autoSize){var H=k.element.$;if(CKEDITOR.env.gecko||CKEDITOR.env.opera){H=H.parentNode}if(CKEDITOR.env.ie){H=H.document.body}var x=H.scrollWidth;if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&x>0){x+=(D.$.offsetWidth||0)-(D.$.clientWidth||0)}x+=4;D.setStyle("width",x+"px");k.element.addClass("cke_frameLoaded");var I=k.element.$.scrollHeight;if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&I>0){I+=(D.$.offsetHeight||0)-(D.$.clientHeight||0)}D.setStyle("height",I+"px");d._.currentBlock.element.setStyle("display","none").removeStyle("display")}else{D.removeStyle("height")}var z=d.element,y=z.getWindow(),G=y.getScrollPosition(),A=y.getViewPaneSize(),E={height:z.$.offsetHeight,width:z.$.offsetWidth};if(s?j<0:j+E.width>A.width+G.x){j+=(E.width*(s?1:-1))}if(r+E.height>A.height+G.y){r-=E.height}if(CKEDITOR.env.ie){var w=new CKEDITOR.dom.element(n.$.offsetParent),F=w;if(F.getName()=="html"){F=F.getDocument().getBody()}if(F.getComputedStyle("direction")=="rtl"){if(CKEDITOR.env.ie8Compat){j-=n.getDocument().getDocumentElement().$.scrollLeft*2}else{j-=(w.$.scrollWidth-w.$.clientWidth)}}}var C=n.getFirst(),B;if((B=C.getCustomData("activePanel"))){B.onHide&&B.onHide.call(this,1)}C.setCustomData("activePanel",this);n.setStyles({top:r+"px",left:j+"px"});n.setOpacity(1)},this);d.isLoaded?v():d.onLoad=v;CKEDITOR.tools.setTimeout(function(){l.$.contentWindow.focus();this.allowBlur(true)},0,this)},CKEDITOR.env.air?200:0,this);this.visible=1;if(this.onShow){this.onShow.call(this)}a=0},hide:function(){if(this.visible&&(!this.onHide||this.onHide.call(this)!==true)){this.hideChild();this.element.setStyle("display","none");this.visible=0;this.element.getFirst().removeCustomData("activePanel")}},allowBlur:function(f){var d=this._.panel;if(f!=undefined){d.allowBlur=f}return d.allowBlur},showAsChild:function(f,g,j,h,d,k){if(this._.activeChild==f&&f._.panel._.offsetParentId==j.getId()){return}this.hideChild();f.onHide=CKEDITOR.tools.bind(function(){CKEDITOR.tools.setTimeout(function(){if(!this._.focused){this.hide()}},0,this)},this);this._.activeChild=f;this._.focused=false;f.showBlock(g,j,h,d,k);if(CKEDITOR.env.ie7Compat||(CKEDITOR.env.ie8&&CKEDITOR.env.ie6Compat)){setTimeout(function(){f.element.getChild(0).$.style.cssText+=""},100)}},hideChild:function(){var d=this._.activeChild;if(d){delete d.onHide;delete this._.activeChild;d.hide()}}}});CKEDITOR.on("instanceDestroyed",function(){var f=CKEDITOR.tools.isEmpty(CKEDITOR.instances);for(var g in b){var d=b[g];if(f){d.destroy()}else{d.element.hide()}}f&&(b={})})})();CKEDITOR.plugins.add("menu",{beforeInit:function(d){var a=d.config.menu_groups.split(","),f=d._.menuGroups={},c=d._.menuItems={};for(var b=0;b<a.length;b++){f[a[b]]=b+1}d.addMenuGroup=function(h,g){f[h]=g||100};d.addMenuItem=function(g,h){if(f[h.group]){c[g]=new CKEDITOR.menuItem(this,g,h)}};d.addMenuItems=function(g){for(var h in g){this.addMenuItem(h,g[h])}};d.getMenuItem=function(g){return c[g]}},requires:["floatpanel"]});(function(){CKEDITOR.menu=CKEDITOR.tools.createClass({$:function(d,c){c=this._.definition=c||{};this.id="cke_"+CKEDITOR.tools.getNextNumber();this.editor=d;this.items=[];this._.listeners=[];this._.level=c.level||1;var f=CKEDITOR.tools.extend({},c.panel,{css:d.skin.editor.css,level:this._.level-1,block:{}});var b=f.block.attributes=(f.attributes||{});!b.role&&(b.role="menu");this._.panelDefinition=f},_:{onShow:function(){var h=this.editor.getSelection();if(CKEDITOR.env.ie){h&&h.lock()}var d=h&&h.getStartElement(),g=this._.listeners,f=[];this.removeAll();for(var c=0;c<g.length;c++){var b=g[c](d,h);if(b){for(var k in b){var j=this.editor.getMenuItem(k);if(j){j.state=b[k];this.add(j)}}}}},onClick:function(b){this.hide();if(b.onClick){b.onClick()}else{if(b.command){this.editor.execCommand(b.command)}}},onEscape:function(c){var b=this.parent;if(b){b._.panel.hideChild();var d=b._.panel._.panel._.currentBlock,f=d._.focusIndex;d._.markItem(f)}else{if(c==27){this.hide();this.editor.focus()}}return false},onHide:function(){if(CKEDITOR.env.ie){var b=this.editor.getSelection();b&&b.unlock()}this.onHide&&this.onHide()},showSubMenu:function(c){var h=this._.subMenu,f=this.items[c],k=f.getItems&&f.getItems();if(!k){this._.panel.hideChild();return}var g=this._.panel.getBlock(this.id);g._.focusIndex=c;if(h){h.removeAll()}else{h=this._.subMenu=new CKEDITOR.menu(this.editor,CKEDITOR.tools.extend({},this._.definition,{level:this._.level+1},true));h.parent=this;h._.onClick=CKEDITOR.tools.bind(this._.onClick,this)}for(var b in k){var j=this.editor.getMenuItem(b);if(j){j.state=k[b];h.add(j)}}var d=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+String(c));h.show(d,2)}},proto:{add:function(b){if(!b.order){b.order=this.items.length}this.items.push(b)},removeAll:function(){this.items=[]},show:function(b,g,r,q){if(!this.parent){this._.onShow();if(!this.items.length){return}}g=g||(this.editor.lang.dir=="rtl"?2:1);var o=this.items,f=this.editor,m=this._.panel,c=this._.element;if(!m){m=this._.panel=new CKEDITOR.ui.floatPanel(this.editor,CKEDITOR.document.getBody(),this._.panelDefinition,this._.level);m.onEscape=CKEDITOR.tools.bind(function(w){if(this._.onEscape(w)===false){return false}},this);m.onHide=CKEDITOR.tools.bind(function(){this._.onHide&&this._.onHide()},this);var h=m.addBlock(this.id,this._.panelDefinition.block);h.autoSize=true;var n=h.keys;n[40]="next";n[9]="next";n[38]="prev";n[CKEDITOR.SHIFT+9]="prev";n[32]="click";n[(f.lang.dir=="rtl"?37:39)]="click";c=this._.element=h.element;c.addClass(f.skinClass);var k=c.getDocument();k.getBody().setStyle("overflow","hidden");k.getElementsByTag("html").getItem(0).setStyle("overflow","hidden");this._.itemOverFn=CKEDITOR.tools.addFunction(function(w){clearTimeout(this._.showSubTimeout);this._.showSubTimeout=CKEDITOR.tools.setTimeout(this._.showSubMenu,f.config.menu_subMenuDelay||400,this,[w])},this);this._.itemOutFn=CKEDITOR.tools.addFunction(function(w){clearTimeout(this._.showSubTimeout)},this);this._.itemClickFn=CKEDITOR.tools.addFunction(function(w){var x=this.items[w];if(x.state==CKEDITOR.TRISTATE_DISABLED){this.hide();return}if(x.getItems){this._.showSubMenu(w)}else{this._.onClick(x)}},this)}a(o);var v=f.container.getChild(1),l=(v&&v.hasClass("cke_mixed_dir_content"))?" cke_mixed_dir_content":"";var j=['<div class="cke_menu'+l+'" role="presentation">'];var d=o.length,u=d&&o[0].group;for(var p=0;p<d;p++){var s=o[p];if(u!=s.group){j.push('<div class="cke_menuseparator" role="separator"></div>');u=s.group}s.render(this,p,j)}j.push("</div>");c.setHtml(j.join(""));CKEDITOR.ui.fire("ready",this);if(this.parent){this.parent._.panel.showAsChild(m,this.id,b,g,r,q)}else{m.showBlock(this.id,b,g,r,q)}f.fire("menuShow",[m])},addListener:function(b){this._.listeners.push(b)},hide:function(){this._.onHide&&this._.onHide();this._.panel&&this._.panel.hide()}}});function a(b){b.sort(function(d,c){if(d.group<c.group){return -1}else{if(d.group>c.group){return 1}}return d.order<c.order?-1:d.order>c.order?1:0})}CKEDITOR.menuItem=CKEDITOR.tools.createClass({$:function(d,b,c){CKEDITOR.tools.extend(this,c,{order:0,className:"cke_button_"+b});this.group=d._.menuGroups[this.group];this.editor=d;this.name=b},proto:{render:function(g,l,h){var f=g.id+String(l),d=(typeof this.state=="undefined")?CKEDITOR.TRISTATE_OFF:this.state;var j=" cke_"+(d==CKEDITOR.TRISTATE_ON?"on":d==CKEDITOR.TRISTATE_DISABLED?"disabled":"off");var b=this.label;if(this.className){j+=" "+this.className}var c=this.getItems;h.push('<span class="cke_menuitem"><a id="',f,'" class="',j,'" href="javascript:void(\'',(this.label||"").replace("'",""),'\')" title="',this.label,'" tabindex="-1"_cke_focus=1 hidefocus="true" role="menuitem"'+(c?'aria-haspopup="true"':"")+(d==CKEDITOR.TRISTATE_DISABLED?'aria-disabled="true"':"")+(d==CKEDITOR.TRISTATE_ON?'aria-pressed="true"':""));if(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.mac)){h.push(' onkeypress="return false;"')}if(CKEDITOR.env.gecko){h.push(' onblur="this.style.cssText = this.style.cssText;"')}var k=(this.iconOffset||0)*-16;h.push(' onmouseover="CKEDITOR.tools.callFunction(',g._.itemOverFn,",",l,');" onmouseout="CKEDITOR.tools.callFunction(',g._.itemOutFn,",",l,');" onclick="CKEDITOR.tools.callFunction(',g._.itemClickFn,",",l,'); return false;"><span class="cke_icon_wrapper"><span class="cke_icon"'+(this.icon?' style="background-image:url('+CKEDITOR.getUrl(this.icon)+");background-position:0 "+k+'px;"':"")+'></span></span><span class="cke_label">');if(c){h.push('<span class="cke_menuarrow">',"<span>&#",(this.editor.lang.dir=="rtl"?"9668":"9658"),";</span>","</span>")}h.push(b,"</span></a></span>")}}})})();CKEDITOR.config.menu_groups="clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,image,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div";(function(){var b=function(c,d){return c._.modes&&c._.modes[d||c.mode]};var a;CKEDITOR.plugins.add("editingblock",{init:function(c){if(!c.config.editingBlock){return}c.on("themeSpace",function(d){if(d.data.space=="contents"){d.data.html+="<br>"}});c.on("themeLoaded",function(){c.fireOnce("editingBlockReady")});c.on("uiReady",function(){c.setMode(c.config.startupMode)});c.on("afterSetData",function(){if(!a){function d(){a=true;b(c).loadData(c.getData());a=false}if(c.mode){d()}else{c.on("mode",function(){d();c.removeListener("mode",arguments.callee)})}}});c.on("beforeGetData",function(){if(!a&&c.mode){a=true;c.setData(b(c).getData());a=false}});c.on("getSnapshot",function(d){if(c.mode){d.data=b(c).getSnapshotData()}});c.on("loadSnapshot",function(d){if(c.mode){b(c).loadSnapshotData(d.data)}});c.on("mode",function(d){d.removeListener();CKEDITOR.env.webkit&&c.container.on("focus",function(){c.focus()});if(c.config.startupFocus){c.focus()}setTimeout(function(){c.fireOnce("instanceReady");CKEDITOR.fire("instanceReady",null,c)},0)})}});CKEDITOR.editor.prototype.mode="";CKEDITOR.editor.prototype.addMode=function(d,c){c.name=d;(this._.modes||(this._.modes={}))[d]=c};CKEDITOR.editor.prototype.setMode=function(j){var h,d=this.getThemeSpace("contents"),g=this.checkDirty();if(this.mode){if(j==this.mode){return}this.fire("beforeModeUnload");var f=b(this);h=f.getData();f.unload(d);this.mode=""}d.setHtml("");var c=b(this,j);if(!c){throw'[CKEDITOR.editor.setMode] Unknown mode "'+j+'".'}if(!g){this.on("mode",function(){this.resetDirty();this.removeListener("mode",arguments.callee)})}c.load(d,(typeof h)!="string"?this.getData():h)};CKEDITOR.editor.prototype.focus=function(){var c=b(this);if(c){c.focus()}}})();CKEDITOR.config.startupMode="wysiwyg";CKEDITOR.config.editingBlock=true;(function(){function a(){try{var l=this.getSelection();if(!l||!l.document.getWindow().$){return}var j=l.getStartElement();var k=new CKEDITOR.dom.elementPath(j);if(!k.compare(this._.selectionPreviousPath)){this._.selectionPreviousPath=k;this.fire("selectionChange",{selection:l,path:k,element:j})}}catch(m){}}var h,c;function g(){c=true;if(h){return}b.call(this);h=CKEDITOR.tools.setTimeout(b,200,this)}function b(){h=null;if(c){CKEDITOR.tools.setTimeout(a,0,this);c=false}}var f={modes:{wysiwyg:1,source:1},exec:function(k){switch(k.mode){case"wysiwyg":k.document.$.execCommand("SelectAll",false,null);break;case"source":var j=k.textarea.$;if(CKEDITOR.env.ie){j.createTextRange().execCommand("SelectAll")}else{j.selectionStart=0;j.selectionEnd=j.value.length}j.focus()}},canUndo:false};CKEDITOR.plugins.add("selection",{init:function(j){j.on("contentDom",function(){var r=j.document,n=r.getBody(),m=r.getDocumentElement();if(CKEDITOR.env.ie){var o,s,l=1;n.on("focusin",function(v){if(v.data.$.srcElement.nodeName!="BODY"){return}if(o){var u=r.getCustomData("cke_locked_selection");if(l&&!u){try{o.select()}catch(w){}}o=null}});n.on("focus",function(){s=1;k()});n.on("beforedeactivate",function(u){if(u.data.$.toElement){return}s=0;l=1});if(CKEDITOR.env.ie&&CKEDITOR.env.version<8){j.on("blur",function(u){try{j.document&&j.document.$.selection.empty()}catch(v){}})}m.on("mousedown",function(){l=0});m.on("mouseup",function(){l=1});if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.version<8||CKEDITOR.env.quirks)){m.on("click",function(u){if(u.data.getTarget().getName()=="html"){j.getSelection().getRanges()[0].select()}})}var q;n.on("mousedown",function(u){if(u.data.$.button==2){var v=j.document.$.selection;if(v.type=="None"){q=j.window.getScrollPosition()}}p()});n.on("mouseup",function(u){if(u.data.$.button==2&&q){j.document.$.documentElement.scrollLeft=q.x;j.document.$.documentElement.scrollTop=q.y}q=null;s=1;setTimeout(function(){k(true)},0)});n.on("keydown",p);n.on("keyup",function(){s=1;k()});r.on("selectionchange",k);function p(){s=0}function k(x){if(s){var w=j.document,v=j.getSelection(),u=v&&v.getNative();if(x&&u&&u.type=="None"){if(!w.$.queryCommandEnabled("InsertImage")){CKEDITOR.tools.setTimeout(k,50,this,true);return}}var y;if(u&&u.type&&u.type!="Control"&&(y=u.createRange())&&(y=y.parentElement())&&(y=y.nodeName)&&y.toLowerCase() in {input:1,textarea:1}){return}o=u&&v.getRanges()[0];g.call(j)}}}else{r.on("mouseup",g,j);r.on("keyup",g,j)}});j.addCommand("selectAll",f);j.ui.addButton("SelectAll",{label:j.lang.selectAll,command:"selectAll"});j.selectionChange=g}});CKEDITOR.editor.prototype.getSelection=function(){return this.document&&this.document.getSelection()};CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath};CKEDITOR.dom.document.prototype.getSelection=function(){var j=new CKEDITOR.dom.selection(this);return(!j||j.isInvalid)?null:j};CKEDITOR.SELECTION_NONE=1;CKEDITOR.SELECTION_TEXT=2;CKEDITOR.SELECTION_ELEMENT=3;CKEDITOR.dom.selection=function(k){var j=k.getCustomData("cke_locked_selection");if(j){return j}this.document=k;this.isLocked=0;this._={cache:{}};if(CKEDITOR.env.ie){var l=this.getNative().createRange();if(!l||(l.item&&l.item(0).ownerDocument!=this.document.$)||(l.parentElement&&l.parentElement().ownerDocument!=this.document.$)){this.isInvalid=true}}return this};var d={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,th:1,thead:1,tfoot:1};CKEDITOR.dom.selection.prototype={getNative:CKEDITOR.env.ie?function(){return this._.cache.nativeSel||(this._.cache.nativeSel=this.document.$.selection)}:function(){return this._.cache.nativeSel||(this._.cache.nativeSel=this.document.getWindow().$.getSelection())},getType:CKEDITOR.env.ie?function(){var j=this._.cache;if(j.type){return j.type}var k=CKEDITOR.SELECTION_NONE;try{var l=this.getNative(),n=l.type;if(n=="Text"){k=CKEDITOR.SELECTION_TEXT}if(n=="Control"){k=CKEDITOR.SELECTION_ELEMENT}if(l.createRange().parentElement){k=CKEDITOR.SELECTION_TEXT}}catch(m){}return(j.type=k)}:function(){var k=this._.cache;if(k.type){return k.type}var l=CKEDITOR.SELECTION_TEXT;var n=this.getNative();if(!n){l=CKEDITOR.SELECTION_NONE}else{if(n.rangeCount==1){var j=n.getRangeAt(0),m=j.startContainer;if(m==j.endContainer&&m.nodeType==1&&(j.endOffset-j.startOffset)==1&&d[m.childNodes[j.startOffset].nodeName.toLowerCase()]){l=CKEDITOR.SELECTION_ELEMENT}}}return(k.type=l)},getRanges:(function(){var j=CKEDITOR.env.ie?(function(){var k=function(r,m){r=r.duplicate();r.collapse(m);var w=r.parentElement();var v=w.childNodes;var o;for(var q=0;q<v.length;q++){var n=v[q];if(n.nodeType==1){o=r.duplicate();o.moveToElementText(n);var u=o.compareEndPoints("StartToStart",r),p=o.compareEndPoints("EndToStart",r);o.collapse();if(u>0){break}else{if(!u||p==1&&u==-1){return{container:w,offset:q}}else{if(!p){return{container:w,offset:q+1}}}}o=null}}if(!o){o=r.duplicate();o.moveToElementText(w);o.collapse(false)}o.setEndPoint("StartToStart",r);var l=o.text.replace(/(\r\n|\r)/g,"\n").length;try{while(l>0){l-=v[--q].nodeValue.length}}catch(s){l=0}if(l===0){return{container:w,offset:q}}else{return{container:v[q],offset:-l}}};return function(){var n=this.getNative(),s=n&&n.createRange(),u=this.getType(),r;if(!n){return[]}if(u==CKEDITOR.SELECTION_TEXT){r=new CKEDITOR.dom.range(this.document);var l=k(s,true);r.setStart(new CKEDITOR.dom.node(l.container),l.offset);l=k(s);r.setEnd(new CKEDITOR.dom.node(l.container),l.offset);if(r.endContainer.getPosition(r.startContainer)&CKEDITOR.POSITION_PRECEDING&&r.endOffset<=r.startContainer.getIndex()){r.collapse()}return[r]}else{if(u==CKEDITOR.SELECTION_ELEMENT){var m=[];for(var p=0;p<s.length;p++){var q=s.item(p),v=q.parentNode,o=0;r=new CKEDITOR.dom.range(this.document);for(;o<v.childNodes.length&&v.childNodes[o]!=q;o++){}r.setStart(new CKEDITOR.dom.node(v),o);r.setEnd(new CKEDITOR.dom.node(v),o+1);m.push(r)}return m}}return[]}})():function(){var k=[],l,p=this.document,o=this.getNative();if(!o){return k}if(!o.rangeCount){l=new CKEDITOR.dom.range(p);l.moveToElementEditStart(p.getBody());k.push(l)}for(var m=0;m<o.rangeCount;m++){var n=o.getRangeAt(m);l=new CKEDITOR.dom.range(p);l.setStart(new CKEDITOR.dom.node(n.startContainer),n.startOffset);l.setEnd(new CKEDITOR.dom.node(n.endContainer),n.endOffset);k.push(l)}return k};return function(x){var u=x===CKEDITOR.ONLY_FORMATTABLES;var l=this._.cache;if(l.ranges&&!x){return l.ranges}else{if(!l.ranges){l.ranges=new CKEDITOR.dom.rangeList(j.call(this))}}if(x){var m=l.ranges;for(var p=0;p<m.length;p++){var q=m[p];if(u){q.enlargeFormattables()}var w=q.getCommonAncestor();if(w[u?"isReadOnlyNotFormattable":"isReadOnly"]()){m.splice(p,1)}if(q.collapsed){continue}var o=q.startContainer,y=q.endContainer,r=q.startOffset,s=q.endOffset,n=q.clone();var v;if((v=o.isReadOnly())){q.setStartAfter(v)}if(o&&o.type==CKEDITOR.NODE_TEXT){if(r>=o.getLength()){n.setStartAfter(o)}else{n.setStartBefore(o)}}if(y&&y.type==CKEDITOR.NODE_TEXT){if(!s){n.setEndBefore(y)}else{n.setEndAfter(y)}}var k=new CKEDITOR.dom.walker(n);k.evaluator=function(A){if(A.type==CKEDITOR.NODE_ELEMENT&&A.getAttribute("contenteditable")=="false"&&!(u&&A.getAttribute("formateditable")=="true")){var z=q.clone();q.setEndBefore(A);if(q.collapsed){m.splice(p--,1)}if(!(A.getPosition(n.endContainer)&CKEDITOR.POSITION_CONTAINS)){z.setStartAfter(A);if(!z.collapsed){m.splice(p+1,0,z)}}return true}return false};k.next()}}return l.ranges}})(),getStartElement:function(){var l=this._.cache;if(l.startElement!==undefined){return l.startElement}var n,o=this.getNative();switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var k=this.getRanges()[0];if(k){if(!k.collapsed){k.optimize();while(1){var m=k.startContainer,j=k.startOffset;if(j==(m.getChildCount?m.getChildCount():m.getLength())&&!m.isBlockBoundary()){k.setStartAfter(m)}else{break}}n=k.startContainer;if(n.type!=CKEDITOR.NODE_ELEMENT){return n.getParent()}n=n.getChild(k.startOffset);if(!n||n.type!=CKEDITOR.NODE_ELEMENT){n=k.startContainer}else{var p=n.getFirst();while(p&&p.type==CKEDITOR.NODE_ELEMENT){n=p;p=p.getFirst()}}}else{n=k.startContainer;if(n.type!=CKEDITOR.NODE_ELEMENT){n=n.getParent()}}n=n.$}}return l.startElement=(n?new CKEDITOR.dom.element(n):null)},getSelectedElement:function(){var k=this._.cache;if(k.selectedElement!==undefined){return k.selectedElement}var j=this;var l=CKEDITOR.tools.tryThese(function(){return j.getNative().createRange().item(0)},function(){var m=j.getRanges()[0],p,o;for(var n=2;n&&!((p=m.getEnclosedNode())&&(p.type==CKEDITOR.NODE_ELEMENT)&&d[p.getName()]&&(o=p));n--){m.shrink(CKEDITOR.SHRINK_ELEMENT)}return o.$});return k.selectedElement=(l?new CKEDITOR.dom.element(l):null)},lock:function(){this.getRanges();this.getStartElement();this.getSelectedElement();this._.cache.nativeSel={};this.isLocked=1;this.document.setCustomData("cke_locked_selection",this)},unlock:function(l){var m=this.document,j=m.getCustomData("cke_locked_selection");if(j){m.setCustomData("cke_locked_selection",null);if(l){var n=j.getSelectedElement(),k=!n&&j.getRanges();this.isLocked=0;this.reset();m.getBody().focus();if(n){this.selectElement(n)}else{this.selectRanges(k)}}}if(!j||!l){this.isLocked=0;this.reset()}},reset:function(){this._.cache={}},selectElement:function(k){if(this.isLocked){var j=new CKEDITOR.dom.range(this.document);j.setStartBefore(k);j.setEndAfter(k);this._.cache.selectedElement=k;this._.cache.startElement=k;this._.cache.ranges=new CKEDITOR.dom.rangeList(j);this._.cache.type=CKEDITOR.SELECTION_ELEMENT;return}if(CKEDITOR.env.ie){this.getNative().empty();try{j=this.document.$.body.createControlRange();j.addElement(k.$);j.select()}catch(m){j=this.document.$.body.createTextRange();j.moveToElementText(k.$);j.select()}finally{this.document.fire("selectionchange")}this.reset()}else{j=this.document.$.createRange();j.selectNode(k.$);var l=this.getNative();l.removeAllRanges();l.addRange(j);this.reset()}},selectRanges:function(j){if(this.isLocked){this._.cache.selectedElement=null;this._.cache.startElement=j[0]&&j[0].getTouchedStartNode();this._.cache.ranges=new CKEDITOR.dom.rangeList(j);this._.cache.type=CKEDITOR.SELECTION_TEXT;return}if(CKEDITOR.env.ie){if(j.length>1){var r=j[j.length-1];j[0].setEnd(r.endContainer,r.endOffset);j.length=1}if(j[0]){j[0].select()}this.reset()}else{var k=this.getNative();if(j.length){k.removeAllRanges()}for(var n=0;n<j.length;n++){if(n<j.length-1){var m=j[n],s=j[n+1],u=m.clone();u.setStart(m.endContainer,m.endOffset);u.setEnd(s.startContainer,s.startOffset);if(!u.collapsed){u.shrink(CKEDITOR.NODE_ELEMENT,true);if(u.getCommonAncestor().isReadOnly()){s.setStart(m.startContainer,m.startOffset);j.splice(n--,1);continue}}}var o=j[n];var p=this.document.$.createRange();var l=o.startContainer;if(o.collapsed&&(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900))&&l.type==CKEDITOR.NODE_ELEMENT&&!l.getChildCount()){l.appendText("")}p.setStart(l.$,o.startOffset);try{p.setEnd(o.endContainer.$,o.endOffset)}catch(q){p.setEnd(l.$,o.startOffset)}k.addRange(p)}this.reset()}},createBookmarks:function(j){return this.getRanges().createBookmarks(j)},createBookmarks2:function(j){return this.getRanges().createBookmarks2(j)},selectBookmarks:function(m){var j=[];for(var l=0;l<m.length;l++){var k=new CKEDITOR.dom.range(this.document);k.moveToBookmark(m[l]);j.push(k)}this.selectRanges(j);return this},getCommonAncestor:function(){var k=this.getRanges(),l=k[0].startContainer,j=k[k.length-1].endContainer;return l.getCommonAncestor(j)},scrollIntoView:function(){var j=this.getStartElement();j.scrollIntoView()}}})();(function(){var a=CKEDITOR.dom.walker.whitespaces(true),b=/\ufeff|\u00a0/,c={table:1,tbody:1,tr:1};CKEDITOR.dom.range.prototype.select=CKEDITOR.env.ie?function(f){var h=this.collapsed;var o;var k;if(this.startContainer.type==CKEDITOR.NODE_ELEMENT&&this.startContainer.getName() in c||this.endContainer.type==CKEDITOR.NODE_ELEMENT&&this.endContainer.getName() in c){this.shrink(CKEDITOR.NODE_ELEMENT,true)}var n=this.createBookmark();var g=n.startNode;var l;if(!h){l=n.endNode}var d=this.document.$.body.createTextRange();d.moveToElementText(g.$);d.moveStart("character",1);if(l){var m=this.document.$.body.createTextRange();m.moveToElementText(l.$);d.setEndPoint("EndToEnd",m);d.moveEnd("character",-1)}else{var j=g.getNext(a);o=(!(j&&j.getText&&j.getText().match(b))&&(f||!g.hasPrevious()||(g.getPrevious().is&&g.getPrevious().is("br"))));k=this.document.createElement("span");k.setHtml("&#65279;");k.insertBefore(g);if(o){this.document.createText("\ufeff").insertBefore(g)}}this.setStartBefore(g);g.remove();if(h){if(o){d.moveStart("character",-1);d.select();this.document.$.selection.clear()}else{d.select()}this.moveToPosition(k,CKEDITOR.POSITION_BEFORE_START);k.remove()}else{this.setEndBefore(l);l.remove();d.select()}this.document.fire("selectionchange")}:function(){var f=this.startContainer;if(this.collapsed&&f.type==CKEDITOR.NODE_ELEMENT&&!f.getChildCount()){f.append(new CKEDITOR.dom.text(""))}var g=this.document.$.createRange();g.setStart(f.$,this.startOffset);try{g.setEnd(this.endContainer.$,this.endOffset)}catch(h){if(h.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0){this.collapse(true);g.setEnd(this.endContainer.$,this.endOffset)}else{throw (h)}}var d=this.document.getSelection().getNative();d.removeAllRanges();d.addRange(g)}})();(function(){var a={elements:{$:function(h){var g=h.attributes,j=g&&g["data-cke-realelement"],f=j&&new CKEDITOR.htmlParser.fragment.fromHtml(decodeURIComponent(j)),d=f&&f.children[0];if(d&&h.attributes["data-cke-resizable"]){var b=h.attributes.style;if(b){var k=/(?:^|\s)width\s*:\s*(\d+)/i.exec(b),c=k&&k[1];k=/(?:^|\s)height\s*:\s*(\d+)/i.exec(b);var l=k&&k[1];if(c){d.attributes.width=c}if(l){d.attributes.height=l}}}return d}}};CKEDITOR.plugins.add("fakeobjects",{requires:["htmlwriter"],afterInit:function(c){var b=c.dataProcessor,d=b&&b.htmlFilter;if(d){d.addRules(a)}}})})();CKEDITOR.editor.prototype.createFakeElement=function(c,d,f,g){var h=this.lang.fakeobjects,b=h[f]||h.unknown;var a={"class":d,src:CKEDITOR.getUrl("images/spacer.gif"),"data-cke-realelement":encodeURIComponent(c.getOuterHtml()),"data-cke-real-node-type":c.type,alt:b,title:b,align:c.getAttribute("align")||""};if(f){a["data-cke-real-element-type"]=f}if(g){a["data-cke-resizable"]=g}return this.document.createElement("img",{attributes:a})};CKEDITOR.editor.prototype.createFakeParserElement=function(c,h,k,a){var b=this.lang.fakeobjects,j=b[k]||b.unknown,g;var d=new CKEDITOR.htmlParser.basicWriter();c.writeHtml(d);g=d.getHtml();var f={"class":h,src:CKEDITOR.getUrl("images/spacer.gif"),"data-cke-realelement":encodeURIComponent(g),"data-cke-real-node-type":c.type,alt:j,title:j,align:c.attributes.align||""};if(k){f["data-cke-real-element-type"]=k}if(a){f["data-cke-resizable"]=a}return new CKEDITOR.htmlParser.element("img",f)};CKEDITOR.editor.prototype.restoreRealElement=function(a){if(a.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT){return null}return CKEDITOR.dom.element.createFromHtml(decodeURIComponent(a.data("cke-realelement")),this.document)};CKEDITOR.plugins.add("richcombo",{requires:["floatpanel","listblock","button"],beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}});CKEDITOR.UI_RICHCOMBO=3;CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(a){CKEDITOR.tools.extend(this,a,{title:a.label,modes:{wysiwyg:1}});var b=this.panel||{};delete this.panel;this.id=CKEDITOR.tools.getNextNumber();this.document=(b&&b.parent&&b.parent.getDocument())||CKEDITOR.document;b.className=(b.className||"")+" cke_rcombopanel";b.block={multiSelect:b.multiSelect,attributes:b.attributes};this._={panelDefinition:b,items:{},state:CKEDITOR.TRISTATE_OFF}},statics:{handler:{create:function(a){return new CKEDITOR.ui.richCombo(a)}}},proto:{renderHtml:function(b){var a=[];this.render(b,a);return a.join("")},render:function(d,b){var c=CKEDITOR.env;var h="cke_"+this.id;var g=CKEDITOR.tools.addFunction(function(j){var k=this._;if(k.state==CKEDITOR.TRISTATE_DISABLED){return}this.createPanel(d);if(k.on){k.panel.hide();return}this.commit();var l=this.getValue();if(l){k.list.mark(l)}else{k.list.unmarkAll()}k.panel.showBlock(this.id,new CKEDITOR.dom.element(j),4)},this);var a={id:h,combo:this,focus:function(){var j=CKEDITOR.document.getById(h).getChild(1);j.focus()},clickFn:g};d.on("mode",function(){this.setState(this.modes[d.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)},this);var f=CKEDITOR.tools.addFunction(function(k,j){k=new CKEDITOR.dom.event(k);var l=k.getKeystroke();switch(l){case 13:case 32:case 40:CKEDITOR.tools.callFunction(g,j);break;default:a.onkey(a,l)}k.preventDefault()});a.keyDownFn=f;b.push('<span class="cke_rcombo">',"<span id=",h);if(this.className){b.push(' class="',this.className,' cke_off"')}b.push(">",'<span id="'+h+'_label" class=cke_label>',this.label,"</span>",'<a hidefocus=true title="',this.title,'" tabindex="-1"',c.gecko&&c.version>=10900&&!c.hc?"":" href=\"javascript:void('"+this.label+"')\"",' role="button" aria-labelledby="',h,'_label" aria-describedby="',h,'_text" aria-haspopup="true"');if(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.mac)){b.push(' onkeypress="return false;"')}if(CKEDITOR.env.gecko){b.push(' onblur="this.style.cssText = this.style.cssText;"')}b.push(' onkeydown="CKEDITOR.tools.callFunction( ',f,', event, this );" onclick="CKEDITOR.tools.callFunction(',g,', this); return false;"><span><span id="'+h+'_text" class="cke_text cke_inline_label">'+this.label+"</span></span><span class=cke_openbutton>"+(CKEDITOR.env.hc?"<span>&#9660;</span>":CKEDITOR.env.air?"&nbsp;":"")+"</span></a></span></span>");if(this.onRender){this.onRender()}return a},createPanel:function(b){if(this._.panel){return}var h=this._.panelDefinition,g=this._.panelDefinition.block,f=h.parent||CKEDITOR.document.getBody(),a=new CKEDITOR.ui.floatPanel(b,f,h),d=a.addListBlock(this.id,g),c=this;a.onShow=function(){b.fire("panelShow",{panel:this,me:c});if(c.className){this.element.getFirst().addClass(c.className+"_panel")}c.setState(CKEDITOR.TRISTATE_ON);d.focus(!c.multiSelect&&c.getValue());c._.on=1;if(c.onOpen){c.onOpen()}};a.onHide=function(j){if(c.className){this.element.getFirst().removeClass(c.className+"_panel")}c.setState(c.modes&&c.modes[b.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);c._.on=0;if(!j&&c.onClose){c.onClose()}};a.onEscape=function(){a.hide();c.document.getById("cke_"+c.id).getFirst().getNext().focus()};d.onClick=function(k,j){b.fire("panelClick",{panel:this,me:c,value:k});c.document.getWindow().focus();if(c.onClick){c.onClick.call(c,k,j)}if(j){c.setValue(k,c._.items[k])}else{c.setValue("")}a.hide()};this._.panel=a;this._.list=d;a.getBlock(this.id).onHide=function(){c._.on=0;c.setState(CKEDITOR.TRISTATE_OFF)};b.on("toolbartabswitch",function(){if(c._.on){a.hide()}});if(this.init){this.init()}},setValue:function(b,c){this._.value=b;var a=this.document.getById("cke_"+this.id+"_text");if(!(b||c)){c=this.label;a.addClass("cke_inline_label")}else{a.removeClass("cke_inline_label")}a.setHtml(typeof c!="undefined"?c:b)},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(a){this._.list.mark(a)},hideItem:function(a){this._.list.hideItem(a)},hideGroup:function(a){this._.list.hideGroup(a)},showAll:function(){this._.list.showAll()},add:function(b,a,c){this._.items[b]=c||b;this._.list.add(b,a,c)},startGroup:function(a){this._.list.startGroup(a)},commit:function(){if(!this._.committed){this._.list.commit();this._.committed=1;CKEDITOR.ui.fire("ready",this)}this._.committed=1},setState:function(a){if(this._.state==a){return}this.document.getById("cke_"+this.id).setState(a);this._.state=a}}});CKEDITOR.ui.prototype.addRichCombo=function(a,b){this.add(a,CKEDITOR.UI_RICHCOMBO,b)};CKEDITOR.plugins.add("htmlwriter");CKEDITOR.htmlWriter=CKEDITOR.tools.createClass({base:CKEDITOR.htmlParser.basicWriter,$:function(){this.base();this.indentationChars="\t";this.selfClosingEnd=" />";this.lineBreakChars="\n";this.forceSimpleAmpersand=0;this.sortAttributes=1;this._.indent=0;this._.indentation="";this._.inPre=0;this._.rules={};var a=CKEDITOR.dtd;for(var b in CKEDITOR.tools.extend({},a.$nonBodyContent,a.$block,a.$listItem,a.$tableContent)){this.setRules(b,{indent:1,breakBeforeOpen:1,breakAfterOpen:1,breakBeforeClose:!a[b]["#"],breakAfterClose:1})}this.setRules("br",{breakAfterOpen:1});this.setRules("title",{indent:0,breakAfterOpen:0});this.setRules("style",{indent:0,breakBeforeClose:1});this.setRules("pre",{indent:0})},proto:{openTag:function(b,a){var c=this._.rules[b];if(this._.indent){this.indentation()}else{if(c&&c.breakBeforeOpen){this.lineBreak();this.indentation()}}this._.output.push("<",b)},openTagClose:function(a,b){var c=this._.rules[a];if(b){this._.output.push(this.selfClosingEnd)}else{this._.output.push(">");if(c&&c.indent){this._.indentation+=this.indentationChars}}if(c&&c.breakAfterOpen){this.lineBreak()}a=="pre"&&(this._.inPre=1)},attribute:function(b,a){if(typeof a=="string"){this.forceSimpleAmpersand&&(a=a.replace(/&amp;/g,"&"));a=CKEDITOR.tools.htmlEncodeAttr(a)}this._.output.push(" ",b,'="',a,'"')},closeTag:function(a){var b=this._.rules[a];if(b&&b.indent){this._.indentation=this._.indentation.substr(this.indentationChars.length)}if(this._.indent){this.indentation()}else{if(b&&b.breakBeforeClose){this.lineBreak();this.indentation()}}this._.output.push("</",a,">");a=="pre"&&(this._.inPre=0);if(b&&b.breakAfterClose){this.lineBreak()}},text:function(a){if(this._.indent){this.indentation();!this._.inPre&&(a=CKEDITOR.tools.ltrim(a))}this._.output.push(a)},comment:function(a){if(this._.indent){this.indentation()}this._.output.push("<!--",a,"-->")},lineBreak:function(){if(!this._.inPre&&this._.output.length>0){this._.output.push(this.lineBreakChars)}this._.indent=1},indentation:function(){if(!this._.inPre){this._.output.push(this._.indentation)}this._.indent=0},setRules:function(a,c){var b=this._.rules[a];if(b){CKEDITOR.tools.extend(b,c,true)}else{this._.rules[a]=c}}}});CKEDITOR.plugins.add("menubutton",{requires:["button","menu"],beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_MENUBUTTON,CKEDITOR.ui.menuButton.handler)}});CKEDITOR.UI_MENUBUTTON=5;(function(){var a=function(c){var b=this._;if(b.state===CKEDITOR.TRISTATE_DISABLED){return}b.previousState=b.state;var d=b.menu;if(!d){d=b.menu=new CKEDITOR.menu(c,{panel:{className:c.skinClass+" cke_contextmenu",attributes:{"aria-label":c.lang.common.options}}});d.onHide=CKEDITOR.tools.bind(function(){this.setState(this.modes&&this.modes[c.mode]?b.previousState:CKEDITOR.TRISTATE_DISABLED)},this);if(this.onMenu){d.addListener(this.onMenu)}}if(b.on){d.hide();return}this.setState(CKEDITOR.TRISTATE_ON);d.show(CKEDITOR.document.getById(this._.id),4)};CKEDITOR.ui.menuButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(b){var c=b.panel;delete b.panel;this.base(b);this.hasArrow=true;this.click=a},statics:{handler:{create:function(b){return new CKEDITOR.ui.menuButton(b)}}}})})();CKEDITOR.plugins.add("dialogui");(function(){var h=function(m){this._||(this._={});this._["default"]=this._.initValue=m["default"]||"";this._.required=m.required||false;var k=[this._];for(var l=1;l<arguments.length;l++){k.push(arguments[l])}k.push(true);CKEDITOR.tools.extend.apply(CKEDITOR.tools,k);return this._},a={build:function(l,m,k){return new CKEDITOR.ui.dialog.textInput(l,m,k)}},d={build:function(l,m,k){return new CKEDITOR.ui.dialog[m.type](l,m,k)}},g={build:function(q,k,n){var m=k.children,l,s=[],r=[];for(var p=0;(p<m.length&&(l=m[p]));p++){var o=[];s.push(o);r.push(CKEDITOR.dialog._.uiElementBuilders[l.type].build(q,l,o))}return new CKEDITOR.ui.dialog[k.type](q,r,s,n,k)}},c={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(k){this.setValue(this.getInitValue(),k)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._["default"]},getInitValue:function(){return this._.initValue}},b=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(k,l){if(!this._.domOnChangeRegistered){k.on("load",function(){this.getInputElement().on("change",function(){if(!k.parts.dialog.isVisible()){return}this.fire("change",{value:this.getValue()})},this)},this);this._.domOnChangeRegistered=true}this.on("change",l)}},true),j=/^on([A-Z]\w+)/,f=function(l){for(var k in l){if(j.test(k)||k=="title"||k=="type"){delete l[k]}}return l};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(m,q,n,o){if(arguments.length<4){return}var k=h.call(this,q);k.labelId=CKEDITOR.tools.getNextId()+"_label";var l=this._.children=[];var p=function(){var u=[],r=q.required?" cke_required":"";if(q.labelLayout!="horizontal"){u.push('<label class="cke_dialog_ui_labeled_label'+r+'" ',' id="'+k.labelId+'"',' for="'+k.inputId+'"',' style="'+q.labelStyle+'">',q.label,"</label>",'<div class="cke_dialog_ui_labeled_content" role="presentation">',o.call(this,m,q),"</div>")}else{var s={type:"hbox",widths:q.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+r+'" id="'+k.labelId+'" for="'+k.inputId+'" style="'+q.labelStyle+'">'+CKEDITOR.tools.htmlEncode(q.label)+"</span>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content">'+o.call(this,m,q)+"</span>"}]};CKEDITOR.dialog._.uiElementBuilders.hbox.build(m,s,u)}return u.join("")};CKEDITOR.ui.dialog.uiElement.call(this,m,q,n,"div",null,{role:"presentation"},p)},textInput:function(p,k,l){if(arguments.length<3){return}h.call(this,k);var m=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",n={"class":"cke_dialog_ui_input_"+k.type,id:m,type:"text"},o;if(k.validate){this.validate=k.validate}if(k.maxLength){n.maxlength=k.maxLength}if(k.size){n.size=k.size}if(k.controlStyle){n.style=k.controlStyle}var q=this,s=false;p.on("load",function(){q.getInputElement().on("keydown",function(u){if(u.data.getKeystroke()==13){s=true}});q.getInputElement().on("keyup",function(u){if(u.data.getKeystroke()==13&&s){p.getButton("ok")&&setTimeout(function(){p.getButton("ok").click()},0);s=false}},null,null,1000)});var r=function(){var v=['<div class="cke_dialog_ui_input_',k.type,'" role="presentation"'];if(k.width){v.push('style="width:'+k.width+'" ')}v.push("><input ");n["aria-labelledby"]=this._.labelId;this._.required&&(n["aria-required"]=this._.required);for(var u in n){v.push(u+'="'+n[u]+'" ')}v.push(" /></div>");return v.join("")};CKEDITOR.ui.dialog.labeledElement.call(this,p,k,l,r)},textarea:function(l,q,o){if(arguments.length<3){return}h.call(this,q);var m=this,n=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",k={};if(q.validate){this.validate=q.validate}k.rows=q.rows||5;k.cols=q.cols||20;var p=function(){k["aria-labelledby"]=this._.labelId;this._.required&&(k["aria-required"]=this._.required);var s=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea class="cke_dialog_ui_input_textarea" id="',n,'" '];for(var r in k){s.push(r+'="'+CKEDITOR.tools.htmlEncode(k[r])+'" ')}s.push(">",CKEDITOR.tools.htmlEncode(m._["default"]),"</textarea></div>");return s.join("")};CKEDITOR.ui.dialog.labeledElement.call(this,l,q,o,p)},checkbox:function(l,o,m){if(arguments.length<3){return}var k=h.call(this,o,{"default":!!o["default"]});if(o.validate){this.validate=o.validate}var n=function(){var r=CKEDITOR.tools.extend({},o,{id:o.id?o.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},true),q=[];var s=CKEDITOR.tools.getNextId()+"_label";var p={"class":"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":s};f(r);if(o["default"]){p.checked="checked"}if(typeof r.controlStyle!="undefined"){r.style=r.controlStyle}k.checkbox=new CKEDITOR.ui.dialog.uiElement(l,r,q,"input",null,p);q.push(' <label id="',s,'" for="',p.id,'">',CKEDITOR.tools.htmlEncode(o.label),"</label>");return q.join("")};CKEDITOR.ui.dialog.uiElement.call(this,l,o,m,"span",null,null,n)},radio:function(l,p,n){if(arguments.length<3){return}h.call(this,p);if(!this._["default"]){this._["default"]=this._.initValue=p.items[0][1]}if(p.validate){this.validate=p.valdiate}var k=[],m=this;var o=function(){var C=[],v=[],B={"class":"cke_dialog_ui_radio_item","aria-labelledby":this._.labelId},s=p.id?p.id+"_radio":CKEDITOR.tools.getNextId()+"_radio";for(var u=0;u<p.items.length;u++){var D=p.items[u],y=D[2]!==undefined?D[2]:D[0],A=D[1]!==undefined?D[1]:D[0],z=CKEDITOR.tools.getNextId()+"_radio_input",r=z+"_label",w=CKEDITOR.tools.extend({},p,{id:z,title:null,type:null},true),q=CKEDITOR.tools.extend({},w,{title:y},true),x={type:"radio","class":"cke_dialog_ui_radio_input",name:s,value:A,"aria-labelledby":r},E=[];if(m._["default"]==A){x.checked="checked"}f(w);f(q);if(typeof w.controlStyle!="undefined"){w.style=w.controlStyle}k.push(new CKEDITOR.ui.dialog.uiElement(l,w,E,"input",null,x));E.push(" ");new CKEDITOR.ui.dialog.uiElement(l,q,E,"label",null,{id:r,"for":x.id},D[0]);C.push(E.join(""))}new CKEDITOR.ui.dialog.hbox(l,[],C,v);return v.join("")};CKEDITOR.ui.dialog.labeledElement.call(this,l,p,n,o);this._.children=k},button:function(k,p,n){if(!arguments.length){return}if(typeof p=="function"){p=p(k.getParentEditor())}h.call(this,p,{disabled:p.disabled||false});CKEDITOR.event.implementOn(this);var l=this;k.on("load",function(r){var q=this.getElement();(function(){q.on("click",function(s){l.fire("click",{dialog:l.getDialog()});s.data.preventDefault()});q.on("keydown",function(s){if(s.data.getKeystroke() in {32:1}){l.click();s.data.preventDefault()}})})();q.unselectable()},this);if(typeof p["class"]!="undefined"){p["class"]=p["class"].replace(/cke_dialog_ui_button_cancel/,"secondary").replace(/cke_dialog_ui_button_(\w+)/,"")+" wikia-button"}if(typeof p.className!="undefined"){p.className+=" wikia-button";if(typeof p.buttonType!="undefined"){p.className+=" "+p.buttonType}}else{p.className="wikia-button"}var o=CKEDITOR.tools.extend({},p);delete o.style;var m=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,k,o,n,"a",null,{style:p.style,href:"javascript:void(0)",title:p.label,hidefocus:"true","class":p["class"],role:"button","aria-labelledby":m},'<span id="'+m+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(p.label)+"</span>")},select:function(l,o,m){if(arguments.length<3){return}var k=h.call(this,o);if(o.validate){this.validate=o.validate}k.inputId=CKEDITOR.tools.getNextId()+"_select";var n=function(){var s=CKEDITOR.tools.extend({},o,{id:o.id?o.id+"_select":CKEDITOR.tools.getNextId()+"_select"},true),r=[],v=[],p={id:k.inputId,"class":"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};if(o.size!=undefined){p.size=o.size}if(o.multiple!=undefined){p.multiple=o.multiple}f(s);for(var q=0,u;q<o.items.length&&(u=o.items[q]);q++){v.push('<option value="',CKEDITOR.tools.htmlEncode(u[1]!==undefined?u[1]:u[0]),'" /> ',CKEDITOR.tools.htmlEncode(u[0]))}if(typeof s.controlStyle!="undefined"){s.style=s.controlStyle}k.select=new CKEDITOR.ui.dialog.uiElement(l,s,r,"select",null,p,v.join(""));return r.join("")};CKEDITOR.ui.dialog.labeledElement.call(this,l,o,m,n)},file:function(l,o,m){if(arguments.length<3){return}if(o["default"]===undefined){o["default"]=""}var k=CKEDITOR.tools.extend(h.call(this,o),{definition:o,buttons:[]});if(o.validate){this.validate=o.validate}var n=function(){k.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var p=CKEDITOR.env.isCustomDomain();var q=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" id="',k.frameId,'" title="',o.label,'" src="javascript:void('];q.push(p?"(function(){document.open();document.domain='"+document.domain+"';document.close();})()":"0");q.push(')"></iframe>');return q.join("")};l.on("load",function(){var q=CKEDITOR.document.getById(k.frameId),p=q.getParent();p.addClass("cke_dialog_ui_input_file")});CKEDITOR.ui.dialog.labeledElement.call(this,l,o,m,n)},fileButton:function(m,q,o){if(arguments.length<3){return}var k=h.call(this,q),n=this;if(q.validate){this.validate=q.validate}var l=CKEDITOR.tools.extend({},q);var p=l.onClick;l.className=(l.className?l.className+" ":"")+"cke_dialog_ui_button";l.onClick=function(r){var s=q["for"];if(!p||p.call(this,r)!==false){m.getContentElement(s[0],s[1]).submit();this.disable()}};m.on("load",function(){m.getContentElement(q["for"][0],q["for"][1])._.buttons.push(n)});CKEDITOR.ui.dialog.button.call(this,m,l,o)},html:(function(){var m=/^\s*<[\w:]+\s+([^>]*)?>/,l=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,k=/\/$/;return function(v,n,o){if(arguments.length<3){return}var q=[],x,r=n.html,s,w;if(r.charAt(0)!="<"){r="<span>"+r+"</span>"}var y=n.focus;if(y){var p=this.focus;this.focus=function(){p.call(this);typeof y=="function"&&y.call(this);this.fire("focus")};if(n.isFocusable){var u=this.isFocusable;this.isFocusable=u}this.keyboardFocusable=true}CKEDITOR.ui.dialog.uiElement.call(this,v,n,q,"span",null,null,"");x=q.join("");s=x.match(m);w=r.match(l)||["","",""];if(k.test(w[1])){w[1]=w[1].slice(0,-1);w[2]="/"+w[2]}o.push([w[1]," ",s[1]||"",w[2]].join(""))}})(),fieldset:function(k,q,p,m,o){var l=o.label;var n=function(){var s=[];l&&s.push("<legend>"+l+"</legend>");for(var r=0;r<p.length;r++){s.push(p[r])}return s.join("")};this._={children:q};CKEDITOR.ui.dialog.uiElement.call(this,k,o,m,"fieldset",null,null,n)}},true);CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement;CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(k){var l=CKEDITOR.document.getById(this._.labelId);if(l.getChildCount()<1){(new CKEDITOR.dom.text(k,CKEDITOR.document)).appendTo(l)}else{l.getChild(0).$.nodeValue=k}return this},getLabel:function(){var k=CKEDITOR.document.getById(this._.labelId);if(!k||k.getChildCount()<1){return""}else{return k.getChild(0).getText()}},eventProcessors:b},true);CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){if(!this._.disabled){return this.fire("click",{dialog:this._.dialog})}this.getElement().$.blur();return false},enable:function(){this._.disabled=false;var k=this.getElement();k&&k.removeClass("cke_disabled")},disable:function(){this._.disabled=true;this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return !this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(k,l){this.on("click",l)}},true),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:true},true);CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var k=this.selectParentTab();setTimeout(function(){var l=k.getInputElement();l&&l.$.focus()},0)},select:function(){var k=this.selectParentTab();setTimeout(function(){var l=k.getInputElement();if(l){l.$.focus();l.$.select()}},0)},accessKeyUp:function(){this.select()},setValue:function(k){!k&&(k="");return CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},keyboardFocusable:true},c,true);CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput();CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(m,o,l){var n=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),k=this.getInputElement().$;n.$.text=m;n.$.value=(o===undefined||o===null)?m:o;if(l===undefined||l===null){if(CKEDITOR.env.ie){k.add(n.$)}else{k.add(n.$,null)}}else{k.add(n.$,l)}return this},remove:function(l){var k=this.getInputElement().$;k.remove(l);return this},clear:function(){var k=this.getInputElement().$;while(k.length>0){k.remove(0)}return this},keyboardFocusable:true},c,true);CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(l,k){this.getInputElement().$.checked=l;!k&&this.fire("change",{value:l})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(k,l){if(!CKEDITOR.env.ie){return b.onChange.apply(this,arguments)}else{k.on("load",function(){var m=this._.checkbox.getElement();m.on("propertychange",function(n){n=n.data.$;if(n.propertyName=="checked"){this.fire("change",{value:m.$.checked})}},this)},this);this.on("change",l)}return null}},keyboardFocusable:true},c,true);CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(o,n){var l=this._.children,m;for(var k=0;(k<l.length)&&(m=l[k]);k++){m.getElement().$.checked=(m.getValue()==o)}!n&&this.fire("change",{value:o})},getValue:function(){var l=this._.children;for(var k=0;k<l.length;k++){if(l[k].getElement().$.checked){return l[k].getValue()}}return null},accessKeyUp:function(){var l=this._.children,k;for(k=0;k<l.length;k++){if(l[k].getElement().$.checked){l[k].getElement().focus();return}}l[0].getElement().focus()},eventProcessors:{onChange:function(k,l){if(!CKEDITOR.env.ie){return b.onChange.apply(this,arguments)}else{k.on("load",function(){var o=this._.children,p=this;for(var n=0;n<o.length;n++){var m=o[n].getElement();m.on("propertychange",function(q){q=q.data.$;if(q.propertyName=="checked"&&this.$.checked){p.fire("change",{value:this.getAttribute("value")})}})}},this);this.on("change",l)}return null}},keyboardFocusable:true},c,true);CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,c,{getInputElement:function(){var k=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return k.$.forms.length>0?new CKEDITOR.dom.element(k.$.forms[0].elements[0]):this.getElement()},submit:function(){this.getInputElement().getParent().$.submit();return this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(m){var n=/^on([A-Z]\w+)/,k;var o=function(q,r,p,s){q.on("formLoaded",function(){q.getInputElement().on(p,s,q)})};for(var l in m){if(!(k=l.match(n))){continue}if(this.eventProcessors[l]){this.eventProcessors[l].call(this,this._.dialog,m[l])}else{o(this,this._.dialog,k[1].toLowerCase(),m[l])}}return this},reset:function(){var u=this._,p=CKEDITOR.document.getById(u.frameId),r=p.getFrameDocument(),k=u.definition,s=u.buttons,n=this.formLoadedNumber,o=this.formUnloadNumber,l=u.dialog._.editor.lang.dir,q=u.dialog._.editor.langCode;if(!n){n=this.formLoadedNumber=CKEDITOR.tools.addFunction(function(){this.fire("formLoaded")},this);o=this.formUnloadNumber=CKEDITOR.tools.addFunction(function(){this.getInputElement().clearCustomData()},this);this.getDialog()._.editor.on("destroy",function(){CKEDITOR.tools.removeFunction(n);CKEDITOR.tools.removeFunction(o)})}function m(){r.$.open();if(CKEDITOR.env.isCustomDomain()){r.$.domain=document.domain}var w="";if(k.size){w=k.size-(CKEDITOR.env.ie?7:0)}r.$.write(['<html dir="'+l+'" lang="'+q+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+l+'" lang="'+q+'" action="',CKEDITOR.tools.htmlEncode(k.action),'">','<input type="file" name="',CKEDITOR.tools.htmlEncode(k.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(w>0?w:""),'" />',"</form>","</body></html>","<script>window.parent.CKEDITOR.tools.callFunction("+n+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+o+")}<\/script>"].join(""));r.$.close();for(var v=0;v<s.length;v++){s[v].enable()}}if(CKEDITOR.env.gecko){setTimeout(m,500)}else{m()}},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(k,l){if(!this._.domOnChangeRegistered){this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this);this._.domOnChangeRegistered=true}this.on("change",l)}},keyboardFocusable:true},true);CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button;CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype);CKEDITOR.dialog.addUIElement("text",a);CKEDITOR.dialog.addUIElement("password",a);CKEDITOR.dialog.addUIElement("textarea",d);CKEDITOR.dialog.addUIElement("checkbox",d);CKEDITOR.dialog.addUIElement("radio",d);CKEDITOR.dialog.addUIElement("button",d);CKEDITOR.dialog.addUIElement("select",d);CKEDITOR.dialog.addUIElement("file",d);CKEDITOR.dialog.addUIElement("fileButton",d);CKEDITOR.dialog.addUIElement("html",d);CKEDITOR.dialog.addUIElement("fieldset",g)})();CKEDITOR.plugins.add("panel",{beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_PANEL,CKEDITOR.ui.panel.handler)}});CKEDITOR.UI_PANEL=2;CKEDITOR.ui.panel=function(a,b){if(b){CKEDITOR.tools.extend(this,b)}CKEDITOR.tools.extend(this,{className:"",css:[]});this.id=CKEDITOR.tools.getNextId();this.document=a;this._={blocks:{}}};CKEDITOR.ui.panel.handler={create:function(a){return new CKEDITOR.ui.panel(a)}};CKEDITOR.ui.panel.prototype={renderHtml:function(b){var a=[];this.render(b,a);return a.join("")},render:function(b,a){var c=this.id;a.push('<div class="',b.skinClass,'" lang="',b.langCode,'" role="presentation" style="display:none;z-index:'+(b.config.baseFloatZIndex+1)+'"><div id=',c," dir=",b.lang.dir,' role="presentation" class="cke_panel cke_',b.lang.dir);if(this.className){a.push(" ",this.className)}a.push('">');if(this.forceIFrame||this.css.length){a.push('<iframe id="',c,'_frame" frameborder="0" role="application" src="javascript:void(');a.push(CKEDITOR.env.isCustomDomain()?"(function(){document.open();document.domain='"+document.domain+"';document.close();})()":"0");a.push(')"></iframe>')}a.push("</div></div>");return c},getHolderElement:function(){var k=this._.holder;if(!k){if(this.forceIFrame||this.css.length){var c=this.document.getById(this.id+"_frame"),a=c.getParent(),b=a.getAttribute("dir"),h=a.getParent().getAttribute("class"),g=a.getParent().getAttribute("lang"),l=c.getFrameDocument();var j=CKEDITOR.tools.addFunction(CKEDITOR.tools.bind(function(m){this.isLoaded=true;if(this.onLoad){this.onLoad()}},this));var d='<!DOCTYPE html><html dir="'+b+'" class="'+h+'_container" lang="'+g+'"><head><style>.'+h+'_container{visibility:hidden}</style></head><body class="cke_'+b+" cke_panel_frame "+CKEDITOR.env.cssClass+'" style="margin:0;padding:0" onload="( window.CKEDITOR || window.parent.CKEDITOR ).tools.callFunction('+j+');"></body>'+CKEDITOR.tools.buildStyleHtml(this.css)+"</html>";l.write(d);var f=l.getWindow();f.$.CKEDITOR=CKEDITOR;l.on("key"+(CKEDITOR.env.opera?"press":"down"),function(m){var o=m.data.getKeystroke(),n=this.document.getById(this.id).getAttribute("dir");if(this._.onKeyDown&&this._.onKeyDown(o)===false){m.data.preventDefault();return}if(o==27||o==(n=="rtl"?39:37)){if(this.onEscape&&this.onEscape(o)===false){m.data.preventDefault()}}},this);k=l.getBody();k.unselectable();CKEDITOR.env.air&&CKEDITOR.tools.callFunction(j)}else{k=this.document.getById(this.id)}this._.holder=k}return k},addBlock:function(a,b){b=this._.blocks[a]=b instanceof CKEDITOR.ui.panel.block?b:new CKEDITOR.ui.panel.block(this.getHolderElement(),b);if(!this._.currentBlock){this.showBlock(a)}return b},getBlock:function(a){return this._.blocks[a]},showBlock:function(a){var f=this._.blocks,d=f[a],c=this._.currentBlock,b=this.forceIFrame?this.document.getById(this.id+"_frame"):this._.holder;b.getParent().getParent().disableContextMenu();if(c){b.removeAttributes(c.attributes);c.hide()}this._.currentBlock=d;b.setAttributes(d.attributes);CKEDITOR.fire("ariaWidget",b);d._.focusIndex=-1;this._.onKeyDown=d.onKeyDown&&CKEDITOR.tools.bind(d.onKeyDown,d);d.onMark=function(g){b.setAttribute("aria-activedescendant",g.getId()+"_option")};d.onUnmark=function(){b.removeAttribute("aria-activedescendant")};d.show();return d},destroy:function(){this.element&&this.element.remove()}};CKEDITOR.ui.panel.block=CKEDITOR.tools.createClass({$:function(a,b){this.element=a.append(a.getDocument().createElement("div",{attributes:{tabIndex:-1,"class":"cke_panel_block",role:"presentation"},styles:{display:"none"}}));if(b){CKEDITOR.tools.extend(this,b)}if(!this.attributes.title){this.attributes.title=this.attributes["aria-label"]}this.keys={};this._.focusIndex=-1;this.element.disableContextMenu()},_:{markItem:function(b){if(b==-1){return}var a=this.element.getElementsByTag("a");var c=a.getItem(this._.focusIndex=b);if(CKEDITOR.env.webkit||CKEDITOR.env.opera){c.getDocument().getWindow().focus()}c.focus();this.onMark&&this.onMark(c)}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){if(!this.onHide||this.onHide.call(this)!==true){this.element.setStyle("display","none")}},onKeyDown:function(f){var c=this.keys[f];switch(c){case"next":var b=this._.focusIndex,a=this.element.getElementsByTag("a"),d;while((d=a.getItem(++b))){if(d.getAttribute("_cke_focus")&&d.$.offsetWidth){this._.focusIndex=b;d.focus();break}}return false;case"prev":b=this._.focusIndex;a=this.element.getElementsByTag("a");while(b>0&&(d=a.getItem(--b))){if(d.getAttribute("_cke_focus")&&d.$.offsetWidth){this._.focusIndex=b;d.focus();break}}return false;case"click":b=this._.focusIndex;d=b>=0&&this.element.getElementsByTag("a").getItem(b);if(d){d.$.click?d.$.click():d.$.onclick()}return false}return true}}});CKEDITOR.plugins.add("listblock",{requires:["panel"],onLoad:function(){CKEDITOR.ui.panel.prototype.addListBlock=function(a,b){return this.addBlock(a,new CKEDITOR.ui.listBlock(this.getHolderElement(),b))};CKEDITOR.ui.listBlock=CKEDITOR.tools.createClass({base:CKEDITOR.ui.panel.block,$:function(a,c){c=c||{};var d=c.attributes||(c.attributes={});(this.multiSelect=!!c.multiSelect)&&(d["aria-multiselectable"]=true);!d.role&&(d.role="listbox");this.base.apply(this,arguments);var b=this.keys;b[40]="next";b[9]="next";b[38]="prev";b[CKEDITOR.SHIFT+9]="prev";b[32]="click";this._.pendingHtml=[];this._.items={};this._.groups={}},_:{close:function(){if(this._.started){this._.pendingHtml.push("</ul>");delete this._.started}},getClick:function(){if(!this._.click){this._.click=CKEDITOR.tools.addFunction(function(b){var a=true;if(this.multiSelect){a=this.toggle(b)}else{this.mark(b)}if(this.onClick){this.onClick(b,a)}},this)}return this._.click}},proto:{add:function(c,a,d){var b=this._.pendingHtml,f=CKEDITOR.tools.getNextId();if(!this._.started){b.push('<ul role="presentation" class=cke_panel_list>');this._.started=1;this._.size=this._.size||0}this._.items[c]=f;b.push("<li id=",f,' class=cke_panel_listItem role=presentation><a id="',f,'_option" _cke_focus=1 hidefocus=true title="',d||c,'" href="javascript:void(\'',c,'\')" onclick="CKEDITOR.tools.callFunction(',this._.getClick(),",'",c,"'); return false;\"",' role="option" aria-posinset="'+(++this._.size)+'">',a||c,"</a></li>")},startGroup:function(a){this._.close();var b=CKEDITOR.tools.getNextId();this._.groups[a]=b;this._.pendingHtml.push('<h1 role="presentation" id=',b," class=cke_panel_grouptitle>",a,"</h1>")},commit:function(){this._.close();this.element.appendHtml(this._.pendingHtml.join(""));var a=this._.items,c=this.element.getDocument();for(var b in a){c.getById(a[b]+"_option").setAttribute("aria-setsize",this._.size)}delete this._.size;this._.pendingHtml=[]},toggle:function(b){var a=this.isMarked(b);if(a){this.unmark(b)}else{this.mark(b)}return !a},hideGroup:function(a){var c=this.element.getDocument().getById(this._.groups[a]),b=c&&c.getNext();if(c){c.setStyle("display","none");if(b&&b.getName()=="ul"){b.setStyle("display","none")}}},hideItem:function(a){this.element.getDocument().getById(this._.items[a]).setStyle("display","none")},showAll:function(){var b=this._.items,a=this._.groups,g=this.element.getDocument();for(var d in b){g.getById(b[d]).setStyle("display","")}for(var h in a){var f=g.getById(a[h]),c=f.getNext();f.setStyle("display","");if(c&&c.getName()=="ul"){c.setStyle("display","")}}},mark:function(b){if(!this.multiSelect){this.unmarkAll()}var c=this._.items[b],a=this.element.getDocument().getById(c);a.addClass("cke_selected");this.element.getDocument().getById(c+"_option").setAttribute("aria-selected",true);this.element.setAttribute("aria-activedescendant",c+"_option");this.onMark&&this.onMark(a)},unmark:function(a){this.element.getDocument().getById(this._.items[a]).removeClass("cke_selected");this.onUnmark&&this.onUnmark(this._.items[a])},unmarkAll:function(){var a=this._.items,c=this.element.getDocument();for(var b in a){c.getById(a[b]).removeClass("cke_selected")}this.onUnmark&&this.onUnmark()},isMarked:function(a){return this.element.getDocument().getById(this._.items[a]).hasClass("cke_selected")},focus:function(f){this._.focusIndex=-1;if(f){var c=this.element.getDocument().getById(this._.items[f]).getFirst();var a=this.element.getElementsByTag("a"),d,b=-1;while((d=a.getItem(++b))){if(d.equals(c)){this._.focusIndex=b;break}}setTimeout(function(){c.focus()},0)}}}})}});CKEDITOR.themes.add("default",(function(){function a(h,d){var c,g;g=h.config.sharedSpaces;g=g&&g[d];g=g&&CKEDITOR.document.getById(g);if(g){var f='<span class="cke_shared"><span class="'+h.skinClass+" "+h.id+" cke_editor_"+h.name+'"><span class="'+CKEDITOR.env.cssClass+'"><span class="cke_wrapper cke_'+h.lang.dir+'"><span class="cke_editor"><div class="cke_'+d+'"></div></span></span></span></span></span>';var b=g.append(CKEDITOR.dom.element.createFromHtml(f,g.getDocument()));if(g.getCustomData("cke_hasshared")){b.hide()}else{g.setCustomData("cke_hasshared",1)}c=b.getChild([0,0,0,0]);!h.sharedSpaces&&(h.sharedSpaces={});h.sharedSpaces[d]=c;h.on("focus",function(){for(var k=0,l,j=g.getChildren();(l=j.getItem(k));k++){if(l.type==CKEDITOR.NODE_ELEMENT&&!l.equals(b)&&l.hasClass("cke_shared")){l.hide()}}b.show()});h.on("destroy",function(){b.remove()})}return c}return{build:function(m,l){var d=m.name,k=m.element,j=m.elementMode;if(!k||j==CKEDITOR.ELEMENT_MODE_NONE){return}if(j==CKEDITOR.ELEMENT_MODE_REPLACE){k.hide()}var f=m.fire("themeSpace",{space:"top",html:""}).html;var r=m.fire("themeSpace",{space:"contents",html:""}).html;var p=m.fireOnce("themeSpace",{space:"bottom",html:""}).html;var q=r&&m.config.height;var h=m.config.tabIndex||m.element.getAttribute("tabindex")||0;if(!r){q="auto"}else{if(!isNaN(q)){q+="px"}}var c="";var g=m.config.width;if(g){if(!isNaN(g)){g+="px"}c+="width: "+g+";"}var n=f&&a(m,"top"),o=a(m,"bottom");n&&(n.setHtml(f),f="");o&&(o.setHtml(p),p="");var b=CKEDITOR.dom.element.createFromHtml(['<span id="cke_',d,'" class="',m.skinClass," ",m.id," cke_editor_",d,'" dir="',m.lang.dir,'" title="',(CKEDITOR.env.gecko?" ":""),'" lang="',m.langCode,'"'+(CKEDITOR.env.webkit?' tabindex="'+h+'"':"")+' role="application" aria-labelledby="cke_',d,'_arialbl"'+(c?' style="'+c+'"':"")+'><span id="cke_',d,'_arialbl" class="cke_voice_label">'+m.lang.editor+'</span><span class="',CKEDITOR.env.cssClass,'" role="presentation"><span class="cke_wrapper cke_',m.lang.dir,'" role="presentation"><table class="cke_editor" border="0" cellspacing="0" cellpadding="0" role="presentation"><tbody><tr',f?"":' style="display:none"',' role="presentation"><td id="cke_top_',d,'" class="cke_top" role="presentation">',f,"</td></tr><tr",r?"":' style="display:none"',' role="presentation"><td id="cke_contents_',d,'" class="cke_contents" style="height:',q,'" role="presentation">',r,"</td></tr><tr",p?"":' style="display:none"',' role="presentation"><td id="cke_bottom_',d,'" class="cke_bottom" role="presentation">',p,"</td></tr></tbody></table><style>.",m.skinClass,"{visibility:hidden;}</style></span></span></span>"].join(""));b.getChild([1,0,0,0,0]).unselectable();b.getChild([1,0,0,0,2]).unselectable();if(j==CKEDITOR.ELEMENT_MODE_REPLACE){b.insertAfter(k)}else{k.append(b)}m.container=b;b.disableContextMenu();m.fireOnce("themeLoaded");m.fireOnce("uiReady")},buildDialog:function(d){var h=CKEDITOR.tools.getNextNumber();var c=CKEDITOR.dom.element.createFromHtml(['<div class="',d.id,"_dialog cke_editor_",d.name.replace(".","\\."),"_dialog cke_skin_",d.skinName,'" dir="',d.lang.dir,'" lang="',d.langCode,'" role="dialog" aria-labelledby="%title#"><table class="cke_dialog'," "+CKEDITOR.env.cssClass," cke_",d.lang.dir,'" style="position:absolute" role="presentation"><tr><td role="presentation"><div class="%body" role="presentation"><div id="%title#" class="%title" role="presentation"></div><a id="%close_button#" class="%close_button" href="javascript:void(0)" title="'+d.lang.common.close+'" role="button"><span class="cke_label">X</span></a><div id="%tabs#" class="%tabs" role="tablist"></div><table class="%contents" role="presentation"><tr><td id="%contents#" class="%contents" role="presentation"></td></tr><tr><td id="%footer#" class="%footer" role="presentation"></td></tr></table></div><div id="%tl#" class="%tl"></div><div id="%tc#" class="%tc"></div><div id="%tr#" class="%tr"></div><div id="%ml#" class="%ml"></div><div id="%mr#" class="%mr"></div><div id="%bl#" class="%bl"></div><div id="%bc#" class="%bc"></div><div id="%br#" class="%br"></div></td></tr></table>',(CKEDITOR.env.ie?"":"<style>.cke_dialog{visibility:hidden;}</style>"),"</div>"].join("").replace(/#/g,"_"+h).replace(/%/g,"cke_dialog_"));var b=c.getChild([0,0,0,0,0]),g=b.getChild(0),f=b.getChild(1);g.unselectable();f.unselectable();return{element:c,parts:{dialog:c.getChild(0),title:g,close:f,tabs:b.getChild(2),contents:b.getChild([3,0,0,0]),footer:b.getChild([3,0,1,0])}}},destroy:function(c){var b=c.container;b.clearCustomData();c.element.clearCustomData();if(b){b.remove()}if(c.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE){c.element.show()}delete c.element}}})());CKEDITOR.editor.prototype.getThemeSpace=function(b){var a="cke_"+b;var c=this._[a]||(this._[a]=CKEDITOR.document.getById(a+"_"+this.name));return c};CKEDITOR.editor.prototype.resize=function(f,a,h,c){var b=this.container,g=CKEDITOR.document.getById("cke_contents_"+this.name),d=c?b.getChild(1):b;CKEDITOR.env.webkit&&d.setStyle("display","none");d.setSize("width",f,true);if(CKEDITOR.env.webkit){d.$.offsetWidth;d.setStyle("display","")}var j=h?0:(d.$.offsetHeight||0)-(g.$.clientHeight||0);g.setStyle("height",Math.max(a-j,0)+"px");this.fire("resize")};CKEDITOR.editor.prototype.getResizable=function(){return this.container.getChild(1)};window.RTE={config:{alignableElements:["p","div","td","th"],baseFloatZIndex:1000,bodyClass:"WikiaArticle",bodyId:"bodyContent",coreStyles_bold:{element:"b",overrides:"strong"},coreStyles_italic:{element:"i",overrides:"em"},customConfig:"",dialog_backgroundCoverColor:"#000",dialog_backgroundCoverOpacity:(window.skin=="oasis"?0.8:0.5),disableDragDrop:false,disableObjectResizing:true,entities:false,format_tags:"p;h2;h3;h4;h5;pre",height:400,language:window.wgUserLanguage,removePlugins:"about,elementspath,filebrowser,flash,forms,horizontalrule,image,justify,link,liststyle,maximize,newpage,pagebreak,toolbar,save,scayt,smiley,wsc",resize_enabled:false,skin:"wikia",startupFocus:CKEDITOR.env.gecko?false:true,theme:"wikia",toolbar:"Wikia",toolbarCanCollapse:false},instance:false,instanceId:window.RTEInstanceId,loaded:false,loadTime:false,stuffNode:false,plugins:["comment","dialog","dragdrop","edit-buttons","entities","first-run-notice","gallery","justify","link","linksuggest","media","modeswitch","overlay","paste","placeholder","signature","plbelement","template","temporary-save","toolbar","tools","track","widescreen","poll"],log:function(a){$().log(a,"RTE")},ajax:function(c,a,b){if(typeof a!="object"){a={}}a.method=c;jQuery.post(window.wgScript+"?action=ajax&rs=RTEAjax",a,function(d){if(typeof b=="function"){b(d)}},"json")},track:function(d,b,c){var a=["ckeditor"];for(i=0;i<arguments.length;i++){a.push(arguments[i])}if(typeof jQuery.tracker!="undefined"){jQuery.tracker.byStr(a.join("/"))}},init:function(a){CKEDITOR.timestamp=window.wgStyleVersion;CKEDITOR.dtd.pre.img=1;CKEDITOR.dtd.p.center=1;CKEDITOR.dtd.table.img=1;CKEDITOR.dtd.dt.ul=1;CKEDITOR.dtd.dt.ol=1;RTE.config.startupMode=a;RTE.config.disableDragDrop=(CKEDITOR.env.gecko&&(CKEDITOR.env.geckoRelease=="1.9.2.9"||CKEDITOR.env.geckoRelease=="1.9.2.10"));if(RTE.config.disableDragDrop){RTE.log("media drag&drop disabled")}RTE.loadPlugins();RTE.stuffNode=$("<div>",{id:"RTEStuff"}).appendTo("body");RTE.instance=CKEDITOR.replace("wpTextbox1",RTE.config);RTE.loadCss();CKEDITOR.on("instanceReady",RTE.onEditorReady);RTE.instance.on("modeSwitch",function(){RTE.modeSwitch(RTE.instance.mode)});RTE.instance.on("mode",function(){RTE.loading(false);RTE.log('mode "'+this.mode+'" is loaded')});RTE.instance.on("dataReady",function(){if(this.mode=="wysiwyg"){this.fire("wysiwygModeReady")}});RTE.instance.on("wysiwygModeReady",RTE.onWysiwygModeReady);RTE.instance.on("afterUndo",function(){RTE.instance.fire("wysiwygModeReady")});RTE.instance.on("afterRedo",function(){RTE.instance.fire("wysiwygModeReady")});RTE.instance.on("widescreen",RTE.onWidescreen);RTE.instance.on("getData",RTE.filterHtml);RTE.loading(true)},loadCss:function(){var b=[];if(window.skin=="oasis"){RTE.instance.config.contentsCss=wfGetSassUrl("/extensions/wikia/RTE/css/oasis.scss")}else{b.push(window.stylepath+"/monobook/main.css");b.push(CKEDITOR.basePath+"../css/RTEcontent.css")}b.push(window.RTESiteCss);if(typeof WikiaEnableAutoPageCreate!="undefined"){b.push(wgExtensionsPath+"/wikia/AutoPageCreate/AutoPageCreate.css")}GlobalTriggers.fire("rterequestcss",b);for(var c=0;c<b.length;c++){var a=((b[c].indexOf("?")>-1)?"":("?"+CKEDITOR.timestamp));RTE.instance.addCss("@import url("+b[c]+a+");")}if(CKEDITOR.env.ie&&RTE.config.disableObjectResizing){RTE.instance.addCss("img {behavior:url("+RTE.constants.localPath+"/css/behaviors/disablehandles.htc)}")}},loadPlugins:function(){var a=[];for(var c=0;c<RTE.plugins.length;c++){var b=RTE.plugins[c];a.push("rte-"+b);CKEDITOR.plugins.addExternal("rte-"+b,CKEDITOR.basePath+"../js/plugins/"+b+"/")}RTE.config.extraPlugins=a.join(",")},onEditorReady:function(){RTE.tools.getThemeColors();RTE.instance.dataProcessor.writer.indentationChars="";RTE.instance.dataProcessor.writer.lineBreakChars="";CKEDITOR.plugins.sourcearea.commands.source.exec=function(a){if(a.mode=="wysiwyg"){a.fire("saveSnapshot")}a.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED);a.fire("modeSwitch")};RTE.loaded=true;RTE.loading(false);RTE.loadTime=((new Date()).getTime()-window.wgRTEStart.getTime())/1000;RTE.log("CKEditor v"+CKEDITOR.version+" ("+(window.RTEDevMode?"in development mode":CKEDITOR.revision)+') is ready in "'+RTE.instance.mode+'" mode (loaded in '+RTE.loadTime+" s)");RTE.instance.fire("RTEready");$(document.body).add(window).trigger("rteready");GlobalTriggers.fire("rteready",RTE.instance);RTE.repositionRTEStuff();$(window).bind("resize",RTE.repositionRTEStuff);if(!RTE.config.startupFocus){setTimeout(function(){RTE.instance.focus()},100)}},onWysiwygModeReady:function(){RTE.log("onWysiwygModeReady");var a=RTE.getEditor();a.attr("id",RTE.instance.config.bodyId).addClass("lang-"+window.wgContentLanguage);setTimeout(function(){if(CKEDITOR.env.opera){var b=RTE.getEditor().children().eq(0);if(b.is("br")){b.remove()}}},750)},onWidescreen:function(){RTE.repositionRTEStuff()},repositionRTEStuff:function(){RTE.stuffNode.css({left:0,top:0});var a=RTE.stuffNode.offset();var b=$("#cke_contents_wpTextbox1").offset();RTE.stuffNode.css({left:parseInt(b.left-a.left)+"px",top:parseInt(b.top-a.top)+"px"})},getEditor:function(){return jQuery(RTE.instance.document.$.body)},loading:function(a){if(a){$("body").addClass("RTEloading")}else{$("body").removeClass("RTEloading")}},modeSwitch:function(b){RTE.log('switching from "'+b+'" mode');var a=RTE.instance.getData();RTE.loading(true);switch(b){case"wysiwyg":RTE.ajax("html2wiki",{html:a,title:window.wgPageName},function(c){RTE.instance.setMode("source");RTE.instance.setData(c.wikitext);RTE.track("switchMode","wysiwyg2source")});break;case"source":RTE.ajax("wiki2html",{wikitext:a,title:window.wgPageName},function(c){if((typeof window.RTEEdgeCase!="undefined")&&(window.RTEEdgeCase=="nowysiwyg")){RTE.log("article contains __NOWYSIWYG__ magic word");c.edgecase={type:window.RTEEdgeCase,info:{title:window.RTEMessages.edgecase.title,content:window.RTEMessages.edgecase.content}}}if(c.edgecase){RTE.log("edgecase found!");RTE.tools.alert(c.edgecase.info.title,c.edgecase.info.content);RTE.instance.getCommand("source").setState(CKEDITOR.TRISTATE_ON);RTE.loading(false);RTE.track("switchMode","edgecase",c.edgecase.type);return}RTE.instance.setMode("wysiwyg");RTE.instance.setData(c.html);RTE.instanceId=c.instanceId;RTE.track("switchMode","source2wysiwyg")});break}},filterHtml:function(a){if(a.editor.mode=="wysiwyg"){a.data.dataValue=a.data.dataValue.replace(' data-rte-instance="'+RTE.instanceId+'"',"").replace(/<div firebug[^>]+>[^<]+<\/div>/g,"")}},constants:{localPath:window.RTELocalPath,urlProtocols:window.RTEUrlProtocols,validTitleChars:window.RTEValidTitleChars},messages:window.RTEMessages};CKEDITOR.config.bodyId="";CKEDITOR.config.baseBackgroundColor="#ddd";CKEDITOR.config.baseColor="#000";CKEDITOR.config.toolbar_Wikia=[{name:"",data:[{msg:"textAppearance",groups:[["Format"],["Bold","Italic","Underline","Strike"],["BulletedList","NumberedList"],["Link","Unlink"],["Outdent","Indent"],["JustifyLeft","JustifyCenter","JustifyRight"]]},{msg:"insert",groups:[["Image","Gallery","Poll","Video"],["Table"],["Template"],["Signature"]]},{msg:"controls",groups:[["Undo","Redo"],(window.skin=="oasis"?false:["Widescreen"]),["Source"]]}]}];CKEDITOR.dom.element.prototype.hasAttributesOriginal=CKEDITOR.dom.element.prototype.hasAttributes;CKEDITOR.dom.element.prototype.hasAttributes=function(){var a=this.hasAttributesOriginal();if(a==true){var b=["data-rte-washtml","data-rte-line-start","data-rte-empty-lines-before"];for(i=0;i<b.length;i++){if(this.hasAttribute(b[i])){a=false}}}return a};CKEDITOR.langRegExp=/lang\/([\w\-]+).js/;CKEDITOR.getUrl=function(c){if(CKEDITOR.langRegExp.test(c)){var b=c.match(CKEDITOR.langRegExp);var d=b[1];RTE.log('language "'+d+'" requested');var a=window.wgServer+wgScript+"?action=ajax&rs=RTEAjax&method=i18n&uselang="+d+"&cb="+window.wgMWrevId+"-"+window.wgStyleVersion;return a}if(c.indexOf("://")==-1&&c.indexOf("/")!==0){if(c.indexOf("_source")==-1){c="_source/"+c}c=this.basePath+c}if(this.timestamp&&c.charAt(c.length-1)!="/"){c+=(c.indexOf("?")>=0?"&":"?")+this.timestamp}return c};CKEDITOR.editor.prototype.switchMode=function(a){if(this.mode==a){return}RTE.log('switchMode("'+a+'")');this.mode=(a=="wysiwyg")?"source":"wysiwyg";CKEDITOR.plugins.sourcearea.commands.source.exec(this)};CKEDITOR.dom.element.prototype.setState=function(b){var a=this.getParent();switch(b){case CKEDITOR.TRISTATE_ON:a.addClass("cke_on");a.removeClass("cke_off");a.removeClass("cke_disabled");break;case CKEDITOR.TRISTATE_DISABLED:a.addClass("cke_disabled");a.removeClass("cke_off");a.removeClass("cke_on");break;default:a.addClass("cke_off");a.removeClass("cke_on");a.removeClass("cke_disabled");break}};CKEDITOR.ONLY_FORMATTABLES=2;jQuery.fn.getData=function(){var a=this.attr("data-rte-meta");if(!a){return{}}a=decodeURIComponent(a);var b=$.secureEvalJSON(a)||{};return b};jQuery.fn.setData=function(b,d){var c={};if(typeof b=="object"){c=b}else{if(typeof b=="string"){c[b]=d}}c=jQuery().extend(true,this.getData(),c);var a=$.toJSON(c);this.attr("data-rte-meta",encodeURIComponent(a));return c};jQuery.fn.setPlaceholderType=function(a){$(this).attr("class","placeholder placeholder-"+a).setData("type",a)};jQuery(function(){GlobalTriggers.fire("rtebeforeinit",RTE,CKEDITOR);RTE.log("loading...");var a=window.RTEInitMode?window.RTEInitMode:"wysiwyg";RTE.init(a)});CKEDITOR.plugins.add("rte-comment",{init:function(a){CKEDITOR.dialog.add("rte-comment",this.path+"dialogs/comment.js")}});RTE.commentEditor={placeholder:{},dialog:{},showCommentEditor:function(a){RTE.log("calling comment editor...");RTE.commentEditor.placeholder=a;RTE.instance.openDialog("rte-comment")}};CKEDITOR.dialog.add("rte-comment",function(a){return{title:a.lang.commentEditor.title,resizable:CKEDITOR.DIALOG_RESIZE_NONE,minWidth:400,minHeight:150,contents:[{id:"comment",label:"Comment",elements:[{type:"textarea",id:"content"}]}],onOk:function(){var c=this.getValueOf("comment","content");var d=RTE.commentEditor.placeholder;if(c==""){RTE.log("removing comment");RTE.track("comment","dialog","delete");d.remove();return}RTE.log("storing modified comment data: "+c);RTE.track("comment","dialog","save");var b="<!-- "+c+" -->";d.setData({wikitext:b});d.removeData("preview")},onShow:function(){this._.element.addClass("wikiaEditorDialog");this._.element.addClass("commentEditorDialog");var b=RTE.commentEditor.placeholder.getData();wikitext=b.wikitext.replace(/^<!--\s+/,"").replace(/\s+-->$/,"");this.setValueOf("comment","content",wikitext);this.setupTracking("comment",{ok:false})}}});CKEDITOR.plugins.add("rte-dialog",{init:function(a){CKEDITOR.dialog.prototype.getActiveTab=function(){return this._.currentTabId};CKEDITOR.dialog.prototype.enableSuggesionsOn=function(j,d){if(typeof window.os_enableSuggestionsOn=="function"){var g=j._.inputId;document.getElementById("RTEFakeForm").submit=function(){};d=(typeof d!="undefined"&&d.length)?d:[];window.wgSearchNamespaces=d;if(typeof window.os_map[g]=="undefined"){RTE.log('enabling MW suggest on "'+g+'"...');window.os_enableSuggestionsOn(g,"RTEFakeForm");var c=$(window.os_createContainer(os_map[g]));var b=$("#"+g);b.parent().css("position","relative").append(c);c.css("visibility","hidden");this._.suggestContainer=c;var f=new CKEDITOR.dom.element(b[0]);var k=this;for(var h in {keyup:1,keydown:1,keypress:1}){f.on(h,function(o){var n={27:1,13:1};if(o.data.getKeystroke() in n){var m=k._.suggestContainer;if(m.css("visibility")!="hidden"){k._.dontHide=true;o.data.stopPropagation();m.css("visibility","hidden")}}})}var l=function(m){if(this._.dontHide){RTE.log("dialog hide prevented");m.data.hide=false;this._.dontHide=false}};this.on("ok",l);this.on("cancel",l)}else{this._.suggestContainer=$("#"+os_map[g].container)}}};CKEDITOR.dialog.prototype.setLoading=function(c){var b=this.getElement();b.removeClass("wikiaEditorLoading");if(c){b.addClass("wikiaEditorLoading")}};CKEDITOR.dialog.prototype.setupTracking=function(d,c){var f={cancel:1,close:1,ok:1,error:1};c=$().extend(f,c);this._.wikiaTrack={sendEvent:c,sendEvents:true,name:d};var b=this;this.on("cancelClicked",function(h){b.fireTrackingEvent("cancel",h)});this.on("close",function(h){b.fireTrackingEvent("close",h)});this.on("notvalid",function(h){b.fireTrackingEvent("error",h)});var g=this.getButton("ok");if(g){g.on("click",function(h){b.fireTrackingEvent("ok",h)})}};CKEDITOR.dialog.prototype.fireTrackingEvent=function(b,c){var d=this._.wikiaTrack;if(d.sendEvents){if(d.sendEvent[b]){RTE.track(d.name,"dialog",b);if(b=="cancel"||b=="close"){d.sendEvents=false}}}}}});CKEDITOR.plugins.add("rte-dragdrop",{timeout:250,onDrop:function(a){RTE.log("drag&drop finished");setTimeout(function(){RTE.instance.fire("wysiwygModeReady");var d=RTE.getEditor().find("[data-rte-dragged]").removeAttr("data-rte-dragged");RTE.log("dropped element:");RTE.log(d);RTE.instance.fire("droppedElements",d);RTE.instance.fire("droppedElements",d);RTE.instance.fire("saveSnapshot");var c=RTE.instance.getData();if(c==""){RTE.log("undoing drag&drop");RTE.instance.execCommand("undo")}var b={pageX:(a.pageX?a.pageX:a.clientX),pageY:(a.pageY?a.pageY:a.clientY)};if(!CKEDITOR.env.ie){d.trigger("dropped",[b])}},this.timeout)},onDrag:function(a){if(typeof(a.target.tagName)=="undefined"){return true}RTE.instance.fire("saveSnapshot");RTE.log("drag&drop: undo point");var b=$(a.target);b.attr("data-rte-dragged",true);b.trigger("dragged");if(CKEDITOR.env.webkit){RTE.instance.fire("wysiwygModeReady")}},onDuringDragDrop:function(f){var g=15;var c=50;var b=parseInt($("#cke_contents_wpTextbox1").height());var d=RTE.instance.window.$;var h=(CKEDITOR.env.ie?d.document.body.parentNode.scrollTop:d.scrollY);var a=(f.pageY?f.pageY:f.clientY)-h;if(a<c){d.scrollBy(0,-g)}else{if(a>=b-c){d.scrollBy(0,g)}}},init:function(b){var a=this;b.on("wysiwygModeReady",function(){$(b.document.$).unbind(".dnd").bind("dragstart.dnd",a.onDrag).bind("drop.dnd",a.onDrop).bind("dragdrop.dnd",a.onDrop).bind("mousedown.dnd",a.onDrag).bind("mouseup.dnd",function(c){var d=$(c.target);d.removeAttr("data-rte-dragged");c.preventDefault()}).bind("dblclick.dnd",function(c){if(CKEDITOR.env.gecko){var d=$(c.target);if(!!d.filter("img").attr("type")){RTE.tools.removeResizeBox()}}}).bind("dragover.dnd",a.onDuringDragDrop);if(CKEDITOR.env.ie){RTE.getEditor().unbind(".dnd").bind("drop.dnd",a.onDrop).bind("dragover.dnd",a.onDuringDragDrop)}})}});CKEDITOR.plugins.add("rte-edit-buttons",{init:function(a){a.on("instanceReady",function(){var b=$("#wpSave,#wpPreview,#wpDiff");b.attr("disabled",false);b.bind("click",function(){var c=$(this).attr("id");c=c.substring(2).toLowerCase();RTE.track(c,a.mode+"Mode")})})}});CKEDITOR.plugins.add("rte-entities",{insideEntitySpan:false,init:function(b){var a=this;b.on("selectionChange",function(g){var f=g.data.selection;var d=f.getStartElement();if(d.hasAttribute("data-rte-entity")){var c=d.getAttribute("data-rte-entity");RTE.log("entity span: &"+c+";");a.insideEntitySpan=true}else{if(a.insideEntitySpan){RTE.log("entity span: leaving...")}a.insideEntitySpan=false}})}});CKEDITOR.plugins.add("rte-first-run-notice",{dismiss:function(a){RTE.log("first run notice - dismiss");$("#RTEFirstRunNotice").slideUp();setTimeout(RTE.repositionRTEStuff,1000);if(window.wgUserName){RTE.ajax("firstRunNoticeDismiss")}$.cookies.set("RTENoticeDismissed",1,{hoursToLive:24*365*10,domain:window.RTECookieDomain,path:window.RTECookiePath});RTE.track("firstRunNotice","close")},isDismissed:function(){if(!$("#RTEFirstRunNotice").exists()){RTE.log("first run notice - disabled / user option set");return true}var a=$.cookies.get("RTENoticeDismissed");if(a==1){RTE.log("first run notice - cookie set");return true}return false},init:function(b){var a=this;b.on("instanceReady",function(){if(a.isDismissed()){return}var c=$("#RTEFirstRunNotice");c.children("#RTEFirstRunNoticeClose").bind("click",a.dismiss);c.slideDown();setTimeout(RTE.repositionRTEStuff,1000);RTE.log("first run notice - show");RTE.track("firstRunNotice","init")})}});CKEDITOR.plugins.add("rte-gallery",{init:function(b){var a=this;b.on("wysiwygModeReady",function(){var c=RTE.getEditor().find(".image-gallery");a.setupGallery(c)});if(typeof window.WikiaPhotoGallery!="undefined"){b.addCommand("addphotogallery",{exec:function(c){WikiaPhotoGallery.showEditor({from:"wysiwyg"})}});b.ui.addButton("Gallery",{title:b.lang.photoGallery.add,className:"RTEGalleryButton",command:"addphotogallery"});RTE.tools.blockCommandInHeader("addphotogallery")}else{RTE.log('WikiaPhotoGallery is not enabled here - disabling "Gallery" button');return}},setupGallery:function(a){a.unbind(".gallery").bind("click.gallery edit.gallery",function(c){var b=$(this);WikiaPhotoGallery.showEditor({from:"wysiwyg",gallery:b})}).attr("title",function(){var c=$(this).getData();var b=(c.type==1)?"tooltip":"tooltipSlideshow";return RTE.instance.lang.photoGallery[b]})}});(function(){var d=/(-moz-|-webkit-|start|auto)/i;function b(g,k){var h=k.block||k.blockLimit;var f=(typeof g.config.alignableElements=="object")?g.config.alignableElements:[];if(!h||(f.length>1&&f.indexOf(h.getName())==-1)){return CKEDITOR.TRISTATE_DISABLED}var j=h.getComputedStyle("text-align").replace(d,"");if((!j&&this.isDefaultAlign)||j==this.value){return CKEDITOR.TRISTATE_ON}return CKEDITOR.TRISTATE_OFF}function c(f){var g=f.editor.getCommand(this.name);g.state=b.call(this,f.editor,f.data.path);g.fire("state")}function a(g,f,h){this.name=f;this.value=h;var j=g.config.contentsLangDirection;this.isDefaultAlign=(h=="left"&&j=="ltr")||(h=="right"&&j=="rtl")}a.prototype={exec:function(l){var k=l.getSelection();if(!k){return}var j=k.createBookmarks(),f=k.getRanges();var h,m;for(var g=f.length-1;g>=0;g--){h=f[g].createIterator();while((m=h.getNextParagraph())){m.removeAttribute("align");m.removeAttribute("data-rte-style");m.removeAttribute("data-rte-attribs");if(m.getName()=="p"){m.removeAttribute("data-rte-washtml")}if(m.getName()=="th"){this.isDefaultAlign=(this.value=="center")}if(this.state==CKEDITOR.TRISTATE_OFF&&!this.isDefaultAlign){m.setStyle("text-align",this.value)}else{m.removeStyle("text-align")}}}l.focus();l.forceNextSelectionCheck();k.selectBookmarks(j)}};CKEDITOR.plugins.add("rte-justify",{init:function(j){var k=new a(j,"justifyleft","left"),f=new a(j,"justifycenter","center"),h=new a(j,"justifyright","right"),g=new a(j,"justifyblock","justify");j.addCommand("justifyleft",k);j.addCommand("justifycenter",f);j.addCommand("justifyright",h);j.addCommand("justifyblock",g);j.ui.addButton("JustifyLeft",{label:j.lang.justify.left,command:"justifyleft"});j.ui.addButton("JustifyCenter",{label:j.lang.justify.center,command:"justifycenter"});j.ui.addButton("JustifyRight",{label:j.lang.justify.right,command:"justifyright"});j.ui.addButton("JustifyBlock",{label:j.lang.justify.block,command:"justifyblock"});j.on("selectionChange",CKEDITOR.tools.bind(c,k));j.on("selectionChange",CKEDITOR.tools.bind(c,h));j.on("selectionChange",CKEDITOR.tools.bind(c,f));j.on("selectionChange",CKEDITOR.tools.bind(c,g))},requires:["domiterator"]})})();CKEDITOR.tools.extend(CKEDITOR.config,{alignableElements:null});CKEDITOR.plugins.add("rte-link",{init:function(a){a.addCommand("link",new CKEDITOR.dialogCommand("link"));a.addCommand("unlink",new CKEDITOR.unlinkCommand());a.ui.addButton("Link",{label:a.lang.link.add,command:"link"});a.ui.addButton("Unlink",{label:a.lang.unlink,command:"unlink"});CKEDITOR.dialog.add("link",this.path+"dialogs/link.js");if(a.addMenuItems){a.addMenuItems({link:{label:a.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:a.lang.unlink,command:"unlink",group:"link",order:5}})}if(a.contextMenu){a.contextMenu.addListener(function(c,d){if(!c){return null}var b=(c.is("img")&&c.getAttribute("_cke_real_element_type")=="anchor");if(!b){if(!(c=CKEDITOR.plugins.link.getSelectedLink(a))){return null}b=(c.getAttribute("name")&&!c.getAttribute("href"))}return b?{anchor:CKEDITOR.TRISTATE_OFF}:{link:CKEDITOR.TRISTATE_OFF,unlink:CKEDITOR.TRISTATE_OFF}})}a.on("afterPaste",function(){var b=RTE.getEditor().find("a").not("a[data-rte-meta]");if(!b.exists()){return}RTE.log("pasted links");RTE.log(b);b.each(function(){var f=$(this);var d=f.attr("href");if(RTE.tools.isExternalLink(d)){return}var c="";if(d.indexOf("&action=edit")==-1){c=f.attr("title")}else{var h=d.match("title=(.*)&action=edit");if(h){c=h[1];c=decodeURIComponent(c);c=c.replace(/_/g," ")}}if(c==""){return}RTE.log('local link pointing to "'+c+'" found');var g={type:"internal",link:c,text:f.text(),noforce:true,wasblank:false};f.setData(g)})})}});CKEDITOR.plugins.link={getSelectedLink:function(c){var b;try{b=c.getSelection().getRanges()[0]}catch(d){return null}b.shrink(CKEDITOR.SHRINK_TEXT);var a=b.getCommonAncestor();return a.getAscendant("a",true)}};CKEDITOR.unlinkCommand=function(){};CKEDITOR.unlinkCommand.prototype={exec:function(g){var f=g.getSelection(),d=f.createBookmarks(),a=f.getRanges(),h,c;for(var b=0;b<a.length;b++){h=a[b].getCommonAncestor(true);c=h.getAscendant("a",true);if(!c){continue}this.removeLink(g,c,a[b])}f.selectBookmarks(d)},removeLink:function(b,a){a.remove(true)}};CKEDITOR.tools.extend(CKEDITOR.config,{linkShowAdvancedTab:true,linkShowTargetTab:true});CKEDITOR.dialog.add("link",function(j){var h=CKEDITOR.plugins.link;var k=false;var g;var a=function(m){var l=CKEDITOR.dialog.getCurrent();if(m=="external"){var n=l.getContentElement("internal","linktype");if(n.getValue()!="ext"){n.setValue("ext")}$(".link-type-note span").html(j.lang.link.status.external);$(".link-type-note img")[0].className="sprite external"}else{if(m=="internal"){var n=l.getContentElement("internal","linktype");if(n.getValue()!="wiki"){n.setValue("wiki")}f();l.enableSuggesionsOn(l.getContentElement("internal","name"))}}};var f=function(){var l=CKEDITOR.dialog.getCurrent().getContentElement("internal","name").getValue();if(l){$(".link-type-note span").html(j.lang.link.status.checking);$(".link-type-note img")[0].className="sprite progress";RTE.ajax("checkInternalLink",{title:l},function(m){if(m.exists){$(".link-type-note span").html(j.lang.link.status.exists);$(".link-type-note img")[0].className="link-icon link-yes"}else{$(".link-type-note span").html(j.lang.link.status.notexists);$(".link-type-note img")[0].className="link-icon link-no"}})}g=null};var d=function(q,o){function n(w,x,u){var v=CKEDITOR.dialog.getCurrent();v.setValueOf("internal","name",x);v.setValueOf("internal","label",u||"")}RTE.log("opening link dialog");var r=o?$(o.$).getData():null;if(r){if(typeof r.type=="undefined"){RTE.log("pasted link detected");var l=o.getAttribute("href");if(RTE.tools.isExternalLink(l)){r={type:"external",link:l,text:o.getText()};a("external")}}else{switch(r.type){case"internal":a("internal");setTimeout(f,200);break;case"external":case"external-raw":a("external");break}}RTE.log(r);var s=this.getContentElement("internal","label");switch(r.type){case"external":n("internal",r.link);if(r.linktype!="autonumber"){this.setValueOf("internal","label",r.text);k=true}break;case"external-raw":n("external",r.link);break;case"internal":n("internal",r.link,r.text);k=true;break}}else{var s=this.getContentElement("internal","label");var m=RTE.tools.getSelectionContent();a("internal");var p="internal";if(m){if(RTE.tools.isExternalLink(m)){a("external");p="external"}n(p,m,m);setTimeout(f,200);RTE.log('link: using selected text "'+m+'" for new '+p+" link")}else{RTE.log("link: fresh link")}}this._.selectedElement=o};var b=function(p){var o=p.getSelection(),l=o.getRanges();if(l.length==1&&l[0].collapsed){var s=new CKEDITOR.dom.text("",p.document);l[0].insertNode(s);l[0].selectNodeContents(s);o.selectRanges(l)}var n=new CKEDITOR.style({element:"a",attributes:{"data-rte-new-link-temporary":true}});n.type=CKEDITOR.STYLE_INLINE;n.apply(p.document);var r=RTE.getEditor().find("a[data-rte-new-link-temporary]");r.removeAttr("data-rte-new-link-temporary");var q=new CKEDITOR.dom.element(r[0]);if(CKEDITOR.env.gecko||CKEDITOR.env.webkit){var m=new CKEDITOR.dom.text(" ",p.document);m.insertAfter(q);o.selectElement(m);if(CKEDITOR.env.gecko){m.remove()}}return q};var c=j.lang.link;return{title:j.lang.link.title,minWidth:500,minHeight:185,contents:[{id:"internal",label:c.internal.tab,title:c.internal.tab,elements:[{type:"html",html:'<p class="link-type-note"><span>...</span><img alt="Link Status" class="" src="http://images1.wikia.nocookie.net/__cb21710/common/skins/common/blank.gif" /></p>',id:"linkdisplay"},{type:"text",label:j.lang.link.label.target,id:"name",onKeyUp:function(){var m=this.getDialog().getContentElement("internal","label");if(RTE.tools.isExternalLink(this.getValue())){a("external")}var l=this.getDialog().getContentElement("internal","linktype").getValue();if(l=="wiki"){if(g){clearTimeout(g)}$(".link-type-note span").html(j.lang.link.status.checking);$(".link-type-note img")[0].className="sprite progress";g=setTimeout(f,1000)}if(m.getValue()==""){k=false}if(!k&&m.isEnabled()){m.setValue(this.getValue())}},validate:function(){var m=this.getDialog().getContentElement("internal","linktype").getValue();if(m=="wiki"){var o=new RegExp("^(#(.+))|["+RTE.constants.validTitleChars+"]+$");var l=CKEDITOR.dialog.validate.regex(o,j.lang.link.error.badPageTitle);return l.apply(this)}else{var o=new RegExp("^("+RTE.constants.urlProtocols+")");var n=CKEDITOR.dialog.validate.regex(o,j.lang.link.error.badUrl);return n.apply(this)}}},{type:"text",label:j.lang.link.label.display,id:"label",onFocus:function(){k=true}},{type:"radio",items:[[j.lang.link.label.internal,"wiki"],[j.lang.link.label.external,"ext"]],"default":"wiki",id:"linktype",onChange:function(l){if(CKEDITOR.dialog.getCurrent()){RTE.log("mode changed to "+l.data.value);if(l.data&&l.data.value=="ext"){a("external")}else{a("internal")}}}}]}],onShow:function(){this._.element.addClass("wikiaEditorDialog");this._.element.addClass("linkEditorDialog");this.fakeObj=false;var p=this.getParentEditor(),o=p.getSelection(),l=o.getRanges(),n=null,q=this;n=h.getSelectedLink(p);if(n&&n.getAttribute("href")){o.selectElement(n)}else{n=null}$(".link-type-note span").html("...");$(".link-type-note img")[0].className="sprite";d.apply(this,[p,n]);var m=this;k=false;this.setupTracking("link")},onOk:function(){if(this._.dontHide){return}var q="";var n=this.getContentElement("internal","linktype").getValue();if(!this._.selectedElement){RTE.log("creating new link...");var o=b.apply(this,[j])}else{var o=this._.selectedElement}if(!o){return}o.removeClass("external");o.removeClass("autonumber");var s={};if(n=="wiki"){var m=this.getValueOf("internal","name");if(m.indexOf(window.wgServer)==0){var p=new RegExp(window.wgArticlePath.replace(/\$1/,"(.*)"));var r=m.match(p);if(r){var l=r[1];l=decodeURIComponent(l);l=l.replace(/_/g," ");this.setValueOf("internal","name",l);this.setValueOf("internal","label",this.getValueOf("external","label"));RTE.log("internal full URL detected: "+m+" > "+l)}}}switch(n){case"ext":s={type:"external",link:this.getValueOf("internal","name"),text:this.getValueOf("internal","label"),wikitext:null};q="externalNamed";if(s.text==""){s.linktype="autonumber";s.text="[1]";o.addClass("autonumber");q="externalNumbered"}o.setAttribute("href",s.link);o.setText(s.text!=""?s.text:s.link);o.addClass("external");o.removeClass("new");break;case"wiki":s={type:"internal",link:this.getValueOf("internal","name"),text:this.getValueOf("internal","label"),noforce:true,wikitext:null};if(o.getText()==o.getHtml()){o.setText(s.text!=""?s.text:s.link)}if(s.text==""){q="internalSimple"}else{q="internalNamed"}RTE.tools.checkInternalLink(o,s.link);break}$(o.$).setData(s);RTE.log("updating link data");RTE.log([o,$(o.$).getData()]);RTE.tools.renumberExternalLinks();if(typeof this._.suggestContainer!="undefined"){this._.suggestContainer.css("visibility","hidden")}RTE.track("link","dialog","type",q)}}});CKEDITOR.plugins.add("rte-linksuggest",{dataSource:false,init:function(b){if(typeof window.LS_PrepareTextarea!="function"){return}if(!CKEDITOR.env.ie&&!CKEDITOR.env.gecko){return}this.dataSource=new window.YAHOO.widget.DS_XHR(window.wgServer+window.wgScriptPath,["\n"]);this.dataSource.responseType=window.YAHOO.widget.DS_XHR.TYPE_FLAT;this.dataSource.scriptQueryAppend="action=ajax&rs=getLinkSuggest";var a=this;b.on("instanceReady",function(c){a.setupLinkSuggest()});b.on("mode",function(c){a.setupLinkSuggest()})},setupLinkSuggest:function(){if(RTE.instance.mode!="source"){return}var a=$(RTE.instance.textarea.$);a.attr("id","RTEtextarea");window.LS_PrepareTextarea("RTEtextarea",this.dataSource)}});CKEDITOR.plugins.add("rte-media",{init:function(b){var a=this;b.on("wysiwygModeReady",function(){var d=RTE.tools.getMedia();a.setupMedia(d);var c=RTE.getEditor().find(".media-placeholder");a.setupPlaceholder(c)});b.on("toolbarReady",function(c){$("#mw-toolbar").children("#mw-editbutton-wmu").click(function(d){window.WMU_show(d)});$("#mw-toolbar").children("#mw-editbutton-vet").click(function(d){window.VET_show(d)})});b.addCommand("addimage",{exec:function(c){RTE.tools.callFunction(window.WMU_show)}});b.ui.addButton("Image",{title:b.lang.image.add,className:"RTEImageButton",command:"addimage"});RTE.tools.blockCommandInHeader("addimage");if(typeof window.VET_show=="function"){b.addCommand("addvideo",{exec:function(c){RTE.tools.callFunction(window.VET_show)}});b.ui.addButton("Video",{title:b.lang.video.add,className:"RTEVideoButton",command:"addvideo"});RTE.tools.blockCommandInHeader("addvideo")}else{RTE.log('VET is not enabled here - disabling "Video" button');return}RTE.mediaEditor.plugin=a},setupMedia:function(f){var a=this;if(!f.exists()){return}f.attr("data-rte-instance",RTE.instanceId);var c=RTE.instance.lang.media;RTE.overlay.add(f,[{label:c.edit,"class":"RTEMediaOverlayEdit",callback:function(j){var h=a.getTrackingType(j);j.trigger("edit");RTE.track(h,"menu","edit")}},{label:c["delete"],"class":"RTEMediaOverlayDelete",callback:function(j){var h=a.getTrackingType(j);var l=RTE.instance.lang[h].confirmDeleteTitle;var k=RTE.instance.lang[h].confirmDelete;RTE.tools.confirm(l,k,function(){RTE.tools.removeElement(j)});RTE.track(h,"menu","delete")}}]);f.unbind(".media");f.bind("dragged.media",function(h){RTE.track(a.getTrackingType($(this)),"event","move")});RTE.tools.unselectable(f);RTE.getEditor().unbind("dropped.media").bind("dropped.media",function(p,j){var n=$(p.target);if(!n.hasClass("image")&&!n.hasClass("video")&&!n.hasClass("media-placeholder")){return}var m=n.parent();if((/h\d/i).test(m.attr("nodeName"))){m.after(n);RTE.log("image moved outside the header")}var r=parseInt(j.pageX-$("#editform").offset().left);var k=parseInt($("#editform").width());var l=n.getData();var s=false;var q=l.params.align;if(!q){q=(n.hasClass("thumb")||n.hasClass("frame"))?"right":"left";if(n.hasClass("alignNone")){q="left"}}switch(q){case"left":if(r>parseInt(k*0.66)){s="right"}break;case"right":if(r<parseInt(k*0.33)){s="left"}break}if(!s){RTE.log("media alignment detected: "+q+" (no change)");return}RTE.log("media alignment: "+q+" -> "+s);var h=l.wikitext;var u=new RegExp("\\|"+q+"(\\||])");if(u.test(h)){h=h.replace(u,"|"+s+"$1")}else{h=h.replace(/(\||\])/,"|"+s+"$1")}RTE.log("new wikitext: "+h);l.params.align=s;l.wikitext=h;n.setData(l);n.removeClass("alignNone alignLeft alignRight").addClass(s=="left"?"alignLeft":"alignRight");var o=n.attr("type");if(o=="image-placeholder"){o="imagePlaceholder"}if(o=="video-placeholder"){o="videoPlaceholder"}RTE.track(o,"event","switchSide",(s=="right")?"l2r":"r2l")});var g=f.filter(".withCaption");g.each(function(){$(this).css("backgroundPosition","5px "+parseInt($(this).attr("height")+10)+"px")});var d=f.filter("img.image");a.setupImage(d);var b=f.filter("img.video");a.setupVideo(b);if(RTE.config.disableDragDrop){RTE.tools.disableDragDrop(f)}},setupImage:function(a){a.bind("edit.media",function(b){RTE.log("image clicked");RTE.tools.callFunction(window.WMU_show,$(this))})},setupVideo:function(a){a.bind("edit.media",function(b){RTE.log("video clicked");RTE.tools.callFunction(window.VET_show,$(this))})},setupPlaceholder:function(d){var b=this;if(!d.exists()){return}this.setupMedia(d);d.unbind(".placeholder");d.bind("contextmenu.placeholder",function(f){f.stopPropagation()});RTE.getEditor().unbind("dropped.placeholder").bind("dropped.placeholder",function(g,f){var h=$(g.target);h=h.filter(".media-placeholder");b.setupPlaceholder(h)});var a=d.filter(".image-placeholder");a.attr("title",RTE.instance.lang.imagePlaceholder.tooltip);a.bind("click.placeholder edit.placeholder",function(f){RTE.tools.callFunction(window.WMU_show,$(this),{isPlaceholder:true})});var c=d.filter(".video-placeholder");c.attr("title",RTE.instance.lang.videoPlaceholder.tooltip);c.bind("edit.placeholder",function(f){RTE.tools.callFunction(window.VET_show,$(this),{isPlaceholder:true})});if(RTE.config.disableDragDrop){RTE.tools.disableDragDrop(d)}},getTrackingType:function(b){var a;switch($(b).attr("type")){case"image":a="image";break;case"video":a="video";break;case"image-placeholder":a="imagePlaceholder";break;case"video-placeholder":a="videoPlaceholder";break;case"image-gallery":a="photoGallery";break}return a}});RTE.mediaEditor={plugin:false,addImage:function(a,d){RTE.log("adding an image");var c=a.substring(2,a.length-2).split("|");var b={type:"image",title:c.shift().replace(/^[^:]+:/,""),params:d,wikitext:a};this._add(a,b)},addVideo:function(a,c){RTE.log("adding a video");var b={type:"video",params:c,wikitext:a};this._add(a,b)},_add:function(b,c){var a=this;RTE.tools.parseRTE(b,function(d){var f=$(d,RTE.instance.document.$).children("img");if(!f.exists()){f=$(d,RTE.instance.document.$)}f.setData(c);RTE.tools.insertElement(f,true);a.plugin.setupMedia(f);RTE.track(a.plugin.getTrackingType(f),"event","add")})},update:function(c,b,d){var a=this;RTE.tools.parseRTE(b,function(f){var g=$(f).children("img");g.insertAfter(c);g.setData("wikitext",b);c.remove();a.plugin.setupMedia(g);RTE.track(a.plugin.getTrackingType(g),"event","modified")})}};CKEDITOR.plugins.add("rte-modeswitch",{sourceButton:false,init:function(b){var a=this;b.on("instanceReady",function(c){a.updateSourceButtonTooltip();a.updateModeInfo()});b.on("mode",function(c){a.updateSourceButtonTooltip();a.updateModeInfo()})},getSourceButton:function(){if(this.sourceButton==false){var b=RTE.instance.getCommand("source");var a=b.uiItems[0];this.sourceButton=$("#"+a._.id)}return this.sourceButton},updateSourceButtonTooltip:function(){var a=this.getSourceButton();var b=(RTE.instance.mode=="wysiwyg")?"toSource":"toWysiwyg";a.attr("title",RTE.instance.lang.modeSwitch[b])},updateModeInfo:function(){$("body").removeClass("rte_wysiwyg").removeClass("rte_source").addClass("rte_"+RTE.instance.mode);$("#RTEMode").attr("value",RTE.instance.mode)}});CKEDITOR.plugins.add("rte-overlay",{overlays:false,currentOverlay:false,init:function(b){var a=this;RTE.overlay.plugin=this;b.on("instanceReady",function(){a.overlays=$("<div>",{id:"RTEMediaOverlays"}).appendTo(RTE.stuffNode)});b.on("wysiwygModeReady",function(){if(typeof a.overlays=="object"){a.overlays.html("")}});setInterval(function(){a.checkCurrentOverlay()},1000)},checkCurrentOverlay:function(){if(this.currentOverlay){var a=this.currentOverlay.data("node");if(a&&!a.hasParent("body")){this.currentOverlay.remove();this.currentOverlay=false}}},showOverlay:function(g){var c=this.getOverlay(g),a=this.getOverlayPositon(g);var f=Math.max((a.left+c.width())-RTE.getEditor().width(),0);c.children("div").css("right",f+"px");a.top=Math.max(a.top,0);c.css({left:a.left+"px",top:parseInt(a.top+2)+"px"});var j=c.children().eq(0);j.show();var b=c.children().eq(1),d=parseInt(a.top)+parseInt(b.css("top"))+16;if(d<RTE.tools.getEditorHeight()){b.show()}this.overlays.children().hide();this.currentOverlay=c.show();var h=g.data("hideTimeout");if(h){clearTimeout(h)}},hideOverlay:function(b){var a=this.getOverlay(b);b.data("hideTimeout",setTimeout(function(){a.children().hide();a.hide();this.currentOverlay=false;b.removeData("hideTimeout")},100))},getOverlay:function(f,c){var b=this;if(!this.overlays){return false}var d=f.data("overlay");if(d){return d}d=$("<div>",{"class":"RTEMediaOverlay",type:f.attr("type"),width:this.getImageWidth(f)});var g=$("<div>").addClass("RTEMediaMenu color1").appendTo(d);var c=f.data("items");$(c).each(function(){var h=this;$("<span>").addClass(h["class"]).html(h.label).bind("click",function(j){b.hideOverlay(f);h.callback(f)}).appendTo(g)});var a=this.getCaption(f);if(a){a.appendTo(d)}d.bind({mouseover:function(){b.showOverlay(f)},mouseout:function(){b.hideOverlay(f)}});d.data("node",f);this.overlays.append(d);f.data("overlay",d);return d},getCaption:function(c){var f=c.getData();var h=c.hasClass("thumb")||c.hasClass("frame");var b=(typeof f.params!="undefined")&&(f.params.captionParsed||f.params.caption);if(b&&h){var g=parseInt(c.attr("height")+7);var d=c.attr("width");if(CKEDITOR.env.ie&&CKEDITOR.env.version<=7){g-=25;d-=6}var a=$("<div>").addClass("RTEMediaCaption").css("top",g+"px").width(d).html(b).click(function(j){j.preventDefault()});return a}else{return false}},getOverlayPositon:function(b){var a=RTE.tools.getPlaceholderPosition(b);if(b.hasClass("media-placeholder")){a.top+=2;a.left+=2}else{if(b.hasClass("thumb")||b.hasClass("frame")){a.top+=6;if(!b.hasClass("alignLeft")){a.left+=18}}}return a},getImageWidth:function(b){var c=b.hasClass("thumb")||b.hasClass("frame");var a=b.is("img")?parseInt(b.attr("width")):b.innerWidth();if(c){if(CKEDITOR.env.ie&&CKEDITOR.env.version<=7){a+=2}else{a+=8}}return a+"px"}});RTE.overlay={plugin:false,add:function(c,b){var a=this.plugin;c.data("items",b);c.each(function(){var d=$(this).removeData("overlay").unbind(".overlay").bind({"mouseover.overlay":function(f){a.showOverlay(d)},"mouseout.overlay":function(f){a.hideOverlay(d)},"contextmenu.overlay":function(f){f.preventDefault();f.stopPropagation()}})})}};CKEDITOR.plugins.add("rte-paste",{htmlBeforePaste:"",getHtml:function(){return RTE.instance.document.getBody().getHtml()},track:function(a){RTE.track("paste",a)},init:function(b){var a=this;b.on("dataReady",function(d){if(b.mode!="wysiwyg"){return}var c=this.document.getBody();c.on("beforepaste",function(f){a.htmlBeforePaste=a.getHtml();setTimeout(function(){a.handlePaste.call(a,b)},250)})})},handlePaste:function(f){RTE.log("paste detected");var a=false;var g=this.getHtml();f.fire("wysiwygModeReady");var k=this.diff(this.htmlBeforePaste,g);if(typeof k!="object"||typeof k.pasted!="string"){return}var j=k.pasted;var c=j.match(/data-rte-instance="([a-z0-9-]+)"/);if(c){var h=c[1];if(h==RTE.instanceId){this.track("inside")}else{var d=parseInt(h.split("-").shift());if(d!=parseInt(wgCityId)){this.track("anotherWiki")}else{this.track("outside")}}}else{this.track("plainText")}if(typeof k.pasted=="string"){if((/<br>/).test(k.pasted)){RTE.log("paste: detected line breaks in pasted content");var b=k["new"].replace(/([^>])<br>([^<])/g,'$1<br data-rte-washtml="1" />$2');f.setData(b,function(){f.fire("afterPaste")});a=true}}if(!a){setTimeout(function(){f.fire("afterPaste")},250)}},diff:function(g,h){if(g==h){return false}var b=g.length-h.length;var a={start:0,end:h.length-1};while(g.charAt(a.start)==h.charAt(a.start)){if(a.start>=g.length){return false}a.start++}while(g.charAt(a.end+b)==h.charAt(a.end)){if(a.end<=a.start){return false}a.end--}var d=h.substring(0,a.start+1);var f=h.substring(a.end,h.length);if(/<[^>]*$/.test(d)){a.start=d.lastIndexOf("<")}if(/^[^<]*>/.test(f)){a.end+=f.indexOf(">")+1}var c=h.substring(a.start,a.end+1);d=h.substring(0,a.start);f=h.substring(a.end+1,h.length);return{pasted:c,prefix:d,suffix:f,"new":h,old:g,start:a.start,end:a.end}}});CKEDITOR.plugins.add("rte-placeholder",{previews:false,init:function(b){var a=this;b.on("instanceReady",function(){a.previews=$("<div>",{id:"RTEPlaceholderPreviews"}).appendTo(RTE.stuffNode)});b.on("wysiwygModeReady",function(){if(typeof a.previews=="object"){a.previews.html("")}var c=RTE.tools.getPlaceholders();c.removeData("preview").removeData("info");a.setupPlaceholder(c)})},getPreview:function(f){var a=this;if(!this.previews){return}var d=f.data("preview");if(typeof d=="undefined"){d=$("<div>").addClass("RTEPlaceholderPreview RTEPlaceholderPreviewLoading");d.html('<div class="RTEPlaceholderPreviewInner">&nbsp;</div>');d.bind("mouseover",function(){a.showPreview(f)});d.bind("mouseout",function(){a.hidePreview(f)});this.previews.append(d);f.data("preview",d);var c=f.getData();var b=function(j){var q,r;var o="RTEPlaceholderPreviewOther";var k=true;var s=false;var g=c.wikitext.replace(/</g,"&lt;").replace(/>/g,"&gt;");var h=RTE.instance.lang.hoverPreview;switch(j.type){case"tpl":o="RTEPlaceholderPreviewTemplate";q=j.title.replace(/_/g," ").replace(/^Template:/,window.RTEMessages.template+":");r=j.exists?h.template.intro:h.template.notExisting;g=j.exists?j.html:c.wikitext;k=!j.exists;s=(typeof j.availableParams!="undefined"&&j.availableParams.length);break;case"comment":q=h.comment.title;r=h.comment.intro;g=c.wikitext.replace(/^<!--\s+/,"").replace(/\s+-->$/,"");s=true;break;case"broken-image":o="RTEPlaceholderPreviewBrokenImage";var p=c.wikitext.replace(/^\[\[/,"").replace(/]]$/,"").split("|").shift();q=p;r=h.media.notExisting;break;default:q=h.codedElement.title;r=h.codedElement.intro;break}if(q.length>40){q=q.substr(0,40)+RTEMessages.ellipsis}if(k&&CKEDITOR.env.ie){g=g.replace(/\n/g,"<br />")}var r='<div class="RTEPlaceholderPreviewIntro">'+r+"</div>";var m="",n=true;if(n&&s){m+='<img class="sprite edit" src="'+wgBlankImgUrl+'" /><a class="RTEPlaceholderPreviewToolsEdit">'+h.edit+"</a>"}m+='<img class="sprite delete" src="'+wgBlankImgUrl+'" /><a class="RTEPlaceholderPreviewToolsDelete">'+h["delete"]+"</a>";var l="";l+='<div class="RTEPlaceholderPreviewInner '+o+'">';l+='<div class="RTEPlaceholderPreviewTitleBar color1"><span />'+q+"</div>";l+=r;l+='<div class="RTEPlaceholderPreviewCode '+(k?"RTEPlaceholderPreviewPreformatted ":"")+'reset">'+g+"</div>";l+='<div class="RTEPlaceholderPreviewTools neutral">'+m+"</div>";l+="</div>";d.removeClass("RTEPlaceholderPreviewLoading").html(l).attr("type",j.type);d.find(".RTEPlaceholderPreviewToolsDelete").bind("click",function(u){RTE.track(a.getTrackingType($(f)),"hover","delete");RTE.tools.confirm(q,h.confirmDelete,function(){RTE.tools.removeElement(f);d.remove()})});if(n&&s){d.find(".RTEPlaceholderPreviewToolsEdit").bind("click",function(u){d.hide();RTE.track(a.getTrackingType($(f)),"hover","edit");$(f).trigger("edit")})}d.find(".RTEPlaceholderPreviewCode").bind("click",function(u){u.preventDefault()});d.find(".RTEPlaceholderPreviewTitleBar").children("span").bind("click",function(u){RTE.track(a.getTrackingType($(f)),"hover","close");a.hidePreview(f,true)});if(c.type=="double-brackets"){f.data("info",j)}a.expandPlaceholder(f)};switch(c.type){case"double-brackets":RTE.tools.resolveDoubleBrackets(c.wikitext,b);break;default:b({type:c.type})}}return d},showPreview:function(d){var c=this.getPreview(d);var a=RTE.tools.getPlaceholderPosition(d);c.css({left:a.left+"px",top:parseInt(a.top+d.height()+6)+"px"});this.previews.children().not(c).each(function(){$(this).hide()});var b=this;d.data("showTimeout",setTimeout(function(){var f=c.css("display")=="block";if(!f){d.trigger("hover")}c.fadeIn();b.expandPlaceholder(d)},150));if(timeoutId=d.data("hideTimeout")){clearTimeout(timeoutId)}},hidePreview:function(c,a){var b=this.getPreview(c);if(showTimeout=c.data("showTimeout")){clearTimeout(showTimeout)}if(a){b.hide()}else{c.data("hideTimeout",setTimeout(function(){b.fadeOut();c.removeData("hideTimeout")},1000))}},setupPlaceholder:function(b){var a=this;b=b.not(".placeholder-image-placeholder").not(".placeholder-video-placeholder");if(!b.exists()){return}b.unbind(".placeholder");b.bind("mouseover.placeholder",function(){a.showPreview($(this))});b.bind("mouseout.placeholder",function(){a.hidePreview($(this))});b.bind("contextmenu.placeholder",function(c){c.stopPropagation()});RTE.tools.unselectable(b);b.bind("edit.placeholder",function(c){var d=$(this).getData();switch(d.type){case"double-brackets":RTE.templateEditor.showTemplateEditor($(this));break;case"comment":RTE.commentEditor.showCommentEditor($(this));break}});b.bind("hover.placeholder",function(c){RTE.track(a.getTrackingType($(this)),"hover","init")});RTE.getEditor().unbind("dropped.placeholder").bind("dropped.placeholder",function(c){var d=$(c.target);d=d.filter("img.placeholder");a.setupPlaceholder(d)});if(RTE.config.disableDragDrop){RTE.tools.disableDragDrop(b)}},getTrackingType:function(c){var a;var b=$(c).getData();switch(b.type){case"double-brackets":a="template";break;case"comment":a="comment";break;default:a="advancedCode"}return a},expandPlaceholder:function(l){var h=this.getPreview(l);var d=h.find(".RTEPlaceholderPreviewCode");if(d.exists()){var g=d[0];var m=(g.scrollHeight>g.clientHeight)||(g.scrollWidth>g.clientWidth);if(m){var n=g.scrollHeight;var c=g.scrollWidth;var k=parseInt(h.offset().left)+c+16;var j=parseInt(h.offset().top)+n+100;var f=$("#cke_contents_wpTextbox1");var b=parseInt(f.offset().left)+f.width();var a=parseInt(f.offset().top)+f.height();if(b<k){c-=(k-b)}if(a<j){n-=(j-a)}c=Math.max(c,350);n=Math.max(n,60);h.children(".RTEPlaceholderPreviewInner").width(c);d.height(n);d.addClass("RTEPlaceholderPreviewExpanded")}else{d.removeClass("RTEPlaceholderPreviewExpanded")}}}});CKEDITOR.plugins.add("rte-signature",{init:function(a){a.addCommand("addsignature",{exec:function(b){var c=RTE.instance.document.createText(b.config.signature_markup);RTE.tools.insertElement($(c.$))}});a.ui.addButton("Signature",{title:a.lang.signature.add,label:a.lang.signature.label,className:"RTESignatureButton",command:"addsignature"})}});CKEDITOR.config.signature_markup="~~~~";CKEDITOR.plugins.add("rte-template",{init:function(b){var a=this;CKEDITOR.dialog.add("rte-template",this.path+"dialogs/template.js");b.ui.addRichCombo("Template",{label:b.lang.templateDropDown.label,title:b.lang.templateDropDown.title,className:"cke_template",multiSelect:false,panel:{css:[CKEDITOR.getUrl(b.skinPath+"editor.css")].concat(b.config.contentsCss)},init:function(){this.startGroup(b.lang.templateDropDown.title);var d=window.RTETemplatesDropdown;for(t=0;t<d.length;t++){var f=d[t].replace(/_/g," ");var c=window.RTEMessages.template+":"+f;this.add(d[t],c,f)}this.add("--other--","<strong>"+b.lang.templateDropDown.chooseAnotherTpl+"</strong>",b.lang.templateDropDown.chooseAnotherTpl)},onClick:function(c){RTE.log('template dropdown: "'+c+'"');if(c=="--other--"){RTE.templateEditor.createTemplateEditor(false)}else{RTE.track("template","dialog","search","dropdown",c);RTE.templateEditor.createTemplateEditor(c)}var d=this;setTimeout(function(){d.setValue(false)},50)}})}});RTE.templateEditor={placeholder:false,data:{},dialog:{},doPreview:function(c){RTE.log("generating preview...");$("#templatePreview").html("").addClass("loading");var b={};$("#templateParameters").find("textarea").each(function(){var d=$(this).attr("rel");var f=$(this).attr("value");b[d]=f});var a=this.data.wikitext=this.generateWikitext(this.data.title,b);RTE.tools.parse(a,function(d){$("#templatePreview").html(d).removeClass("loading");$("#templatePreview").bind("click",function(f){f.preventDefault()});if(typeof c=="function"){c()}})},generateWikitext:function(b,h){var d,c=0,f=this.placeholder?this.placeholder.getData():false;var k=f.wikitext.replace(/\[\[(.*)\|(.*)\]\]/g,"[[$1\x7f$2]]").substring(2,f.wikitext.length-2).split("|");var j=[k.shift()];var g=0;var a=false;if(k.length==0){j=[b+"\n"];a=true}$.each(k,function(o,n){var p=n.match(/([^=]+)( *\= *)(.*)(\n?)/);if(p){var m=$.trim(p[1]);var q=p[2];var r=p[3];var l=p[4];if(l!=""){a=true}if(h[m]!=""){j.push(p[1]+q+h[m]+l);delete h[m]}}else{p=n.match(/(.*)(\n?)/);var m=++g;var r=p[1];var l=p[2];if(l!=""){a=true}if(h[m]!=""){j.push(h[m]+l)}else{j.push("")}delete h[m]}});$.each(h,function(l,m){if(parseInt(l)&&parseInt(l)==l){j.push(m!=""?m:"");if(k.length==0){j[0]=$.trim(j[0])}}else{if(m!=""){j.push(l+" = "+m+(a?"\n":""))}}});d="{{";d+=j.join("|").replace("\x7f","|").replace(/[\n|]+$/g,"").replace(/\n+$/g,"");d+="}}";$().log(f.wikitext,"RTE: old wikitext");$().log(d,"RTE: new wikitext");return d},selectStep:function(j){RTE.log("showing step #"+j);RTE.log(this.placeholder);var c=this.dialog;c.selectPage("step"+j);var g=this.placeholder.data("info");var d=this.placeholder.getData();$(".templateEditorDialog").find(".cke_dialog_footer").hide();switch(j){case 1:var h=function(){var l="";$(window.RTEHotTemplates).each(function(m,n){l+='<li><a rel="'+n+'">'+n.replace(/_/g," ")+"</a></li>"});$("#templateEditorHotTemplates").html(l);var l="";$(window.RTEMagicWords.magicWords).each(function(m,n){l+='<li><a rel="'+n+'">'+n.toUpperCase()+"</a></li>"});$("#templateEditorMagicWords").html(l);var k=this;$("#templateEditorHotTemplates").find("a").click(function(n){var m=$(this).attr("rel");RTE.templateEditor.selectTemplate(c,m)});$("#templateEditorMagicWords").find("a").click(function(o){var n=$(this).attr("rel");RTE.log("adding magic word: "+n);var p={};var m=RTEMagicWords.doubleUnderscores.indexOf(n)>-1;if(m){p.type="double-underscore";p.wikitext="__"+n.toUpperCase()+"__"}else{p.type="double-brackets";p.title=n.toUpperCase();p.wikitext="{{"+n.toUpperCase()+"}}"}RTE.log(p);var q=RTE.templateEditor.placeholder;q.setPlaceholderType(p.type);q.setData(p);RTE.templateEditor.usePlaceholder(q);c.hide();RTE.templateEditor.commitChanges()});c.enableSuggesionsOn(c.getContentElement("step1","templateSearchQuery"),[10])};if(typeof window.RTEHotTemplates=="undefined"){c.setLoading(true);RTE.ajax("getHotTemplates",{},function(k){c.setLoading(false);window.RTEHotTemplates=k;h()})}else{h()}break;case 2:$(".templateEditorDialog").find(".cke_dialog_footer").show();var a=g.title.replace(/_/g," ");a=a.replace(/^Template:/,window.RTEMessages.template+":");$("#templateEditorTemplateName").html(a);var f=window.wgServer+window.wgArticlePath.replace(/\$1/,encodeURI(g.title.replace(/ /g,"_")));$("#templateEditorViewLink").attr("href",f);var b="";$.each(g.availableParams,function(m,l){var n=(g.passedParams&&typeof g.passedParams[l]!="undefined")?g.passedParams[l]:"";n=n.replace(/&/g,"&amp;");var k=!!parseInt(l)?("#"+parseInt(m+1)):l;b+='<dt><label for="templateEditorParameter'+m+'">'+k+"</label></dt>";b+='<dd><textarea rel="'+l+'" id="templateEditorParameter'+m+'">'+n+"</textarea></dd>"});$("#templateParameters").html(b);this.doPreview();break;case 3:$("#templateAdvEditorSource").attr("value",d.wikitext);RTE.tools.parse(d.wikitext,function(k){$("#templateAdvPreview").html(k)});break}},selectTemplate:function(c,a){RTE.log("selecting template: "+a);var d={title:a,wikitext:"{{"+a+"}}"};this.placeholder.setPlaceholderType("double-brackets");this.placeholder.setData(d);RTE.templateEditor.usePlaceholder(this.placeholder);c.setLoading(true);var b=this;RTE.tools.resolveDoubleBrackets(d.wikitext,function(f){c.setLoading(false);b.placeholder.data("info",f);if((typeof f.availableParams!="undefined")&&(f.availableParams.length>0)){RTE.templateEditor.selectStep(2)}else{RTE.log("given template contains no params - inserting / updating...");RTE.templateEditor.commitChanges();c.hide();return}})},usePlaceholder:function(a){this.placeholder=a;this.data=a.getData()},commitChanges:function(){RTE.log("storing modified template data");RTE.log(this.data);this.placeholder.setData(RTE.templateEditor.data);this.placeholder.removeData("preview");this.placeholder.removeData("info");if(!this.placeholder.parent().exists()){RTE.tools.insertElement(this.placeholder)}this.placeholder=false;this.data={}},showTemplateEditor:function(a){RTE.log("calling template editor...");RTE.templateEditor.usePlaceholder(a);RTE.instance.openDialog("rte-template")},createTemplateEditor:function(a){var d=RTE.tools.createPlaceholder("double-brackets");if(a==false){RTE.log("calling template editor to choose a template...");this.showTemplateEditor(d);return}RTE.log('calling template editor for new template "'+a+'"');var c="{{"+a+"}}";d.setData({title:a,wikitext:c});var b=this;RTE.tools.resolveDoubleBrackets(c,function(f){d.data("info",f);if((typeof f.availableParams!="undefined")&&(f.availableParams.length>0)){b.showTemplateEditor(d)}else{RTE.log("given template contains no params - inserting...");RTE.tools.insertElement(d);return}})}};CKEDITOR.dialog.add("rte-template",function(b){var c=b.lang.templateEditor;var a=window.wgArticlePath.replace(/\$1/,c.dialog.magicWordsLink.replace(/ /g,"_"));return{title:c.title,minWidth:760,minHeight:365,buttons:[{id:"chooseAnotherTpl",type:"button",label:c.editor.chooseAnotherTpl,className:"cke_dialog_choose_another_tpl",buttonType:"secondary",onClick:function(d){RTE.templateEditor.selectStep(1)}},CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton],contents:[{id:"step1",label:"Step 1",elements:[{type:"hbox",widths:["300px","300px","30px"],children:[{type:"html",className:"templateEditorHeader dark_text_2",html:c.dialog.search},{id:"templateSearchQuery",style:"margin-top: 7px",type:"text"},{id:"templateDoSearch",type:"button",label:c.dialog.insert,style:"position: relative; top: 6px",onClick:function(){var f=this.getDialog();var d=f.getValueOf("step1","templateSearchQuery");if(d==""){return}RTE.templateEditor.selectTemplate(f,d);RTE.track("template","dialog","search","suggest",d)}}]},{type:"html",html:"<hr />"},{type:"html",className:"templateEditorHeader",html:c.dialog.browse},{type:"hbox",widths:["510px","250px"],children:[{type:"html",html:"<h2>"+c.dialog.mostFrequentlyUsed+'</h2><ul id="templateEditorHotTemplates"></ul>'},{type:"html",html:'<h2><a id="templateLinkToHelp" target="_blank" href="'+a+'">'+c.dialog.magicWords+'</a></h2><ul id="templateEditorMagicWords"></ul>'}]}]},{id:"step2",label:"Step 2",elements:[{type:"html",html:'<div id="templateEditorIntro"><h1 id="templateEditorTemplateName" class="dark_text_2"></h1><a id="templateEditorViewLink" href="#" target="_blank">'+c.editor.viewTemplate+"</a><p>"+c.editor.intro+"</p></div>"},{type:"hbox",widths:["330px","100px","330px"],children:[{type:"html",html:"<h2>"+c.editor.parameters+'</h2><dl id="templateParameters"></dl>'},{type:"button",label:c.editor.previewButton,onClick:function(){var d=this;this.disable();RTE.templateEditor.doPreview.apply(RTE.templateEditor,[function(){d.enable()}]);RTE.track("template","dialog","editor","preview")}},{type:"html",html:"<h2>"+c.editor.previewTitle+'</h2><div id="templatePreview" class="reset"></div>'}]}]}],onOk:function(){var d=parseInt(this.getActiveTab().charAt(4));switch(d){case 1:this.getContentElement("step1","templateDoSearch").fire("click");return false;case 2:RTE.templateEditor.doPreview(function(){RTE.templateEditor.commitChanges()});break;case 3:RTE.templateEditor.data.wikitext=$("#templateAdvEditorSource").attr("value");RTE.templateEditor.commitChanges();break}},onShow:function(){this._.element.addClass("wikiaEditorDialog");this._.element.addClass("templateEditorDialog");RTE.templateEditor.dialog=this;RTE.templateEditor.data=RTE.templateEditor.placeholder.getData();var f=RTE.templateEditor.placeholder.data("info");var d=1;if(f){RTE.log(f);d=2}this.getButton("ok").on("click",function(g){RTE.track("template","dialog","editor","ok")});this.getButton("chooseAnotherTpl").on("click",function(g){RTE.track("template","dialog","editor","chooseAnother")});RTE.templateEditor.selectStep(d)},onHide:function(){var d=(this.getActiveTab()=="step1")?"search":"editor";RTE.track("template","dialog",d,"close")},onFocus:function(){}}});CKEDITOR.plugins.add("rte-temporary-save",{init:function(a){a.on("instanceReady",function(){var c=$("#RTETemporarySaveType").attr("value");if(c){RTE.log('restoring temporary save (using "'+c+'" mode)');var b=$("#RTETemporarySaveContent").attr("value");a.setMode(c);a.setData(b);RTE.track("temporarySave","restore")}});$(window).bind("beforeunload",function(b){RTE.log("onbeforeunload: performing temporary save");$("#RTETemporarySaveType").attr("value",RTE.instance.mode);$("#RTETemporarySaveContent").attr("value",RTE.instance.getData());RTE.track("temporarySave","store")})}});CKEDITOR.plugins.add("rte-toolbar",{editorContainer:false,updateToolbarLock:false,renderToolbar:function(m,l,w,a,u){if(window.skin=="oasis"){var j=""}else{var j=" color1"}var q="";if(l>1){q='style = "display: none" '}var h=["<table "+q+'class="cke_toolbar_tab" id="cke_toolbar'+l+'"><tr>'];for(var v=0;v<w.length;v++){var x=w[v];var c=x.msg;if(typeof u[x.msg]!="undefined"){c=u[x.msg]}h.push('<td><span class="headline'+j+'">'+c+"</span>");h.push('<div class="bucket_buttons'+j+'"><div class="'+j+'">');for(var r=0;r<x.groups.length;r++){var k=x.groups[r];var d=k.length;if(k==false){continue}h.push('<span class="cke_buttons_group cke_buttons_group_'+v+'">');for(var o=0;o<d;o++){var p=k[o];var s=a.ui.create(p);if(s){s.wrapperClassName="";if(o==0){s.wrapperClassName+="cke_button_first "}if(o==d-1){s.wrapperClassName+="cke_button_last "}var f=s.render(a,h)}}h.push("</span>")}h.push('</div></div><span class="tagline'+j+'"></span></td>')}h.push("</tr></table>");h.push('<div id="mw-toolbar"></div>');m.data.html+=h.join("")},init:function(b){var a=this;b.on("mode",function(){if(b.mode=="source"){$(".cke_toolbar_tab_tabs").hide()}else{$(".cke_toolbar_tab_tabs").show()}});b.on("themeSpace",function(g){if(g.data.space=="top"){var c=b.config["toolbar_"+b.config.toolbar];$("body").trigger(jQuery.Event("RTE_beforeToolbarRender"),[c]);var f=RTE.instance.lang.bucket;g.data.html+='<div style="display:none" class="cke_toolbar_tab_tabs" >';if(c.length>1){var h="";for(var d=0;d<c.length;d++){h="";if(d==0){h='class="first selected"'}g.data.html+="<span "+h+' data-order="'+(d+1)+'" >'+c[d].name+"</span>"}}g.data.html+="</div>";for(var d=0;d<c.length;d++){a.renderToolbar(g,d+1,c[d].data,b,f)}setTimeout(function(){$(".cke_toolbar_tab_tabs span").click(function(j){element=$(j.target);if(element.hasClass("selected")){return}b.fire("toolbartabswitch");$(".cke_toolbar_tab").hide();$("#cke_toolbar"+element.attr("data-order")).show();$(".cke_toolbar_tab_tabs span").removeClass("selected");element.addClass("selected")});a.updateToolbar.apply(a)},50)}});b.on("instanceReady",function(){var c=$("#cke_toolbar1");RTE.tools.getThemeColors();if(window.skin=="monaco"){c.find(".color1").css({backgroundColor:RTE.config.baseBackgroundColor,color:RTE.config.baseColor})}c.parent().parent().attr("id","cke_toolbar_row");$(window).resize(function(){a.updateToolbar.apply(a)});b.on("widescreen",function(){a.updateToolbar.apply(a)});a.updateToolbar();c.find("td").hover(function(){a.showBucket.apply(this)},function(){a.hideBucket.apply(this);setTimeout(function(){a.updateToolbar.apply(a)},10)})});b.on("instanceReady",function(){var c=$("#cke_top_wpTextbox1");RTE.tools.getThemeColors();c.css({backgroundColor:RTE.config.baseBackgroundColor,color:RTE.config.baseColor});b.fire("toolbarReady",$("#cke_toolbar1"));a.editorContainer=$(RTE.instance.container.$).find(".cke_contents")});b.on("mode",function(){if(this.mode=="source"){a.loadSourceToolbar()}});b.on("modeSwitch",function(){if(this.mode=="wysiwyg"){a.loadSourceToolbar()}});window.insertTags=function(o,c,g){var p=a.editorContainer.children("textarea")[0];var f,j=false;if(document.selection&&document.selection.createRange){if(document.documentElement&&document.documentElement.scrollTop){var h=document.documentElement.scrollTop}else{if(document.body){var h=document.body.scrollTop}}p.focus();var k=document.selection.createRange();f=k.text;l();k.text=o+f+c;if(j&&k.moveStart){if(window.opera){c=c.replace(/\n/g,"")}k.moveStart("character",-c.length-f.length);k.moveEnd("character",-c.length)}k.select();if(document.documentElement&&document.documentElement.scrollTop){document.documentElement.scrollTop=h}else{if(document.body){document.body.scrollTop=h}}}else{if(p.selectionStart||p.selectionStart=="0"){var n=p.scrollTop;p.focus();var m=p.selectionStart;var d=p.selectionEnd;f=p.value.substring(m,d);l();p.value=p.value.substring(0,m)+o+f+c+p.value.substring(d,p.value.length);if(j){p.selectionStart=m+o.length;p.selectionEnd=m+o.length+f.length}else{p.selectionStart=m+o.length+f.length+c.length;p.selectionEnd=p.selectionStart}p.scrollTop=n}}function l(){if(!f){f=g;j=true}else{if(f.charAt(f.length-1)==" "){f=f.substring(0,f.length-1);c+=" "}}}}},updateToolbar:function(){var b=this;var d=250;if(window.skin=="oasis"){return}if(this.updateToolbarLock){setTimeout(function(){b.updateToolbar.apply(b)},d+50);return}this.updateToolbarLock=true;var a=false;$("#cke_toolbar1").find("td").each(function(){var k=0;var h=$(this);var l=h.children(".bucket_buttons").children("div");if(parseInt(l.height())>60){var g=l.children(".cke_buttons_group");var j=Math.floor(l.offset().top);g.reverse().each(function(){var m=Math.floor($(this).offset().top);if(m<j+30){return false}k+=$(this).children().length;a=true})}if(k>0){h.find(".tagline").html(k+" "+RTE.messages.more);h.addClass("more")}else{h.find(".tagline").html("<div> </div>");h.removeClass("more")}});if(a){$("#cke_toolbar1").addClass("more")}else{$("#cke_toolbar1").removeClass("more")}var f=200;$("#cke_toolbar1").find("td").each(function(){var g=$(this);var h=0;g.children().each(function(){h+=$(this).height()});f=Math.min(f,h)});if(CKEDITOR.env.ie){var c=$("#cke_top_wpTextbox1").parent()}else{var c=$("#cke_top_wpTextbox1")}c.height(f);RTE.repositionRTEStuff();setTimeout(function(){b.updateToolbarLock=false},d)},showBucket:function(){var b=$(this).find(".bucket_buttons");var a=b.children("div");a.css("height","auto");b.parent().addClass("bucket_expanded")},hideBucket:function(){var b=$(this).find(".bucket_buttons");var a=b.children("div");b.parent().removeClass("bucket_expanded");a.css("height","auto")},loadSourceToolbar:function(){var c=$("#mw-toolbar");if(c.children().length==0){var a,b=c.get(0);for(a=0;a<mwEditButtons.length;a++){mwInsertEditButton(b,mwEditButtons[a])}for(a=0;a<mwCustomEditButtons.length;a++){mwInsertEditButton(b,mwCustomEditButtons[a])}if(typeof GlobalTriggers!="undefined"){GlobalTriggers.fire("beforeMWToolbarRender",c[0])}RTE.log("loading source mode toolbar")}}});CKEDITOR.plugins.add("rte-tools",{});window.RTE.tools={alert:function(b,a){window.$.showModal(b,"<p>"+a+"</p>",{className:"RTEModal",width:500})},blockCommandInHeader:function(a){var b=RTE.instance,c=b.getCommand(a);if(c){b.on("selectionChange",CKEDITOR.tools.bind(RTE.tools.blockCommandInHeaderOnSelectionChange,c))}},blockCommandInHeaderOnSelectionChange:function(b){var c=b.data.path,d=c.block?c.block.getName():"",a=(/h\d/).test(d);return this.setState(a?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF)},callFunction:function(b,a,d){if(typeof b!="function"){return}var c=jQuery.Event("rte");c.data=(typeof d=="object")?d:{};c.data.element=a||false;c.target=window.document.createElement("div");b.call(window,c)},checkInternalLink:function(c,a){var b="";if(/^#(.+)/.test(a)){b=a;a=window.wgPageName}RTE.ajax("checkInternalLink",{title:a},function(d){if(!d.exists){c.addClass("new")}else{c.removeClass("new")}c.setAttribute("href",d.href+b);c.setAttribute("title",d.title)})},confirm:function(c,a,d){var b="<p>"+a+'</p><div class="RTEConfirmButtons neutral"><a id="RTEConfirmCancel" class="wikia-button secondary"><span>'+RTE.instance.lang.common.cancel+'</span></a><a id="RTEConfirmOk" class="wikia-button"><span>'+RTE.instance.lang.common.ok+"</span></a></div>";$.showModal(c,b,{id:"RTEConfirm",className:"RTEModal",width:500,callbackBefore:function(){$("#RTEConfirmOk").click(function(){$("#RTEConfirm").closeModal();if(typeof d=="function"){d()}});$("#RTEConfirmCancel").click(function(){$("#RTEConfirm").closeModal()})}})},createPlaceholder:function(a,b){var c=$("<img />",RTE.instance.document.$);c.addClass("placeholder placeholder-"+a);c.attr("src",wgBlankImgUrl).attr("type",a).attr("data-rte-instance",RTE.instanceId);b=b&&(typeof b=="object")?b:{};b.type=a;b.placeholder=true;c.setData(b);RTE.log('creating new placeholder for "'+a+'"');RTE.log(c);return c},disableDragDrop:function(a){a.bind("mousedown",function(b){b.preventDefault()})},getEditorHeight:function(){return $("#cke_contents_wpTextbox1").height()},getEditorScrollOffsets:function(){var b,a;if(CKEDITOR.env.webkit){b=RTE.instance.document.$.body.scrollLeft;a=RTE.instance.document.$.body.scrollTop}else{b=RTE.instance.document.$.documentElement.scrollLeft;a=RTE.instance.document.$.documentElement.scrollTop}return{left:b,top:a}},getThemeColors:function(){var a=$("#RTEColorPicker");if(!a.exists()){a=$('<div id="RTEColorPicker">').addClass("color1").appendTo(RTE.stuffNode).hide()}RTE.config.baseBackgroundColor=a.css("backgroundColor");RTE.config.baseColor=a.css("color")},getImages:function(){var a=RTE.getEditor().find("img.image");return a},getMedia:function(){var a=RTE.getEditor().find("img.image,img.video");return a},getPlaceholderPosition:function(c){var b=c.position(),a=this.getEditorScrollOffsets();return{left:parseInt(b.left-10-a.left),top:parseInt(b.top-a.top)}},getPlaceholders:function(b){var c=b?("img[type="+b+"]"):"img.placeholder";var a=RTE.getEditor().find(c);return a},getSelectionContent:function(){if(CKEDITOR.env.ie){var a=RTE.instance.document.$.selection.createRange().text}else{var a=RTE.instance.window.$.getSelection().toString()}return a},getVideos:function(){var a=RTE.getEditor().find("img.video");return a},insertElement:function(a,b){RTE.instance.insertElement(new CKEDITOR.dom.element($(a)[0]));if(!b){RTE.instance.fire("wysiwygModeReady")}},isExternalLink:function(a){return this.isExternalLinkRegExp.test(a)},isExternalLinkRegExp:new RegExp("^"+window.RTEUrlProtocols),parseCache:{},parse:function(b,c){var a=RTE.tools.parseCache;if(typeof a[b]!="undefined"){RTE.log("RTE.tools.parse() - cache hit");if(typeof c=="function"){c(a[b])}return}RTE.ajax("parse",{wikitext:b,title:window.wgPageName},function(d){a[b]=d.html;if(typeof c=="function"){c(d.html)}})},parseRTE:function(a,b){RTE.ajax("rteparse",{wikitext:a,title:window.wgPageName},function(c){if(typeof b=="function"){b(c.html)}})},renumberExternalLinks:function(){RTE.getEditor().find("a.autonumber").each(function(a){$(this).text("["+(a+1)+"]")})},removeElement:function(a){RTE.instance.fire("saveSnapshot");$(a).remove();RTE.instance.fire("saveSnapshot")},removeResizeBox:function(){setTimeout(function(){if(CKEDITOR.env.gecko){var a=RTE.instance.document.$;a.designMode="off";a.designMode="on"}},50)},resolveDoubleBracketsCache:{},resolveDoubleBrackets:function(b,c){var a=RTE.tools.resolveDoubleBracketsCache;if(typeof a[b]!="undefined"){RTE.log("RTE.tools.resolveDoubleBrackets() - cache hit");if(typeof c=="function"){c(a[b])}return}RTE.ajax("resolveDoubleBrackets",{wikitext:b,title:window.wgPageName},function(d){a[b]=d;if(typeof c=="function"){c(d)}})},unselectable:function(a){return;$(a).each(function(c){var b=new CKEDITOR.dom.element(this);b.unselectable()})}};CKEDITOR.plugins.add("rte-track",{init:function(b){var a=this;b.on("wysiwygModeReady",function(){b.document.removeListener(a.trackApplyStyle);b.document.on("applyStyle",a.trackApplyStyle)});b.on("contextMenuOnOpen",a.trackContextMenuOpen);b.on("contextMenuOnClick",a.trackContextMenuItem);b.on("listCreated",a.trackListCreated);b.on("RTEready",function(){a.trackLoadTime(b)});b.on("RTEready",function(){a.trackBrowser("init")});$("#wpSave").click(function(){a.trackBrowser("save")});b.on("buttonClick",function(c){var d=c.data.button;RTE.track("toolbar",d.command)});b.on("panelShow",function(d){var c=d.data.me;var f=c.trackingName||c.className.split("_").pop();RTE.track("toolbar",f+"Menu","open")});b.on("panelClick",function(g){var f=g.data.me;var h=g.data.value;var j=f.trackingName||f.className.split("_").pop();if(j=="template"){if(h=="--other--"){h="other"}else{var d=f._.items;var c=0;for(tpl in d){c++;if(tpl==h){h=c;break}}}}RTE.track("toolbar",j+"Menu",h)});b.on("instanceReady",function(){$("#mw-toolbar").bind("click",function(c){var d=$(c.target).filter("img");if(!d.exists()){return}var f=d.attr("id").split("-").pop();RTE.track("source",f)})})},trackApplyStyle:function(c){var b=c.data.style;var a=c.data.remove;if(b&&!a){RTE.track("toolbar","format",b)}},trackContextMenuOpen:function(a){RTE.track("contextMenu","open")},trackContextMenuItem:function(d){var b=d.data.item.command;var c,a=["cell","row","column"];for(c=0;c<a.length;c++){var f=a[c];if(b.indexOf(f)==0){RTE.track("contextMenu","action",f,b);return}}RTE.track("contextMenu","action",b)},trackListCreated:function(c){var b=c.data.listNode;var a=(b.getName()=="ul")?"unorderedList":"orderedList";RTE.track("format",a)},trackLoadTime:function(b){var a=parseInt(RTE.loadTime*10)*100;switch(b.mode){case"source":RTE.track("init","sourceMode",a);if(window.RTEEdgeCase){RTE.track("init","edgecase",window.RTEEdgeCase)}break;case"wysiwyg":RTE.track("init","wysiwygMode",a);break}},trackBrowser:function(b){var d=CKEDITOR.env;var c=(d.ie?"ie":d.gecko?"gecko":d.opera?"opera":d.air?"air":d.webkit?"webkit":"unknown");if(c=="gecko"){var a=parseInt(d.version/10000)+"."+parseInt(d.version/100%100)+"."+(d.version%100)}else{var a=d.version}RTE.track("browser",b,c,a)}});CKEDITOR.plugins.add("rte-widescreen",{init:function(c){var b=window.ToggleWideScreen;var a=$("body").hasClass("editingWide")?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;c.addCommand("widescreen",{exec:function(d){b.call();this.toggleState();d.fire("widescreen")},state:a});c.ui.addButton("Widescreen",{title:c.lang.widescreen.toggle,className:"RTEWidescreenButton",command:"widescreen"})}});CKEDITOR.themes.add("wikia",(function(){return{build:function(m,l){var c=m.name,k=m.element,j=m.elementMode;if(!k||j==CKEDITOR.ELEMENT_MODE_NONE){return}if(j==CKEDITOR.ELEMENT_MODE_REPLACE){k.hide()}var d=m.fire("themeSpace",{space:"top",html:""}).html;var q=m.fire("themeSpace",{space:"contents",html:""}).html;var o=m.fireOnce("themeSpace",{space:"bottom",html:""}).html;var p=q&&m.config.height;var g=m.config.tabIndex||m.element.getAttribute("tabindex")||0;if(!q){p="auto"}else{if(!isNaN(p)){p+="px"}}var b="";var f=m.config.width;if(f){if(!isNaN(f)){f+="px"}b+="width: "+f+";"}var n=1,h="";if(window.skin=="oasis"&&!window.wgIsMainpage){n=2;h='<td id="cke_contents_'+c+'_sidebar"></td>'}var a=CKEDITOR.dom.element.createFromHtml(['<span id="cke_',c,'" class="',m.skinClass,'" dir="',m.lang.dir,'" title="',(CKEDITOR.env.gecko?" ":""),'" lang="',m.langCode,'" tabindex="'+g+'"'+(b?' style="'+b+'"':"")+'><span class="',CKEDITOR.env.cssClass,'"><span class="cke_wrapper cke_',m.lang.dir,'"><table class="cke_editor" border="0" cellspacing="0" cellpadding="0"><tbody><tr',d?"":' style="display:none"','><td id="cke_top_',c,'" class="cke_top" colspan="',n,'" style="background-color: '+m.config.baseBackgroundColor+"; color:"+m.config.baseColor+'">',d,"</td></tr><tr",q?"":' style="display:none"','><td id="cke_contents_',c,'" class="cke_contents" style="height:',p,'">',q,"</td>",h,"</tr><tr",o?"":' style="display:none"','><td id="cke_bottom_',c,'" class="cke_bottom" colspan="',n,'">',o,"</td></tr></tbody></table><style>.",m.skinClass,"{visibility:hidden;}</style></span></span></span>"].join(""));a.getChild([0,0,0,0,0]).unselectable();a.getChild([0,0,0,0,2]).unselectable();if(j==CKEDITOR.ELEMENT_MODE_REPLACE){a.insertAfter(k)}else{k.append(a)}m.container=a;a.disableContextMenu();m.fireOnce("themeLoaded");m.fireOnce("uiReady")},buildDialog:function(c){var d=CKEDITOR.tools.getNextNumber();var b=CKEDITOR.dom.element.createFromHtml(['<div id="cke_'+c.name.replace(".","\\.")+'_dialog" class="cke_skin_',c.skinName,'" dir="',c.lang.dir,'" lang="',c.langCode,'"><div class="cke_dialog modalWrapper'," "+CKEDITOR.env.cssClass," cke_",c.lang.dir,'" style="position:absolute"><div class="%body"><div id="%title#" class="%title"></div><div id="%close_button#" class="%close_button"><img src="'+window.stylepath+'/common/blank.gif" class="sprite close" /></div><div id="%tabs#" class="%tabs accent tabs"></div><div id="%contents#" class="%contents"></div><div id="%footer#" class="%footer"></div></div><div id="%tl#" class="%tl"></div><div id="%tc#" class="%tc"></div><div id="%tr#" class="%tr"></div><div id="%ml#" class="%ml"></div><div id="%mr#" class="%mr"></div><div id="%bl#" class="%bl"></div><div id="%bc#" class="%bc"></div><div id="%br#" class="%br"></div></div>',(CKEDITOR.env.ie?"":"<style>.cke_dialog{visibility:hidden;}</style>"),"</div>"].join("").replace(/#/g,"_"+d).replace(/%/g,"cke_dialog_"));var a=b.getChild([0,0]);a.getChild(0).unselectable();a.getChild(1).unselectable();a.getChild(0).setStyles({backgroundColor:RTE.config.baseBackgroundColor,color:RTE.config.baseColor});return{element:b,parts:{dialog:b.getChild(0),title:a.getChild(0),close:a.getChild(1),tabs:a.getChild(2),contents:a.getChild(3),footer:a.getChild(4)}}},destroy:function(d){var a=d.container,b=d.panels;if(CKEDITOR.env.ie){a.setStyle("display","none");var g=document.body.createTextRange();g.moveToElementText(a.$);try{g.select()}catch(f){}}if(a){a.remove()}for(var c=0;b&&c<b.length;c++){b[c].remove()}if(d.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE){d.element.show();delete d.element}}}})());CKEDITOR.editor.prototype.getThemeSpace=function(b){var a="cke_"+b;var c=this._[a]||(this._[a]=CKEDITOR.document.getById(a+"_"+this.name));return c};CKEDITOR.editor.prototype.resize=function(d,a,h,b){var g=/^\d+$/;if(g.test(d)){d+="px"}var f=CKEDITOR.document.getById("cke_contents_"+this.name);var c=b?f.getAscendant("table").getParent():f.getAscendant("table").getParent().getParent().getParent();CKEDITOR.env.webkit&&c.setStyle("display","none");c.setStyle("width",d);if(CKEDITOR.env.webkit){c.$.offsetWidth;c.setStyle("display","")}var j=h?0:(c.$.offsetHeight||0)-(f.$.clientHeight||0);f.setStyle("height",Math.max(a-j,0)+"px");this.fire("resize")};CKEDITOR.editor.prototype.getResizable=function(){return this.container.getChild([0,0])};CKEDITOR.skins.add("wikia",(function(){var a=[];if(CKEDITOR.env.ie&&CKEDITOR.env.version<7){a.push("icons.png","images/sprites_ie6.png","images/dialog_sides.gif")}return{preload:a,editor:{css:[window.RTEDevMode?"editor.css":"editor.min.css"]},dialog:{css:["dialog.css"]},templates:{css:["templates.css"]},margins:[0,0,0,0],init:function(g){if(g.config.width&&!isNaN(g.config.width)){g.config.width-=12}var f=[];var d=/\$color/g;var k="/* UI Color Support */.cke_skin_wikia .cke_menuitem .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_wikia .cke_menuitem a:hover .cke_icon_wrapper,.cke_skin_wikia .cke_menuitem a:focus .cke_icon_wrapper,.cke_skin_wikia .cke_menuitem a:active .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_wikia .cke_menuitem a:hover .cke_label,.cke_skin_wikia .cke_menuitem a:focus .cke_label,.cke_skin_wikia .cke_menuitem a:active .cke_label{	background-color: $color !important;}.cke_skin_wikia .cke_menuitem a.cke_disabled:hover .cke_label,.cke_skin_wikia .cke_menuitem a.cke_disabled:focus .cke_label,.cke_skin_wikia .cke_menuitem a.cke_disabled:active .cke_label{	background-color: transparent !important;}.cke_skin_wikia .cke_menuitem a.cke_disabled:hover .cke_icon_wrapper,.cke_skin_wikia .cke_menuitem a.cke_disabled:focus .cke_icon_wrapper,.cke_skin_wikia .cke_menuitem a.cke_disabled:active .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_wikia .cke_menuitem a.cke_disabled .cke_icon_wrapper{	background-color: $color !important;	border-color: $color !important;}.cke_skin_wikia .cke_menuseparator{	background-color: $color !important;}.cke_skin_wikia .cke_menuitem a:hover,.cke_skin_wikia .cke_menuitem a:focus,.cke_skin_wikia .cke_menuitem a:active{	background-color: $color !important;}";if(CKEDITOR.env.webkit){k=k.split("}").slice(0,-1);for(var c=0;c<k.length;c++){k[c]=k[c].split("{")}}function b(l){var m=l.getHead().append("style");m.setAttribute("id","cke_ui_color");m.setAttribute("type","text/css");return m}function h(q,n,m){var p,l,o;for(var s=0;s<q.length;s++){if(CKEDITOR.env.webkit){for(l=0;l<q[s].$.sheet.rules.length;l++){q[s].$.sheet.removeRule(l)}for(l=0;l<n.length;l++){o=n[l][1];for(p=0;p<m.length;p++){o=o.replace(m[p][0],m[p][1])}q[s].$.sheet.addRule(n[l][0],o)}}else{o=n;for(p=0;p<m.length;p++){o=o.replace(m[p][0],m[p][1])}if(CKEDITOR.env.ie){q[s].$.styleSheet.cssText=o}else{q[s].setHtml(o)}}}}var j=/\$color/g;CKEDITOR.tools.extend(g,{uiColor:null,getUiColor:function(){return this.uiColor},setUiColor:function(l){var n,o=b(CKEDITOR.document),q="#cke_"+g.name.replace(".","\\.");var p=[q+" .cke_wrapper",q+"_dialog .cke_dialog_contents",q+"_dialog a.cke_dialog_tab",q+"_dialog .cke_dialog_footer"].join(",");var m="background-color: $color !important;";if(CKEDITOR.env.webkit){n=[[p,m]]}else{n=p+"{"+m+"}"}return(this.setUiColor=function(r){var s=[[j,r]];g.uiColor=r;h([o],n,s);h(f,k,s)})(l)}});g.on("menuShow",function(p){var l=p.data[0];var n=l.element.getElementsByTag("iframe").getItem(0).getFrameDocument();if(!n.getById("cke_ui_color")){var o=b(n);f.push(o);var m=g.getUiColor();if(m){h([o],k,[[j,m]])}}});if(g.config.uiColor){g.setUiColor(g.config.uiColor)}}}})());if(CKEDITOR.dialog){CKEDITOR.dialog.on("resize",function(b){var h=b.data,f=h.width,a=h.height,c=h.dialog,g=c.parts.contents,d=!CKEDITOR.env.quirks;if(h.skin!="wikia"){return}g.setStyles((CKEDITOR.env.ie||(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900))?{width:f+"px",height:a+"px"}:{"min-width":f+"px","min-height":a+"px"});if(!CKEDITOR.env.ie){return}setTimeout(function(){var j=g.getParent(),k=j.getParent();var l=k.getChild(2);l.setStyle("width",(j.$.offsetWidth)+"px");l=k.getChild(7);l.setStyle("width",(j.$.offsetWidth-28)+"px");l=k.getChild(4);l.setStyle("height",(j.$.offsetHeight-31-14)+"px");l=k.getChild(5);l.setStyle("height",(j.$.offsetHeight-31-14)+"px")},100)})};